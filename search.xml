<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>CS193p_assignment3</title>
    <url>/2022/03/20/cs193-a3/</url>
    <content><![CDATA[<h3 id="Task-1"><a href="#Task-1" class="headerlink" title="Task 1"></a>Task 1</h3><blockquote>
<p>å®æ–½ä¸€ä¸ªå•äººæ¸¸æˆSet</p>
</blockquote>
<h3 id="Task-2"><a href="#Task-2" class="headerlink" title="Task 2"></a>Task 2</h3><blockquote>
<p>æ‰€æœ‰å¡ç‰‡å¯è§ï¼Œå¡ç‰‡å°½å¯èƒ½çš„å¤§ã€‚ä¹Ÿå¯ä»¥å¢åŠ ä¸€ä¸ªæœ€å°å°ºå¯¸ï¼Œç„¶åæ¢å¤æ»šåŠ¨ã€‚æ‰€æœ‰çš„å¡ç‰‡éƒ½å¿…é¡»å¯è¯†åˆ«</p>
</blockquote>
<span id="more"></span>

<h3 id="Task-3"><a href="#Task-3" class="headerlink" title="Task 3"></a>Task 3</h3><blockquote>
<p>æœ‰ç›¸åŒçš„é•¿å®½æ¯”</p>
</blockquote>
<h3 id="Task-4"><a href="#Task-4" class="headerlink" title="Task 4"></a>Task 4</h3><blockquote>
<p>ç¬¦å·çš„å¤§å°æ ¹æ®å¡ç‰‡å¤§å°å†³å®š</p>
</blockquote>
<h3 id="Task-5"><a href="#Task-5" class="headerlink" title="Task 5"></a>Task 5</h3><blockquote>
<p>é€‰æ‹©ä¸‰å¼ ç‰ŒåŒ¹é…ï¼Œèƒ½å¤Ÿçœ‹åˆ°å“ªäº›ç‰Œå·²ç»è¢«é€‰ä¸­</p>
</blockquote>
<h3 id="Task-6"><a href="#Task-6" class="headerlink" title="Task 6"></a>Task 6</h3><blockquote>
<p>åªè¦æœ‰ä¸‰å¼ ç‰Œè¢«é€‰ä¸­ï¼Œè¦æ˜¾ç¤ºæ˜¯å¦åŒ¹é…ï¼Œä¸åŒ¹é…çš„ä¸‰ä¸ªå’Œåªé€‰æ‹©1æˆ–2å¼ ç‰Œæ—¶çœ‹èµ·æ¥ä¸ä¸€æ ·</p>
</blockquote>
<h3 id="Task-7"><a href="#Task-7" class="headerlink" title="Task 7"></a>Task 7</h3><blockquote>
<p>æ”¯æŒç‚¹å‡»å·²ç»é€‰ä¸­çš„ç‰Œå–æ¶ˆé€‰ä¸­ï¼Œåªé€‰æ‹©1æˆ–2æ—¶</p>
</blockquote>
<h3 id="Task-8"><a href="#Task-8" class="headerlink" title="Task 8"></a>Task 8</h3><blockquote>
<p>æ²¡è¯»æ˜ç™½å•Šï¼Œå›å¤´å†è¯´</p>
<p>å½“ä»»ä½•ä¸€å¼ ç‰Œè¢«è§¦æ‘¸åˆ°ï¼Œå¹¶ä¸”å·²ç»æœ‰3å¼ ç›¸åŒ¹é…çš„å¥—è£…ç‰Œè¢«é€‰ä¸­ã€‚<br>é‚£ä¹ˆâ€¦<br>a. æŒ‰ç…§ â€œå¥—ç‰Œ â€œçš„è§„åˆ™ï¼Œç”¨æ–°çš„ â€œå¥—ç‰Œ â€œæ›¿æ¢è¿™3å¼ åŒ¹é…çš„ç‰Œã€‚ç‰Œ<br>b. å¦‚æœè¿™å‰¯ç‰Œæ˜¯ç©ºçš„ï¼Œé‚£ä¹ˆå°±æŠŠé‚£äº›åŒ¹é…çš„ç‰Œæ‰€ç©ºå‡ºæ¥çš„ä½ç½®ï¼ˆå› ä¸ºæ²¡æœ‰æ›´å¤šçš„ç‰Œï¼Œæ‰€ä»¥ä¸èƒ½è¢«æ›¿æ¢ï¼‰ã€‚b. å¦‚æœè¿™å‰¯ç‰Œæ˜¯ç©ºçš„ï¼Œé‚£ä¹ˆè¿™å‰¯ç‰Œæ‰€è…¾å‡ºçš„ç©ºé—´ï¼ˆå› ä¸ºæ²¡æœ‰æ›´å¤šçš„ç‰Œï¼Œæ‰€ä»¥ä¸èƒ½è¢«æ›¿æ¢ï¼‰å°±åº”è¯¥è®©ç»™å‰©ä½™çš„ çš„ç‰Œï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™äº›ç‰Œå¾ˆå¯èƒ½ä¼šå˜å¤§ï¼‰ã€‚<br>c. å¦‚æœè¢«ç¢°çš„ç‰Œä¸å±äºåŒ¹é…çš„ç‰Œç»„ï¼Œåˆ™é€‰æ‹©è¯¥ç‰Œã€‚<br>d. å¦‚æœè¢«æ‘¸åˆ°çš„ç‰Œæ˜¯åŒ¹é…ç»„çš„ä¸€éƒ¨åˆ†ï¼Œé‚£ä¹ˆå°±ä¸é€‰æ‹©ä»»ä½•ç‰Œã€‚</p>
</blockquote>
<h3 id="Task-9"><a href="#Task-9" class="headerlink" title="Task 9"></a>Task 9</h3><blockquote>
<p>æœ‰ä¸‰å¼ ä¸åŒ¹é…çš„ç‰Œè¢«é€‰ä¸­ï¼Œå–æ¶ˆè¿™ä¸‰å¼ ç‰Œï¼Œé€‰ä¸­ç‚¹å‡»çš„ç‰Œ</p>
</blockquote>
<h3 id="Task-10"><a href="#Task-10" class="headerlink" title="Task 10"></a>Task 10</h3><blockquote>
<p>æœ‰â€œDeal 3 More Cardsâ€æŒ‰é’®</p>
<p>ä½ éœ€è¦æœ‰ä¸€ä¸ª â€œå†å‘3å¼ ç‰Œ â€œçš„æŒ‰é’®ï¼ˆæ ¹æ®Setçš„è§„åˆ™ï¼‰ã€‚<br>a. å½“å®ƒè¢«è§¦åŠ¨æ—¶ï¼Œå¦‚æœæ‰€é€‰çš„ç‰Œç»„æˆäº†ä¸€å¥—ç‰Œï¼Œåˆ™æ›¿æ¢æ‰€é€‰çš„ç‰Œã€‚<br>b. æˆ–è€…ï¼Œå¦‚æœæ‰€é€‰çš„ç‰Œä¸ç»„æˆä¸€å¥—ç‰Œï¼ˆæˆ–è€…æ‰€é€‰çš„ç‰Œå°‘äº3å¼ ï¼ŒåŒ…æ‹¬æ²¡æœ‰ï¼‰ï¼Œåˆ™å¢åŠ 3å¼ æ–°ç‰Œï¼ŒåŠ å…¥å±å¹•ä¸Šå·²ç»å‡ºç°çš„ç‰Œï¼ˆå¹¶ä¸”ä¸å½±å“é€‰æ‹©ï¼‰ã€‚<br>c. å¦‚æœç‰Œç»„æ˜¯ç©ºçš„ï¼Œåˆ™ç¦ç”¨æ­¤æŒ‰é’®ã€‚</p>
</blockquote>
<h3 id="Task-11"><a href="#Task-11" class="headerlink" title="Task 11"></a>Task 11</h3><blockquote>
<p>æœ‰ä¸€ä¸ªâ€œNew Gameâ€æŒ‰é’®ï¼Œå¼€å§‹æ–°æ¸¸æˆï¼Œå›åˆ°12ä¸ªéšæœºå¡</p>
</blockquote>
<h3 id="Task-12"><a href="#Task-12" class="headerlink" title="Task 12"></a>Task 12</h3><blockquote>
<p>ç”¨é•¿æ–¹å½¢ä»£æ›¿å¼¯æ›²</p>
</blockquote>
<h3 id="Task-13"><a href="#Task-13" class="headerlink" title="Task 13"></a>Task 13</h3><blockquote>
<p>è‡ªå·±ç¼–å†™Shapeç»“æ„åˆ¶ä½œâ€œdiamondâ€</p>
</blockquote>
<h3 id="Task-14"><a href="#Task-14" class="headerlink" title="Task 14"></a>Task 14</h3><blockquote>
<p>æ¡çº¹è¡¨ç¤ºä¸ºåŠé€æ˜ï¼Œå’Œçº¯è‰²åŒºåˆ†å¼€</p>
</blockquote>
<h3 id="Task-15-amp-16"><a href="#Task-15-amp-16" class="headerlink" title="Task 15&amp;16"></a>Task 15&amp;16</h3><blockquote>
<p>ä½¿ç”¨æšä¸¾ä½œä¸ºæ–¹æ¡ˆä¸­æœ‰æ„ä¹‰çš„éƒ¨åˆ†ï¼Œä½¿ç”¨é—­åŒ…(ä¸€ä¸ªä½œä¸ºå‚æ•°çš„å‡½æ•°)ï¼Œä¸‰ä¸ªä¸åŒé¢œè‰²</p>
</blockquote>
]]></content>
      <categories>
        <category>ios</category>
      </categories>
      <tags>
        <tag>swift</tag>
        <tag>cs193p</tag>
      </tags>
  </entry>
  <entry>
    <title>CS193p_assignment2</title>
    <url>/2022/02/18/cs193p-ls/</url>
    <content><![CDATA[<p>â€‹    ä¸€ä¸ªå†æ—¶å¾ˆä¹…çš„blogï¼Œå­¦å®ŒLesson4ä¹‹åï¼Œè‡ªå·±ç çš„Assignment2çš„ä»£ç ï¼Œä¹Ÿä¸çŸ¥é“å¯¹ä¸å¯¹ï¼ˆæ¯•ç«Ÿæ²¡æœ‰å‚è€ƒä»£ç ï¼‰ï¼Œä»…ä¾›å‚è€ƒå•Š</p>
<h3 id="Task1-amp-2-çœç•¥"><a href="#Task1-amp-2-çœç•¥" class="headerlink" title="Task1&amp;2: çœç•¥"></a>Task1&amp;2: çœç•¥</h3><h3 id="Task3ï¼šå°†ä¸»é¢˜æ·»åŠ åˆ°æ¨¡å‹ä¸­ï¼ŒåŒ…æ‹¬ä¸»é¢˜çš„åç§°ã€ä¸€ç»„è¡¨æƒ…ç¬¦å·ã€è¦å±•ç¤ºçš„å¡ç‰‡å¯¹æ•°å’Œé€‚å½“çš„èƒŒæ™¯é¢œè‰²"><a href="#Task3ï¼šå°†ä¸»é¢˜æ·»åŠ åˆ°æ¨¡å‹ä¸­ï¼ŒåŒ…æ‹¬ä¸»é¢˜çš„åç§°ã€ä¸€ç»„è¡¨æƒ…ç¬¦å·ã€è¦å±•ç¤ºçš„å¡ç‰‡å¯¹æ•°å’Œé€‚å½“çš„èƒŒæ™¯é¢œè‰²" class="headerlink" title="Task3ï¼šå°†ä¸»é¢˜æ·»åŠ åˆ°æ¨¡å‹ä¸­ï¼ŒåŒ…æ‹¬ä¸»é¢˜çš„åç§°ã€ä¸€ç»„è¡¨æƒ…ç¬¦å·ã€è¦å±•ç¤ºçš„å¡ç‰‡å¯¹æ•°å’Œé€‚å½“çš„èƒŒæ™¯é¢œè‰²"></a>Task3ï¼šå°†ä¸»é¢˜æ·»åŠ åˆ°æ¨¡å‹ä¸­ï¼ŒåŒ…æ‹¬ä¸»é¢˜çš„åç§°ã€ä¸€ç»„è¡¨æƒ…ç¬¦å·ã€è¦å±•ç¤ºçš„å¡ç‰‡å¯¹æ•°å’Œé€‚å½“çš„èƒŒæ™¯é¢œè‰²</h3><p>åˆ›å»ºä¸€ä¸ªç»“æ„ä½“å­˜å‚¨ä¸»é¢˜</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">struct</span> <span class="token class-name">Theme</span> <span class="token punctuation">&#123;</span>
    
    <span class="token keyword">var</span> name<span class="token punctuation">:</span> <span class="token class-name">String</span>
    <span class="token keyword">var</span> emojis<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span>
    <span class="token keyword">var</span> numberOfPairsOfCards<span class="token punctuation">:</span> <span class="token class-name">Int</span>
    <span class="token keyword">var</span> color<span class="token punctuation">:</span> <span class="token class-name">String</span>
    
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<span id="more"></span>

<h3 id="Task4-amp-8ï¼šåœ¨æ¸¸æˆä¸­è‡³å°‘æœ‰ä¸€ä¸ªä¸»é¢˜å±•ç¤ºçš„å¡ç‰‡æ•°å°‘äºæ€»æ•°ï¼Œæ”¯æŒå…­ç§ä¸»é¢˜"><a href="#Task4-amp-8ï¼šåœ¨æ¸¸æˆä¸­è‡³å°‘æœ‰ä¸€ä¸ªä¸»é¢˜å±•ç¤ºçš„å¡ç‰‡æ•°å°‘äºæ€»æ•°ï¼Œæ”¯æŒå…­ç§ä¸»é¢˜" class="headerlink" title="Task4&amp;8ï¼šåœ¨æ¸¸æˆä¸­è‡³å°‘æœ‰ä¸€ä¸ªä¸»é¢˜å±•ç¤ºçš„å¡ç‰‡æ•°å°‘äºæ€»æ•°ï¼Œæ”¯æŒå…­ç§ä¸»é¢˜"></a>Task4&amp;8ï¼šåœ¨æ¸¸æˆä¸­è‡³å°‘æœ‰ä¸€ä¸ªä¸»é¢˜å±•ç¤ºçš„å¡ç‰‡æ•°å°‘äºæ€»æ•°ï¼Œæ”¯æŒå…­ç§ä¸»é¢˜</h3><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">private</span><span class="token punctuation">(</span><span class="token keyword">set</span><span class="token punctuation">)</span> <span class="token keyword">var</span> themes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Theme</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token class-name">Theme</span><span class="token punctuation">(</span>
        name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"Veiche"</span></span><span class="token punctuation">,</span>
        emojis<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"ğŸšŒ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš—"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš“"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš‘"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ›»"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš²"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš‚"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"âœˆï¸"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš€"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ›¶"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ›¸"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš•"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš™"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš›"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¦½"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš’"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸšœ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš "</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš„"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ›°"</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        numberOfPairsOfCards<span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
        color<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"red"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">Theme</span><span class="token punctuation">(</span>
        name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"Animal"</span></span><span class="token punctuation">,</span>
        emojis<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"ğŸ¶"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ±"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ­"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ°"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¦Š"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ»"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¼"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ®"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸµ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ§"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¦‹"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¢"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¦†"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ™"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¦"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¦€"</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        numberOfPairsOfCards<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
        color<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"blue"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">Theme</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"Face"</span></span><span class="token punctuation">,</span>
           emojis<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"ğŸ˜€"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"â˜ºï¸"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜Š"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜‡"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¥°"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜Œ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜‰"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ™ƒ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜‹"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¤¨"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜’"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜­"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¥µ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜³"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¤”"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¤—"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜·"</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
           numberOfPairsOfCards<span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
           color<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"green"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token comment">//æ·»åŠ 6ç§</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">let</span> emojis <span class="token operator">=</span> theme<span class="token punctuation">.</span>emojis<span class="token punctuation">.</span><span class="token function">shuffled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="Task5-amp-6-amp-7ï¼šä¸å­˜åœ¨æ°¸è¿œä¸ä¼šå‡ºç°çš„å¡ç‰‡ï¼Œä¸å…è®¸å‡ºç°ä¸¤å¯¹ç›¸åŒç¬¦å·çš„å¡ç‰‡-ä¸»é¢˜ä¸­æŒ‡å®šæ˜¾ç¤ºçš„å¡ç‰‡æ•°é‡è¶…è¿‡å¡ç”¨çš„æ•°é‡ï¼Œè‡ªåŠ¨å‡å°‘æ˜¾ç¤ºçš„å¡ç‰‡æ•°é‡"><a href="#Task5-amp-6-amp-7ï¼šä¸å­˜åœ¨æ°¸è¿œä¸ä¼šå‡ºç°çš„å¡ç‰‡ï¼Œä¸å…è®¸å‡ºç°ä¸¤å¯¹ç›¸åŒç¬¦å·çš„å¡ç‰‡-ä¸»é¢˜ä¸­æŒ‡å®šæ˜¾ç¤ºçš„å¡ç‰‡æ•°é‡è¶…è¿‡å¡ç”¨çš„æ•°é‡ï¼Œè‡ªåŠ¨å‡å°‘æ˜¾ç¤ºçš„å¡ç‰‡æ•°é‡" class="headerlink" title="Task5&amp;6&amp;7ï¼šä¸å­˜åœ¨æ°¸è¿œä¸ä¼šå‡ºç°çš„å¡ç‰‡ï¼Œä¸å…è®¸å‡ºç°ä¸¤å¯¹ç›¸åŒç¬¦å·çš„å¡ç‰‡ ä¸»é¢˜ä¸­æŒ‡å®šæ˜¾ç¤ºçš„å¡ç‰‡æ•°é‡è¶…è¿‡å¡ç”¨çš„æ•°é‡ï¼Œè‡ªåŠ¨å‡å°‘æ˜¾ç¤ºçš„å¡ç‰‡æ•°é‡"></a>Task5&amp;6&amp;7ï¼šä¸å­˜åœ¨æ°¸è¿œä¸ä¼šå‡ºç°çš„å¡ç‰‡ï¼Œä¸å…è®¸å‡ºç°ä¸¤å¯¹ç›¸åŒç¬¦å·çš„å¡ç‰‡ ä¸»é¢˜ä¸­æŒ‡å®šæ˜¾ç¤ºçš„å¡ç‰‡æ•°é‡è¶…è¿‡å¡ç”¨çš„æ•°é‡ï¼Œè‡ªåŠ¨å‡å°‘æ˜¾ç¤ºçš„å¡ç‰‡æ•°é‡</h3><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">var</span> pairs <span class="token operator">=</span> emojis<span class="token punctuation">.</span>count
       <span class="token keyword">if</span> pairs <span class="token operator">></span> theme<span class="token punctuation">.</span>numberOfPairsOfCards <span class="token punctuation">&#123;</span>
           pairs <span class="token operator">=</span> theme<span class="token punctuation">.</span>numberOfPairsOfCards
       <span class="token punctuation">&#125;</span>
       <span class="token comment">//modelçš„æ•°æ®ç±»å‹æ˜¯modelç»“æ„</span>
       <span class="token keyword">return</span> <span class="token class-name">MemoryGame</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">></span><span class="token punctuation">(</span>numberOfPairsOfCards<span class="token punctuation">:</span> pairs<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> pairIndex <span class="token keyword">in</span>
           emojis<span class="token punctuation">[</span>pairIndex<span class="token punctuation">]</span>
       <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Task9ï¼šæ–°ä¸»é¢˜èƒ½é€šè¿‡ä»£ç è¢«æ·»åŠ åˆ°æ¸¸æˆä¸­"><a href="#Task9ï¼šæ–°ä¸»é¢˜èƒ½é€šè¿‡ä»£ç è¢«æ·»åŠ åˆ°æ¸¸æˆä¸­" class="headerlink" title="Task9ï¼šæ–°ä¸»é¢˜èƒ½é€šè¿‡ä»£ç è¢«æ·»åŠ åˆ°æ¸¸æˆä¸­"></a>Task9ï¼šæ–°ä¸»é¢˜èƒ½é€šè¿‡ä»£ç è¢«æ·»åŠ åˆ°æ¸¸æˆä¸­</h3><h3 id="Task10-amp-11ï¼šåœ¨UIä¸­æ·»åŠ â€New-Gameâ€æŒ‰é’®ï¼Œå¼€å§‹æ–°çš„æ¸¸æˆï¼Œå¼€å§‹æ¸¸æˆåº”é‡æ–°é€‰æ‹©ä¸»é¢˜"><a href="#Task10-amp-11ï¼šåœ¨UIä¸­æ·»åŠ â€New-Gameâ€æŒ‰é’®ï¼Œå¼€å§‹æ–°çš„æ¸¸æˆï¼Œå¼€å§‹æ¸¸æˆåº”é‡æ–°é€‰æ‹©ä¸»é¢˜" class="headerlink" title="Task10&amp;11ï¼šåœ¨UIä¸­æ·»åŠ â€New Gameâ€æŒ‰é’®ï¼Œå¼€å§‹æ–°çš„æ¸¸æˆï¼Œå¼€å§‹æ¸¸æˆåº”é‡æ–°é€‰æ‹©ä¸»é¢˜"></a>Task10&amp;11ï¼šåœ¨UIä¸­æ·»åŠ â€New Gameâ€æŒ‰é’®ï¼Œå¼€å§‹æ–°çš„æ¸¸æˆï¼Œå¼€å§‹æ¸¸æˆåº”é‡æ–°é€‰æ‹©ä¸»é¢˜</h3><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">Button</span> <span class="token punctuation">&#123;</span>
    viewModel<span class="token punctuation">.</span><span class="token function">newGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span> label<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"New Game"</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>largeTitle<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">foregroundColor</span><span class="token punctuation">(</span><span class="token class-name">Color</span><span class="token punctuation">.</span>red<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">init</span><span class="token punctuation">(</span>startTheme<span class="token punctuation">:</span> <span class="token class-name">Theme</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token nil constant">nil</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	theme <span class="token operator">=</span> themes<span class="token punctuation">.</span><span class="token function">randomElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span>
	cardcolor <span class="token operator">=</span> <span class="token class-name">EmojiMemoryGame</span><span class="token punctuation">.</span><span class="token function">color</span><span class="token punctuation">(</span>theme<span class="token punctuation">:</span> theme<span class="token punctuation">)</span>
	model <span class="token operator">=</span> <span class="token class-name">EmojiMemoryGame</span><span class="token punctuation">.</span><span class="token function">createMemoryGame</span><span class="token punctuation">(</span>theme<span class="token punctuation">:</span> theme<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">func</span> <span class="token function-definition function">newGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	theme <span class="token operator">=</span> themes<span class="token punctuation">.</span><span class="token function">randomElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span>
	cardcolor <span class="token operator">=</span> <span class="token class-name">EmojiMemoryGame</span><span class="token punctuation">.</span><span class="token function">color</span><span class="token punctuation">(</span>theme<span class="token punctuation">:</span> theme<span class="token punctuation">)</span>
	model <span class="token operator">=</span> <span class="token class-name">EmojiMemoryGame</span><span class="token punctuation">.</span><span class="token function">createMemoryGame</span><span class="token punctuation">(</span>theme<span class="token punctuation">:</span> theme<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Task12-amp-13ï¼šæ¸¸æˆä¸­å¡ç‰‡æ­£é¢æœä¸‹-æ–°æ¸¸æˆå¡ç‰‡è¢«æ‰“ä¹±"><a href="#Task12-amp-13ï¼šæ¸¸æˆä¸­å¡ç‰‡æ­£é¢æœä¸‹-æ–°æ¸¸æˆå¡ç‰‡è¢«æ‰“ä¹±" class="headerlink" title="Task12&amp;13ï¼šæ¸¸æˆä¸­å¡ç‰‡æ­£é¢æœä¸‹,æ–°æ¸¸æˆå¡ç‰‡è¢«æ‰“ä¹±"></a>Task12&amp;13ï¼šæ¸¸æˆä¸­å¡ç‰‡æ­£é¢æœä¸‹,æ–°æ¸¸æˆå¡ç‰‡è¢«æ‰“ä¹±</h3><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">init</span><span class="token punctuation">(</span>numberOfPairsOfCards<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">,</span> creatCardContent<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">CardContent</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    cards <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token operator">&lt;</span><span class="token class-name">Card</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">//æ·»åŠ ä¸¤å€çš„å¡ç‰Œ</span>
    <span class="token keyword">for</span> pairIndex <span class="token keyword">in</span> <span class="token number">0</span><span class="token operator">..&lt;</span>numberOfPairsOfCards <span class="token punctuation">&#123;</span>
        <span class="token keyword">let</span> content <span class="token operator">=</span> <span class="token function">creatCardContent</span><span class="token punctuation">(</span>pairIndex<span class="token punctuation">)</span>
        cards<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">Card</span><span class="token punctuation">(</span>content<span class="token punctuation">:</span> content<span class="token punctuation">,</span> id<span class="token punctuation">:</span> pairIndex<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        cards<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">Card</span><span class="token punctuation">(</span>content<span class="token punctuation">:</span> content<span class="token punctuation">,</span> id<span class="token punctuation">:</span> pairIndex<span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    cards<span class="token punctuation">.</span><span class="token function">shuffle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
    
<span class="token keyword">struct</span> <span class="token class-name">Card</span><span class="token punctuation">:</span> <span class="token class-name">Identifiable</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> isFaceUp<span class="token punctuation">:</span> <span class="token class-name">Bool</span> <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token keyword">var</span> isMatched<span class="token punctuation">:</span> <span class="token class-name">Bool</span> <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token keyword">var</span> content<span class="token punctuation">:</span> <span class="token class-name">CardContent</span>
    <span class="token keyword">var</span> id<span class="token punctuation">:</span> <span class="token class-name">Int</span>
    <span class="token keyword">var</span> seen<span class="token punctuation">:</span> <span class="token class-name">Bool</span> <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Task14-amp-16ï¼šåœ¨UIä¸­æ˜¾ç¤ºä¸»é¢˜çš„åç§°å’Œåˆ†æ•°"><a href="#Task14-amp-16ï¼šåœ¨UIä¸­æ˜¾ç¤ºä¸»é¢˜çš„åç§°å’Œåˆ†æ•°" class="headerlink" title="Task14&amp;16ï¼šåœ¨UIä¸­æ˜¾ç¤ºä¸»é¢˜çš„åç§°å’Œåˆ†æ•°"></a>Task14&amp;16ï¼šåœ¨UIä¸­æ˜¾ç¤ºä¸»é¢˜çš„åç§°å’Œåˆ†æ•°</h3><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">HStack</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Theme:  </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">viewModel<span class="token punctuation">.</span>theme<span class="token punctuation">.</span>name</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
    <span class="token class-name">Spacer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Score:    </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">viewModel<span class="token punctuation">.</span>score</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">.</span><span class="token function">foregroundColor</span><span class="token punctuation">(</span><span class="token punctuation">.</span>red<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Task15ï¼šåŒ¹é…æˆåŠŸåˆ†æ•°-2ï¼ŒåŒ¹é…ä¸æˆåŠŸä¸”æ¯å«æœ‰ä¸€å¼ è¢«çœ‹è§è¿‡çš„ç‰Œåˆ†æ•°-2"><a href="#Task15ï¼šåŒ¹é…æˆåŠŸåˆ†æ•°-2ï¼ŒåŒ¹é…ä¸æˆåŠŸä¸”æ¯å«æœ‰ä¸€å¼ è¢«çœ‹è§è¿‡çš„ç‰Œåˆ†æ•°-2" class="headerlink" title="Task15ï¼šåŒ¹é…æˆåŠŸåˆ†æ•°+2ï¼ŒåŒ¹é…ä¸æˆåŠŸä¸”æ¯å«æœ‰ä¸€å¼ è¢«çœ‹è§è¿‡çš„ç‰Œåˆ†æ•°-2"></a>Task15ï¼šåŒ¹é…æˆåŠŸåˆ†æ•°+2ï¼ŒåŒ¹é…ä¸æˆåŠŸä¸”æ¯å«æœ‰ä¸€å¼ è¢«çœ‹è§è¿‡çš„ç‰Œåˆ†æ•°-2</h3><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">mutating</span> <span class="token keyword">func</span> <span class="token function-definition function">choose</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> card<span class="token punctuation">:</span> <span class="token class-name">Card</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> chosenIndex <span class="token operator">=</span> cards<span class="token punctuation">.</span><span class="token function">firstIndex</span><span class="token punctuation">(</span><span class="token keyword">where</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>id <span class="token operator">==</span> card<span class="token punctuation">.</span>id <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token operator">!</span>cards<span class="token punctuation">[</span>chosenIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>isFaceUp<span class="token punctuation">,</span>
       <span class="token operator">!</span>cards<span class="token punctuation">[</span>chosenIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>isMatched
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token keyword">let</span> potentialMatchIndex <span class="token operator">=</span> indexOfTheOneAndOnlyFaceUpCard <span class="token punctuation">&#123;</span> <span class="token comment">//å¦‚æœæœ‰çº¸ç‰Œè¢«æ€å¼€</span>
            <span class="token keyword">if</span> cards<span class="token punctuation">[</span>chosenIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>content <span class="token operator">==</span> cards<span class="token punctuation">[</span>potentialMatchIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>content <span class="token punctuation">&#123;</span> <span class="token comment">//èƒ½åŒ¹é…</span>
                cards<span class="token punctuation">[</span>chosenIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>isMatched <span class="token operator">=</span> <span class="token boolean">true</span>
                cards<span class="token punctuation">[</span>potentialMatchIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>isMatched <span class="token operator">=</span> <span class="token boolean">true</span>
                score <span class="token operator">+=</span> <span class="token number">2</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">if</span> cards<span class="token punctuation">[</span>potentialMatchIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>seen <span class="token punctuation">&#123;</span>
                    score <span class="token operator">-=</span> <span class="token number">1</span>
                <span class="token punctuation">&#125;</span>
                <span class="token keyword">if</span> cards<span class="token punctuation">[</span>chosenIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>seen <span class="token punctuation">&#123;</span>
                    score <span class="token operator">-=</span> <span class="token number">1</span>
                <span class="token punctuation">&#125;</span>
                cards<span class="token punctuation">[</span>potentialMatchIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>seen <span class="token operator">=</span> <span class="token boolean">true</span>
                cards<span class="token punctuation">[</span>chosenIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>seen <span class="token operator">=</span> <span class="token boolean">true</span>
            <span class="token punctuation">&#125;</span>
            
            indexOfTheOneAndOnlyFaceUpCard <span class="token operator">=</span> <span class="token nil constant">nil</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">for</span> index <span class="token keyword">in</span> cards<span class="token punctuation">.</span>indices <span class="token punctuation">&#123;</span>
                cards<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>isFaceUp <span class="token operator">=</span> <span class="token boolean">false</span>
            <span class="token punctuation">&#125;</span>
            
            indexOfTheOneAndOnlyFaceUpCard <span class="token operator">=</span> chosenIndex
        <span class="token punctuation">&#125;</span>
        
        cards<span class="token punctuation">[</span>chosenIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>isFaceUp<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="å…¨éƒ¨ä»£ç "><a href="#å…¨éƒ¨ä»£ç " class="headerlink" title="å…¨éƒ¨ä»£ç "></a>å…¨éƒ¨ä»£ç </h3><p>ContentView.swift</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span>


<span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
    <span class="token attribute atrule">@ObservedObject</span> <span class="token keyword">var</span> viewModel<span class="token punctuation">:</span> <span class="token class-name">EmojiMemoryGame</span>

 
    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        
        <span class="token class-name">ScrollView</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">Button</span> <span class="token punctuation">&#123;</span>
                viewModel<span class="token punctuation">.</span><span class="token function">newGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span> label<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"New Game"</span></span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>largeTitle<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">foregroundColor</span><span class="token punctuation">(</span><span class="token class-name">Color</span><span class="token punctuation">.</span>red<span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
            <span class="token class-name">HStack</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Theme:  </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">viewModel<span class="token punctuation">.</span>theme<span class="token punctuation">.</span>name</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span>
                    
                <span class="token class-name">Spacer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Score:    </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">viewModel<span class="token punctuation">.</span>score</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">.</span><span class="token function">foregroundColor</span><span class="token punctuation">(</span><span class="token punctuation">.</span>red<span class="token punctuation">)</span>
            
            <span class="token class-name">LazyVGrid</span><span class="token punctuation">(</span>columns<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">GridItem</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">adaptive</span><span class="token punctuation">(</span>minimum<span class="token punctuation">:</span> <span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">ForEach</span><span class="token punctuation">(</span>viewModel<span class="token punctuation">.</span>cards<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> card <span class="token keyword">in</span>
                    <span class="token class-name">CardView</span><span class="token punctuation">(</span>card<span class="token punctuation">:</span> card<span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">aspectRatio</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> contentMode<span class="token punctuation">:</span> <span class="token punctuation">.</span>fit<span class="token punctuation">)</span>
                        <span class="token punctuation">.</span>onTapGesture<span class="token punctuation">&#123;</span>
                            viewModel<span class="token punctuation">.</span><span class="token function">choose</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span>
                        <span class="token punctuation">&#125;</span>
                    
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token punctuation">.</span><span class="token function">foregroundColor</span><span class="token punctuation">(</span>viewModel<span class="token punctuation">.</span>cardcolor<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">.</span>horizontal<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">struct</span> <span class="token class-name">CardView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> card<span class="token punctuation">:</span> <span class="token class-name">MemoryGame</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">></span><span class="token punctuation">.</span><span class="token class-name">Card</span>
    
    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">ZStack</span><span class="token punctuation">&#123;</span>
            
            <span class="token keyword">let</span> shape <span class="token operator">=</span> <span class="token class-name">RoundedRectangle</span><span class="token punctuation">(</span>cornerRadius<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> card<span class="token punctuation">.</span>isFaceUp <span class="token punctuation">&#123;</span>
                shape<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">foregroundColor</span><span class="token punctuation">(</span><span class="token punctuation">.</span>white<span class="token punctuation">)</span>
                shape<span class="token punctuation">.</span><span class="token function">strokeBorder</span><span class="token punctuation">(</span>lineWidth<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">)</span>
                <span class="token class-name">Text</span><span class="token punctuation">(</span>card<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>largeTitle<span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> card<span class="token punctuation">.</span>isMatched <span class="token punctuation">&#123;</span>
                shape<span class="token punctuation">.</span><span class="token function">opacity</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                shape<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">struct</span> <span class="token class-name">ContentView_Previews</span><span class="token punctuation">:</span> <span class="token class-name">PreviewProvider</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">static</span> <span class="token keyword">var</span> previews<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">let</span> game <span class="token operator">=</span> <span class="token class-name">EmojiMemoryGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token class-name">Group</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">ContentView</span><span class="token punctuation">(</span>viewModel<span class="token punctuation">:</span> game<span class="token punctuation">)</span>
            
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>EmojiMemoryGame.swift</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span>

<span class="token keyword">class</span> <span class="token class-name">EmojiMemoryGame</span><span class="token punctuation">:</span> <span class="token class-name">ObservableObject</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token function-definition function">createMemoryGame</span><span class="token punctuation">(</span>theme<span class="token punctuation">:</span> <span class="token class-name">Theme</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">MemoryGame</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">></span> <span class="token punctuation">&#123;</span> <span class="token comment">//æ·»åŠ å‚æ•°</span>
        <span class="token keyword">let</span> emojis <span class="token operator">=</span> theme<span class="token punctuation">.</span>emojis<span class="token punctuation">.</span><span class="token function">shuffled</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">var</span> pairs <span class="token operator">=</span> emojis<span class="token punctuation">.</span>count
        <span class="token keyword">if</span> pairs <span class="token operator">></span> theme<span class="token punctuation">.</span>numberOfPairsOfCards <span class="token punctuation">&#123;</span>
            pairs <span class="token operator">=</span> theme<span class="token punctuation">.</span>numberOfPairsOfCards
        <span class="token punctuation">&#125;</span>
        <span class="token comment">//modelçš„æ•°æ®ç±»å‹æ˜¯modelç»“æ„</span>
        <span class="token keyword">return</span> <span class="token class-name">MemoryGame</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">></span><span class="token punctuation">(</span>numberOfPairsOfCards<span class="token punctuation">:</span> pairs<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> pairIndex <span class="token keyword">in</span>
            emojis<span class="token punctuation">[</span>pairIndex<span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span>
            
    <span class="token punctuation">&#125;</span>
    <span class="token attribute atrule">@Published</span> <span class="token keyword">private</span> <span class="token keyword">var</span> model<span class="token punctuation">:</span> <span class="token class-name">MemoryGame</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">></span><span class="token comment">//åˆå§‹åŒ–æˆ–é™æ€è®¿é—®é™æ€ä¸éœ€è¦å…¨å</span>
    <span class="token attribute atrule">@Published</span> <span class="token keyword">private</span><span class="token punctuation">(</span><span class="token keyword">set</span><span class="token punctuation">)</span> <span class="token keyword">var</span> cardcolor<span class="token punctuation">:</span> <span class="token class-name">Color</span>
    <span class="token keyword">private</span><span class="token punctuation">(</span><span class="token keyword">set</span><span class="token punctuation">)</span> <span class="token keyword">var</span> theme<span class="token punctuation">:</span> <span class="token class-name">Theme</span>
    
    <span class="token keyword">init</span><span class="token punctuation">(</span>startTheme<span class="token punctuation">:</span> <span class="token class-name">Theme</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token nil constant">nil</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        theme <span class="token operator">=</span> themes<span class="token punctuation">.</span><span class="token function">randomElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span>
        cardcolor <span class="token operator">=</span> <span class="token class-name">EmojiMemoryGame</span><span class="token punctuation">.</span><span class="token function">color</span><span class="token punctuation">(</span>theme<span class="token punctuation">:</span> theme<span class="token punctuation">)</span>
        model <span class="token operator">=</span> <span class="token class-name">EmojiMemoryGame</span><span class="token punctuation">.</span><span class="token function">createMemoryGame</span><span class="token punctuation">(</span>theme<span class="token punctuation">:</span> theme<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token comment">//è¿”å›view model å˜é‡ç±»å‹æ˜¯æ•°ç»„&lt;modelä¸­çš„Card>ç»“æ„</span>
    <span class="token keyword">var</span> cards<span class="token punctuation">:</span> <span class="token class-name">Array</span><span class="token operator">&lt;</span><span class="token class-name">MemoryGame</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">></span><span class="token punctuation">.</span><span class="token class-name">Card</span><span class="token operator">></span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> model<span class="token punctuation">.</span>cards<span class="token comment">//è¿”å›modelä¸­çš„cardsæ•°ç»„ æ•°ç»„çš„ç»“æ„æ˜¯Card</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token function-definition function">color</span><span class="token punctuation">(</span>theme<span class="token punctuation">:</span> <span class="token class-name">Theme</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Color</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> theme<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string-literal"><span class="token string">"red"</span></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token class-name">Color</span><span class="token punctuation">.</span>red
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> theme<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string-literal"><span class="token string">"green"</span></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token class-name">Color</span><span class="token punctuation">.</span>green
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> theme<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string-literal"><span class="token string">"yellow"</span></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token class-name">Color</span><span class="token punctuation">.</span>yellow
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> theme<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string-literal"><span class="token string">"blue"</span></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token class-name">Color</span><span class="token punctuation">.</span>blue
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> theme<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string-literal"><span class="token string">"purple"</span></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token class-name">Color</span><span class="token punctuation">.</span>purple
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> theme<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string-literal"><span class="token string">"pink"</span></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token class-name">Color</span><span class="token punctuation">.</span>pink
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> theme<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string-literal"><span class="token string">"gray"</span></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token class-name">Color</span><span class="token punctuation">.</span>gray
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> theme<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string-literal"><span class="token string">"orange"</span></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token class-name">Color</span><span class="token punctuation">.</span>orange
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token class-name">Color</span><span class="token punctuation">.</span>gray
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">var</span> score<span class="token punctuation">:</span> <span class="token class-name">Int</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> model<span class="token punctuation">.</span>score
    <span class="token punctuation">&#125;</span>
    
    <span class="token comment">// MARK: - Intent(s)</span>
    
    <span class="token keyword">func</span> <span class="token function-definition function">choose</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> card<span class="token punctuation">:</span> <span class="token class-name">MemoryGame</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">></span><span class="token punctuation">.</span><span class="token class-name">Card</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        model<span class="token punctuation">.</span><span class="token function">choose</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">newGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        theme <span class="token operator">=</span> themes<span class="token punctuation">.</span><span class="token function">randomElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span>
        cardcolor <span class="token operator">=</span> <span class="token class-name">EmojiMemoryGame</span><span class="token punctuation">.</span><span class="token function">color</span><span class="token punctuation">(</span>theme<span class="token punctuation">:</span> theme<span class="token punctuation">)</span>
        model <span class="token operator">=</span> <span class="token class-name">EmojiMemoryGame</span><span class="token punctuation">.</span><span class="token function">createMemoryGame</span><span class="token punctuation">(</span>theme<span class="token punctuation">:</span> theme<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>MemoryGame.swift</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">Foundation</span>

<span class="token keyword">struct</span> <span class="token class-name">MemoryGame</span><span class="token operator">&lt;</span><span class="token class-name">CardContent</span><span class="token operator">></span> <span class="token keyword">where</span> <span class="token class-name">CardContent</span><span class="token punctuation">:</span> <span class="token class-name">Equatable</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span><span class="token punctuation">(</span><span class="token keyword">set</span><span class="token punctuation">)</span> <span class="token keyword">var</span> cards<span class="token punctuation">:</span> <span class="token class-name">Array</span><span class="token operator">&lt;</span><span class="token class-name">Card</span><span class="token operator">></span>
    <span class="token keyword">private</span><span class="token punctuation">(</span><span class="token keyword">set</span><span class="token punctuation">)</span> <span class="token keyword">var</span> score<span class="token punctuation">:</span> <span class="token class-name">Int</span> <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">private</span> <span class="token keyword">var</span> indexOfTheOneAndOnlyFaceUpCard<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token operator">?</span>
    
    <span class="token keyword">mutating</span> <span class="token keyword">func</span> <span class="token function-definition function">choose</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> card<span class="token punctuation">:</span> <span class="token class-name">Card</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token keyword">let</span> chosenIndex <span class="token operator">=</span> cards<span class="token punctuation">.</span><span class="token function">firstIndex</span><span class="token punctuation">(</span><span class="token keyword">where</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>id <span class="token operator">==</span> card<span class="token punctuation">.</span>id <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           <span class="token operator">!</span>cards<span class="token punctuation">[</span>chosenIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>isFaceUp<span class="token punctuation">,</span>
           <span class="token operator">!</span>cards<span class="token punctuation">[</span>chosenIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>isMatched
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token keyword">let</span> potentialMatchIndex <span class="token operator">=</span> indexOfTheOneAndOnlyFaceUpCard <span class="token punctuation">&#123;</span> <span class="token comment">//å¦‚æœæœ‰çº¸ç‰Œè¢«æ€å¼€</span>
                <span class="token keyword">if</span> cards<span class="token punctuation">[</span>chosenIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>content <span class="token operator">==</span> cards<span class="token punctuation">[</span>potentialMatchIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>content <span class="token punctuation">&#123;</span> <span class="token comment">//èƒ½åŒ¹é…</span>
                    cards<span class="token punctuation">[</span>chosenIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>isMatched <span class="token operator">=</span> <span class="token boolean">true</span>
                    cards<span class="token punctuation">[</span>potentialMatchIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>isMatched <span class="token operator">=</span> <span class="token boolean">true</span>
                    score <span class="token operator">+=</span> <span class="token number">2</span>
                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                    <span class="token keyword">if</span> cards<span class="token punctuation">[</span>potentialMatchIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>seen <span class="token punctuation">&#123;</span>
                        score <span class="token operator">-=</span> <span class="token number">1</span>
                    <span class="token punctuation">&#125;</span>
                    <span class="token keyword">if</span> cards<span class="token punctuation">[</span>chosenIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>seen <span class="token punctuation">&#123;</span>
                        score <span class="token operator">-=</span> <span class="token number">1</span>
                    <span class="token punctuation">&#125;</span>
                    cards<span class="token punctuation">[</span>potentialMatchIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>seen <span class="token operator">=</span> <span class="token boolean">true</span>
                    cards<span class="token punctuation">[</span>chosenIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>seen <span class="token operator">=</span> <span class="token boolean">true</span>
                <span class="token punctuation">&#125;</span>
                
                indexOfTheOneAndOnlyFaceUpCard <span class="token operator">=</span> <span class="token nil constant">nil</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">for</span> index <span class="token keyword">in</span> cards<span class="token punctuation">.</span>indices <span class="token punctuation">&#123;</span>
                    cards<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>isFaceUp <span class="token operator">=</span> <span class="token boolean">false</span>
                <span class="token punctuation">&#125;</span>
                
                indexOfTheOneAndOnlyFaceUpCard <span class="token operator">=</span> chosenIndex
            <span class="token punctuation">&#125;</span>
            
            cards<span class="token punctuation">[</span>chosenIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>isFaceUp<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">init</span><span class="token punctuation">(</span>numberOfPairsOfCards<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">,</span> creatCardContent<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">CardContent</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        cards <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token operator">&lt;</span><span class="token class-name">Card</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">//æ·»åŠ ä¸¤å€çš„å¡ç‰Œ</span>
        <span class="token keyword">for</span> pairIndex <span class="token keyword">in</span> <span class="token number">0</span><span class="token operator">..&lt;</span>numberOfPairsOfCards <span class="token punctuation">&#123;</span>
            <span class="token keyword">let</span> content <span class="token operator">=</span> <span class="token function">creatCardContent</span><span class="token punctuation">(</span>pairIndex<span class="token punctuation">)</span>
            cards<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">Card</span><span class="token punctuation">(</span>content<span class="token punctuation">:</span> content<span class="token punctuation">,</span> id<span class="token punctuation">:</span> pairIndex<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            cards<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">Card</span><span class="token punctuation">(</span>content<span class="token punctuation">:</span> content<span class="token punctuation">,</span> id<span class="token punctuation">:</span> pairIndex<span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
        cards<span class="token punctuation">.</span><span class="token function">shuffle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">struct</span> <span class="token class-name">Card</span><span class="token punctuation">:</span> <span class="token class-name">Identifiable</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> isFaceUp<span class="token punctuation">:</span> <span class="token class-name">Bool</span> <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token keyword">var</span> isMatched<span class="token punctuation">:</span> <span class="token class-name">Bool</span> <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token keyword">var</span> content<span class="token punctuation">:</span> <span class="token class-name">CardContent</span>
        <span class="token keyword">var</span> id<span class="token punctuation">:</span> <span class="token class-name">Int</span>
        <span class="token keyword">var</span> seen<span class="token punctuation">:</span> <span class="token class-name">Bool</span> <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Theme.swift</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">Foundation</span>

<span class="token keyword">struct</span> <span class="token class-name">Theme</span> <span class="token punctuation">&#123;</span>
    
    <span class="token keyword">var</span> name<span class="token punctuation">:</span> <span class="token class-name">String</span>
    <span class="token keyword">var</span> emojis<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span>
    <span class="token keyword">var</span> numberOfPairsOfCards<span class="token punctuation">:</span> <span class="token class-name">Int</span>
    <span class="token keyword">var</span> color<span class="token punctuation">:</span> <span class="token class-name">String</span>
    
<span class="token punctuation">&#125;</span>

<span class="token keyword">private</span><span class="token punctuation">(</span><span class="token keyword">set</span><span class="token punctuation">)</span> <span class="token keyword">var</span> themes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Theme</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token class-name">Theme</span><span class="token punctuation">(</span>
        name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"Veiche"</span></span><span class="token punctuation">,</span>
        emojis<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"ğŸšŒ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš—"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš“"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš‘"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ›»"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš²"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš‚"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"âœˆï¸"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš€"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ›¶"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ›¸"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš•"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš™"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš›"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¦½"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš’"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸšœ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš "</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸš„"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ›°"</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        numberOfPairsOfCards<span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
        color<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"red"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">Theme</span><span class="token punctuation">(</span>
        name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"Animal"</span></span><span class="token punctuation">,</span>
        emojis<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"ğŸ¶"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ±"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ­"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ°"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¦Š"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ»"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¼"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ®"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸµ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ§"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¦‹"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¢"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¦†"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ™"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¦"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¦€"</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        numberOfPairsOfCards<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
        color<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"blue"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">Theme</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"Face"</span></span><span class="token punctuation">,</span>
           emojis<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"ğŸ˜€"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"â˜ºï¸"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜Š"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜‡"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¥°"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜Œ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜‰"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ™ƒ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜‹"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¤¨"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜’"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜­"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¥µ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜³"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¤”"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¤—"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜·"</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
           numberOfPairsOfCards<span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
           color<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"green"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">Theme</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"Hallowmans"</span></span><span class="token punctuation">,</span>
           emojis<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"ğŸ‘»"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸƒ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ˜ˆ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¬"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ•·"</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
           numberOfPairsOfCards<span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
           color<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"orange"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">Theme</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"Foot"</span></span><span class="token punctuation">,</span>
           emojis<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"ğŸ‚"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¡"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ±"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ›"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸŒ¯"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ•"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸŸ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ”"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸŒ­"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ—"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¥—"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ²"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¤"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¥®"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¥§"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ©"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸª"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸµ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¥"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¥–"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ¥"</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">"ğŸ«•"</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
           numberOfPairsOfCards<span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
           color<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"purple"</span></span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å‚è€ƒä»£ç ï¼š<a href="https://github.com/sk-ruban/CS193p">https://github.com/sk-ruban/CS193p</a></p>
]]></content>
      <tags>
        <tag>swift</tag>
        <tag>cs193p</tag>
      </tags>
  </entry>
  <entry>
    <title>CS193p_note 1-4</title>
    <url>/2022/02/20/cs193-note1-2/</url>
    <content><![CDATA[<h3 id="RoundedRectangle"><a href="#RoundedRectangle" class="headerlink" title="RoundedRectangle"></a>RoundedRectangle</h3><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">RoundedRectangle</span><span class="token punctuation">(</span>cornerRadius<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//å¡«æ»¡</span>
	<span class="token punctuation">.</span><span class="token function">foregroundColor</span><span class="token punctuation">(</span><span class="token punctuation">.</span>red<span class="token punctuation">)</span> <span class="token comment">//å‰æ™¯é¢œè‰²</span>
	<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span>lineWidth<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">//è¾¹æ¡†å®½åº¦</span>
	<span class="token punctuation">.</span>strokeBorder<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<span id="more"></span>

<h3 id="ZStack"><a href="#ZStack" class="headerlink" title="ZStack"></a>ZStack</h3><p>åœ¨zè½´å åŠ è§†å›¾ï¼Œè¿”å›ä¸€æ•´ä¸ªè§†å›¾å†…å®¹</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">ZStack</span><span class="token punctuation">(</span>alignment<span class="token punctuation">:</span> <span class="token punctuation">.</span>top<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token comment">//åœ¨é¡¶éƒ¨å¯¹é½</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="HStack"><a href="#HStack" class="headerlink" title="HStack"></a>HStack</h3><p>æ°´å¹³å †å </p>
<h3 id="LazyVGrid"><a href="#LazyVGrid" class="headerlink" title="LazyVGrid"></a>LazyVGrid</h3><p>ç½‘æ ¼ï¼ŒæŒ‡å®šåˆ—æ•°ï¼ŒæŠŠå°½å¯èƒ½å¤šçš„ä¸œè¥¿æ”¾åœ¨ä¸€è¡Œï¼Œå‚ç›´æ»‘åŠ¨ï¼Œæ­é…ScrollViewä½¿ç”¨</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">LazyVGrid</span><span class="token punctuation">(</span>columns<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">GridItem</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">adaptive</span><span class="token punctuation">(</span>minimum<span class="token punctuation">:</span> <span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="MVVM"><a href="#MVVM" class="headerlink" title="MVVM"></a>MVVM</h3><p>åˆ†ç¦»äº†ç”¨æˆ·ç•Œé¢ä»£ç </p>
<h4 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h4><p>å®Œå…¨ç‹¬ç«‹äºUI data å’Œ logicï¼Œappå®é™…ä¸Šåšä»€ä¹ˆ</p>
<h4 id="View"><a href="#View" class="headerlink" title="View"></a>View</h4><p>åæ˜ modelå†…å®¹ å“åº”å¼</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token attribute atrule">@ObservedObject</span>
<span class="token attribute atrule">@Binding</span>
<span class="token punctuation">.</span>onReceive
<span class="token attribute atrule">@EnvironmentObject</span>
<span class="token punctuation">.</span><span class="token function">environmentObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="ModelView"><a href="#ModelView" class="headerlink" title="ModelView"></a>ModelView</h4><p>ç»‘å®šviewå’Œmodelï¼Œè§£é‡Šå™¨ã€‚Viewé€šè¿‡ViewModelè·å–Modelçš„æ•°æ®ï¼Œä»æ¥ä¸å‚¨å­˜æ•°æ®ã€‚</p>
<p>ViewModelä¸æ–­è§‚å¯ŸModelä¸­çš„å˜åŒ–ï¼Œå‘å¸ƒå˜åŒ–ï¼Œè§†å›¾subscribingï¼ˆè®¢é˜…ï¼‰ï¼Œå‘å¸ƒçš„å†…å®¹ã€‚ä½¿ç”¨class</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token attribute atrule">@ObservableObject</span>
<span class="token attribute atrule">@Published</span>
objectWillChange<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¤„ç†ç”¨æˆ·æ„å›¾ï¼Œä¿®æ”¹Modelå†…å®¹</p>
<h3 id="Types"><a href="#Types" class="headerlink" title="Types"></a>Types</h3><h4 id="struct-amp-amp-class"><a href="#struct-amp-amp-class" class="headerlink" title="struct &amp;&amp; class"></a>struct &amp;&amp; class</h4><p>å‚¨å­˜å˜é‡å’Œè®¡ç®—å˜é‡ã€å‡½æ•°ã€åˆå§‹åŒ–å™¨</p>
<p>ViewModelä½¿ç”¨classï¼Œåœ¨æ‰€æœ‰è§†å›¾ä¸­å…±äº«</p>
<table>
<thead>
<tr>
<th align="center">struct</th>
<th align="center">class</th>
</tr>
</thead>
<tbody><tr>
<td align="center">å€¼ç±»å‹</td>
<td align="center">å¼•ç”¨ç±»å‹</td>
</tr>
<tr>
<td align="center">ä¼ é€’æˆ–åˆ†é…å˜é‡æ—¶å¤åˆ¶å†…å®¹</td>
<td align="center">ä¼ é€’æ—¶åªä¼ é€’æŒ‡å‘å®ƒçš„æŒ‡é’ˆ</td>
</tr>
<tr>
<td align="center">å†™æ—¶å¤åˆ¶ï¼Œç›´åˆ°ä¿®æ”¹æ‰ä¼šå¤åˆ¶å®Œæ•´å†…å®¹</td>
<td align="center">è‡ªåŠ¨å¼•ç”¨è®¡æ•°ï¼Œè·Ÿè¸ªæœ‰å¤šå°‘æŒ‡å‘æŸäº‹ç‰©çš„æŒ‡é’ˆï¼Œæ²¡äººæŒ‡å‘æ—¶ï¼Œä»å†…å­˜ä¸­åˆ é™¤</td>
</tr>
<tr>
<td align="center">å‡½æ•°å¼ç¼–ç¨‹</td>
<td align="center">é¢å¯¹å¯¹è±¡ç¼–ç¨‹</td>
</tr>
<tr>
<td align="center">æ²¡æœ‰ç»§æ‰¿</td>
<td align="center">å•ä¸€ç»§æ‰¿</td>
</tr>
<tr>
<td align="center">å…è´¹åˆå§‹åŒ–æ‰€æœ‰å˜é‡ï¼Œå¦‚æœæ²¡æœ‰ç¼–å†™initå‡½æ•°</td>
<td align="center">ä¸èƒ½åˆå§‹åŒ–å˜é‡</td>
</tr>
<tr>
<td align="center">æ˜ç¡®çš„å®šä¹‰ var let</td>
<td align="center">æ€»æ˜¯å¯å˜çš„</td>
</tr>
</tbody></table>
<h4 id="Generics"><a href="#Generics" class="headerlink" title="Generics"></a>Generics</h4><p>å¯¹ä¸çŸ¥é“ç±»å‹ä¸Šçš„æ•°æ®ï¼Œä¸åœ¨ä¹å®ƒæ˜¯ä»€ä¹ˆç±»å‹</p>
<p>ç±»å‹å‚æ•°</p>
<h4 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h4><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">var</span> operation<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Double</span>

<span class="token keyword">func</span> <span class="token function-definition function">square</span><span class="token punctuation">(</span>operand<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Double</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> operand <span class="token operator">*</span> operand
<span class="token punctuation">&#125;</span>

operation <span class="token operator">=</span> square
<span class="token keyword">let</span> result1 <span class="token operator">=</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">//16 	è°ƒç”¨æ—¶ä¸ä½¿ç”¨æ ‡ç­¾</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="ååº”"><a href="#ååº”" class="headerlink" title="ååº”"></a>ååº”</h3><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token attribute atrule">@ObservableObject</span> <span class="token comment">//å‘ä¸–ç•Œå‘å¸ƒæœ‰æ‰€æ”¹å˜</span>
<span class="token comment">//å¾—åˆ°ä¸€ä¸ªçœ‹ä¸è§çš„var</span>
<span class="token keyword">var</span> objectWillChange<span class="token punctuation">:</span> <span class="token class-name">ObservableObjectPublisher</span>
objectWillChange<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//å‘ä¸–ç•Œå‘é€æ”¹å˜</span>
<span class="token attribute atrule">@Published</span> <span class="token comment">//æ”¾åœ¨å˜é‡å‰æ— è®ºä½•æ—¶å‘ç”Ÿå˜åŒ–éƒ½å‘é€</span>
<span class="token attribute atrule">@ObservedObject</span> <span class="token comment">//æ”¾åœ¨å˜é‡å‰ï¼Œå‘ç”Ÿæ”¹å˜æ—¶é‡å»ºbody</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="enum"><a href="#enum" class="headerlink" title="enum"></a>enum</h3><p>æ•°æ®ç»“æ„ï¼Œç¦»æ•£çš„å€¼</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">enum</span> <span class="token class-name">FastFoodMenuItem</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> hamburger
    <span class="token keyword">case</span> fries
    <span class="token keyword">case</span> drink
    <span class="token keyword">case</span> cookie
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>å€¼ä¼ é€’ï¼Œä¼šè¢«å¤åˆ¶</li>
</ul>
<p>æ¯ä¸ªçŠ¶æ€éƒ½å¯ä»¥æœ‰ä¸€äº›å…³è”æ•°æ®</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">enum</span> <span class="token class-name">FastFoodMenuItem</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> <span class="token function">hamburger</span><span class="token punctuation">(</span>numberOfPatties<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> <span class="token function">fries</span><span class="token punctuation">(</span>size<span class="token punctuation">:</span> <span class="token class-name">FryOrderSize</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> <span class="token function">drink</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">,</span> ounces<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token comment">//stringæ²¡æœ‰æ ‡ç­¾</span>
    <span class="token keyword">case</span> cookie
<span class="token punctuation">&#125;</span>
<span class="token keyword">enum</span> <span class="token class-name">FryOrderSize</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> large
    <span class="token keyword">case</span> small
<span class="token punctuation">&#125;</span>
<span class="token keyword">let</span> menuItem<span class="token punctuation">:</span> <span class="token class-name">FastFoodMenuItem</span> <span class="token operator">=</span> <span class="token class-name">FastFoodMenuItem</span><span class="token punctuation">.</span><span class="token function">hamburger</span><span class="token punctuation">(</span>patties<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> otherItem<span class="token punctuation">:</span> <span class="token class-name">FastFoodMenuItem</span> <span class="token operator">=</span> <span class="token punctuation">.</span>cookie<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ£€æŸ¥å€¼</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">var</span> menuItem<span class="token punctuation">:</span> <span class="token class-name">FastFoodMenuItem</span> <span class="token operator">=</span> <span class="token class-name">FastFoodMenuItem</span><span class="token punctuation">.</span><span class="token function">hamburger</span><span class="token punctuation">(</span>patties<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">switch</span> menuItem <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">hamburger</span><span class="token punctuation">(</span><span class="token keyword">let</span> pattyCount<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"a burger with </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">pattyCOunt</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string"> patties!"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> <span class="token punctuation">.</span>fries<span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"fries"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> <span class="token punctuation">.</span>drink<span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"drink"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> <span class="token punctuation">.</span>cookie<span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"cookie"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"other"</span></span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>switchä¹Ÿé€‚ç”¨äºå…¶ä»–ç±»å‹</p>
<p>enumå…è®¸æœ‰æ–¹æ³•å’Œè®¡ç®—å˜é‡ï¼Œä¸èƒ½æœ‰å®é™…å­˜å‚¨çš„å˜é‡</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">enum</span> <span class="token class-name">FastFoodMenuItem</span> <span class="token punctuation">&#123;</span>
    
    fun <span class="token function">isIncludeInSpeciaOrder</span><span class="token punctuation">(</span>number<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Bool</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">switch</span> <span class="token keyword">self</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">hamburger</span><span class="token punctuation">(</span><span class="token keyword">let</span> pattyCount<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">return</span> pattyCount <span class="token operator">==</span> number
            <span class="token keyword">case</span> <span class="token punctuation">.</span>fries<span class="token punctuation">,</span> <span class="token punctuation">.</span>cookie<span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token boolean">true</span>
            <span class="token keyword">case</span><span class="token punctuation">.</span><span class="token function">drink</span><span class="token punctuation">(</span><span class="token omit keyword">_</span><span class="token punctuation">,</span> <span class="token keyword">let</span> ounces<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">return</span> ounces <span class="token operator">==</span> <span class="token number">16</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>éå†æ‰€æœ‰çŠ¶æ€ï¼Œè¿­ä»£</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">enum</span> <span class="token class-name">TeslaModel</span><span class="token punctuation">:</span> <span class="token class-name">CaseIterable</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> <span class="token class-name">X</span>
    <span class="token keyword">case</span> <span class="token class-name">S</span>
    <span class="token keyword">case</span> <span class="token class-name">Three</span>
    <span class="token keyword">case</span> <span class="token class-name">Y</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">for</span> model <span class="token keyword">in</span> <span class="token class-name">TeslaModel</span><span class="token punctuation">.</span>allCase <span class="token punctuation">&#123;</span>
    <span class="token function">reportSalesNumber</span><span class="token punctuation">(</span><span class="token keyword">for</span><span class="token punctuation">:</span> model<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
fun <span class="token function">reportSalesNumber</span><span class="token punctuation">(</span><span class="token keyword">for</span> model<span class="token punctuation">:</span> <span class="token class-name">TeslaModel</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">switch</span> model <span class="token punctuation">&#123;</span> <span class="token operator">...</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Optionals"><a href="#Optionals" class="headerlink" title="Optionals"></a>Optionals</h3><p>ä¸¤ç§æšä¸¾ï¼šå­˜åœ¨å’Œä¸å­˜åœ¨</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">enum</span> <span class="token class-name">Optional</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> <span class="token keyword">none</span>
    <span class="token keyword">case</span> <span class="token keyword">some</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">var</span> hello<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token operator">?</span>
<span class="token keyword">var</span> hello<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"hello"</span></span>
<span class="token keyword">var</span> hello<span class="token punctuation">:</span> <span class="token class-name">Striong</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token nil constant">nil</span>	<span class="token keyword">var</span> hello<span class="token punctuation">:</span> <span class="token class-name">Optional</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token keyword">none</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¼ºåˆ¶è§£åŒ… !  æˆ–è€…ä½¿ç”¨if let</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">if</span> <span class="token keyword">let</span> safehello <span class="token operator">=</span> hello <span class="token punctuation">&#123;</span>
	<span class="token function">print</span><span class="token punctuation">(</span>safehello<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">let</span> y <span class="token operator">=</span> x <span class="token operator">??</span> <span class="token string-literal"><span class="token string">"foo"</span></span> <span class="token comment">//å¦‚æœæœªè®¾ç½®ä¸ºfoo</span>
<span class="token keyword">let</span> y <span class="token operator">=</span> x<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span>bar<span class="token operator">?</span><span class="token punctuation">.</span>z <span class="token comment">//åªè¦æœ‰ä¸€ä¸ªæ˜¯nil å…¨æ˜¯nil</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

]]></content>
      <tags>
        <tag>swift</tag>
        <tag>cs193p</tag>
      </tags>
  </entry>
  <entry>
    <title>cs193p_note10_Multithreading Demo Gestures</title>
    <url>/2022/05/19/cs193p-note10/</url>
    <content><![CDATA[<h3 id="è®¾ç½®å›¾ç‰‡èƒŒæ™¯"><a href="#è®¾ç½®å›¾ç‰‡èƒŒæ™¯" class="headerlink" title="è®¾ç½®å›¾ç‰‡èƒŒæ™¯"></a>è®¾ç½®å›¾ç‰‡èƒŒæ™¯</h3><p>æ¥æ”¶urlå’Œimage</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">var</span> found <span class="token operator">=</span> providers<span class="token punctuation">.</span><span class="token function">loadObjects</span><span class="token punctuation">(</span>ofType<span class="token punctuation">:</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> url <span class="token keyword">in</span>
           document<span class="token punctuation">.</span><span class="token function">setBackground</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span>imageURL<span class="token punctuation">)</span><span class="token punctuation">)</span>
       <span class="token punctuation">&#125;</span>
       <span class="token keyword">if</span> <span class="token operator">!</span>found <span class="token punctuation">&#123;</span>
           found <span class="token operator">=</span> providers<span class="token punctuation">.</span><span class="token function">loadObjects</span><span class="token punctuation">(</span>ofType<span class="token punctuation">:</span> <span class="token class-name">UIImage</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> image <span class="token keyword">in</span>
               <span class="token keyword">if</span> <span class="token keyword">let</span> data <span class="token operator">=</span> image<span class="token punctuation">.</span><span class="token function">jpegData</span><span class="token punctuation">(</span>compressionQuality<span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                   document<span class="token punctuation">.</span><span class="token function">setBackground</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">imageData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
               <span class="token punctuation">&#125;</span><span class="token comment">//å¦‚æœæ˜¯jpg æ— æŸå‹ç¼©</span>
           <span class="token punctuation">&#125;</span>
       <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<span id="more"></span>

<p>æ›´æ–°èƒŒæ™¯å›¾ç‰‡ï¼Œä¸èƒ½æŠŠbackgroundImageå˜æˆè®¡ç®—å±æ€§ï¼Œå› ä¸ºåœ¨ç¼“æ…¢åœ°ç½‘ç»œè¢«è·å–éœ€è¦å‡ ç§’æˆ–è®¸ä¸€åˆ†é’Ÿ</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token attribute atrule">@Published</span> <span class="token keyword">private</span><span class="token punctuation">(</span><span class="token keyword">set</span><span class="token punctuation">)</span> <span class="token keyword">var</span> emojiArt<span class="token punctuation">:</span> <span class="token class-name">EmojiArtModel</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">didSet</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> emojiArt<span class="token punctuation">.</span>background <span class="token operator">!=</span> oldValue<span class="token punctuation">.</span>background <span class="token punctuation">&#123;</span>
            <span class="token function">fetchBackgroundImageDataIfNecessary</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä½¿ç”¨tryæ¥è§£å†³æŠ›å‡ºé”™è¯¯</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">fetchBackgroundImageDataIfNecessary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    backgroundImage <span class="token operator">=</span> <span class="token nil constant">nil</span>
    <span class="token keyword">switch</span> emojiArt<span class="token punctuation">.</span>background <span class="token punctuation">&#123;</span>
        <span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token keyword">let</span> url<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">//è·å–url</span>
        <span class="token keyword">let</span> imageData <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">?</span> <span class="token class-name">Data</span><span class="token punctuation">(</span>contentsOf<span class="token punctuation">:</span> url<span class="token punctuation">)</span> <span class="token comment">//ä¼šé˜»å¡UI</span>
        <span class="token keyword">if</span> imageData <span class="token operator">!=</span> <span class="token nil constant">nil</span> <span class="token punctuation">&#123;</span>
            backgroundImage <span class="token operator">=</span> <span class="token class-name">UIImage</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> imageData<span class="token operator">!</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">imageData</span><span class="token punctuation">(</span><span class="token keyword">let</span> image<span class="token punctuation">)</span><span class="token punctuation">:</span>
        backgroundImage <span class="token operator">=</span> <span class="token class-name">UIImage</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> image<span class="token punctuation">)</span>
        <span class="token keyword">case</span> <span class="token punctuation">.</span>blank<span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä½†æ˜¯ï¼Œurlè€—æ—¶å¾ˆé•¿ï¼Œè¦ä½¿ç”¨å¤šçº¿ç¨‹è§£å†³é—®é¢˜</p>
<ul>
<li>self:å†…éƒ¨æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œè¢«æ”¾å…¥å†…å­˜å¹¶ä¸”åšæŒåˆ°è¿™ä»¶äº‹å®Œæˆè¿è¡Œï¼Œé—­åŒ…æ˜¯å¼•ç”¨ç±»å‹ã€‚é€šè¿‡selfæŠŠé—­åŒ…å­˜å…¥å†…å­˜å¹¶æŒ‡å‘viewmodelï¼Œè¢«ä¿å­˜åœ¨å †ä¸­ï¼Œå³ä½¿å…³é—­æ–‡æ¡£ä¹Ÿæ— æ³•é€€å‡º</li>
</ul>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">DispatchQueue</span><span class="token punctuation">.</span><span class="token function">global</span><span class="token punctuation">(</span>qos<span class="token punctuation">:</span> <span class="token punctuation">.</span>userInitiated<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">async</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> imageData <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">?</span> <span class="token class-name">Data</span><span class="token punctuation">(</span>contentsOf<span class="token punctuation">:</span> url<span class="token punctuation">)</span> <span class="token comment">//ä¼šé˜»å¡UI</span>
    <span class="token class-name">DispatchQueue</span><span class="token punctuation">.</span>main<span class="token punctuation">.</span>asunc<span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> imageData <span class="token operator">!=</span> <span class="token nil constant">nil</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>backgroundImage <span class="token operator">=</span> <span class="token class-name">UIImage</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> imageData<span class="token operator">!</span><span class="token punctuation">)</span> <span class="token comment">//ä¸åœ¨åå°çº¿ç¨‹ä¸­ä¿®æ”¹UI</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>å¼±å¼•ç”¨:ä¸å¼ºåˆ¶selfåœ¨å †ä¸­ï¼Œæ²¡æœ‰å…¶ä»–äººæŠŠå®ƒæ”¾å…¥å †ä¸­å°±ä¼šæ¶ˆå¤±ï¼Œå˜æˆnil</li>
</ul>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">DispatchQueue</span><span class="token punctuation">.</span>main<span class="token punctuation">.</span>asunc<span class="token punctuation">&#123;</span> <span class="token punctuation">[</span><span class="token keyword">weak</span> <span class="token keyword">self</span><span class="token punctuation">]</span> <span class="token keyword">in</span> 
    <span class="token keyword">if</span> imageData <span class="token operator">!=</span> <span class="token nil constant">nil</span> <span class="token punctuation">&#123;</span>
   		<span class="token keyword">self</span><span class="token operator">?</span><span class="token punctuation">.</span>backgroundImage <span class="token operator">=</span> <span class="token class-name">UIImage</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> imageData<span class="token operator">!</span><span class="token punctuation">)</span> <span class="token comment">//å¦‚æœselfä¸ºnilä¸è¿›è¡Œè¯­å¥æ“ä½œ</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœå›¾ç‰‡åŠ è½½æ—¶é—´è¿‡é•¿ï¼Œç”¨æˆ·å¯èƒ½ä¼šæ‹–åŠ¨åˆ«çš„å›¾ç‰‡è¿›å…¥ï¼Œä»£ç ä¼šè¢«å†æ¬¡è¿è¡Œï¼Œç­‰ç¬¬ä¸€ä¸ªå›¾ç‰‡åŠ è½½å®Œæˆæ—¶ï¼Œå¯èƒ½ä¼šåŠ è½½ç¬¬ä¸€å¼ å›¾ç‰‡ã€‚å…³äºå¼‚æ­¥å¤šçº¿ç¨‹ç¼–ç¨‹ï¼Œéœ€è¦æ³¨æ„æ¯å½“ä½ ä»æŸäº‹å›æ¥éœ€è¦å¾ˆé•¿çŸ¥è¯†æ—¶ï¼Œæ£€æŸ¥ä¸–ç•Œè¿˜æ˜¯ä¸æ˜¯ä½ ç¦»å¼€æ—¶çš„äºšå­ã€‚</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">DispatchQueue</span><span class="token punctuation">.</span>main<span class="token punctuation">.</span><span class="token keyword">async</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span><span class="token keyword">weak</span> <span class="token keyword">self</span><span class="token punctuation">]</span> <span class="token keyword">in</span>
	<span class="token keyword">if</span> <span class="token keyword">self</span><span class="token operator">?</span><span class="token punctuation">.</span>emojiArt<span class="token punctuation">.</span>background <span class="token operator">==</span> <span class="token class-name">EmojiArtModel</span><span class="token punctuation">.</span><span class="token class-name">Background</span><span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span> imageData <span class="token operator">!=</span> <span class="token nil constant">nil</span> <span class="token punctuation">&#123;</span>
			<span class="token keyword">self</span><span class="token operator">?</span><span class="token punctuation">.</span>backgroundImage <span class="token operator">=</span> <span class="token class-name">UIImage</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> imageData<span class="token operator">!</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç»™ç”¨æˆ·æ­£åœ¨åŠ è½½çš„åé¦ˆ</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token attribute atrule">@Published</span> <span class="token keyword">var</span> backgroundImageFetchStatus <span class="token operator">=</span> <span class="token class-name">BackgroundImageFetchStatus</span><span class="token punctuation">.</span>idle <span class="token comment">//ç›‘æµ‹åŠ è½½çŠ¶æ€</span>
<span class="token keyword">enum</span> <span class="token class-name">BackgroundImageFetchStatus</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> idle <span class="token comment">//é—²ç½®</span>
    <span class="token keyword">case</span> fetching <span class="token comment">//åŠ è½½</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Gestures"><a href="#Gestures" class="headerlink" title="Gestures"></a>Gestures</h3><h4 id="ç†è®ºçŸ¥è¯†"><a href="#ç†è®ºçŸ¥è¯†" class="headerlink" title="ç†è®ºçŸ¥è¯†"></a>ç†è®ºçŸ¥è¯†</h4><ul>
<li><p>ä½¿ç”¨æ‰‹åŠ¿è§†å›¾ä¿®æ”¹å™¨è®©è§†å›¾è¯†åˆ«æ‰‹åŠ¿</p>
<p>  <code>myview.gesture(theGesture)</code>  æ‰‹åŠ¿åè®®</p>
</li>
<li><p>åˆ›å»ºç¦»æ•£å‹æ‰‹åŠ¿</p>
<p>  é€šå¸¸åªæœ‰ä¸€ä¸ªfuncå’Œvaråœ¨æˆ‘ä»¬çš„è§†å›¾ä¸­ï¼Œç”šè‡³åªæœ‰ä¸€ä¸ªå±€éƒ¨å˜é‡</p>
  <pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">var</span> theGesture<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">Gesture</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">return</span> <span class="token class-name">TapGesture</span><span class="token punctuation">(</span>count<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">//åŒå‡»æ‰‹åŠ¿</span>
    	<span class="token punctuation">.</span>onEnded<span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span> <span class="token comment">//æ”¾å…¥éœ€è¦å®ç°çš„å†…å®¹</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>  é€šå¸¸ç¦»æ•£å‹æ‰‹åŠ¿ä½¿ç”¨è§†å›¾ä¿®é¥°ç¬¦</p>
  <pre class="line-numbers language-swift" data-language="swift"><code class="language-swift">myview<span class="token punctuation">.</span><span class="token function">onTapGesture</span><span class="token punctuation">(</span>count<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
myview<span class="token punctuation">.</span><span class="token function">onLongPressGesture</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>éç¦»æ•£å‹æ‰‹åŠ¿</p>
<p>  ä¸ä»…éœ€è¦å¤„ç†æ‰‹åŠ¿è¢«è¯†åˆ«å¹¶ä¸”ç»“æŸï¼Œè¿˜è¦ç›‘æµ‹åœ¨æçš„å…¨è¿‡ç¨‹ä¸­çš„æ—‹è½¬ã€å¤§å°æ”¹å˜ç­‰ã€‚</p>
<p>  <code>DragGesture</code>, <code>MagnificationGesture</code> ,<code>RotationGesture</code> <code>longPressGesture</code>ä¹Ÿå¯ä»¥çœ‹åšéç¦»æ•£ï¼ŒæŒ‰ä½æ˜¯ä¸€ç›´æ›´æ–°</p>
  <pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">var</span> theGesture<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">Gesture</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">DragGesture</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
    	<span class="token punctuation">.</span>onEnded <span class="token punctuation">&#123;</span> value <span class="token keyword">in</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>  valueå€¼æ¥æºäºå½“å‰ç›‘å¬æ‰‹åŠ¿</p>
<ul>
<li>DragGesture æ‹–åŠ¨æ‰‹åŠ¿ï¼Œä¸€ä¸ªç»“æ„ä½“åŒ…å«å¼€å§‹å’Œç»“æŸä½ç½®</li>
<li>MagnificationGesture æ”¾å¤§æåˆæ‰‹åŠ¿ æ‰‹æŒ‡æ”¾å¤§äº†å¤šå°‘ï¼Œå¤šè¿œ</li>
<li>RotationGesture æ—‹è½¬æ‰‹åŠ¿ï¼Œè§’åº¦</li>
</ul>
</li>
<li><p>éç¦»æ•£æ‰‹åŠ¿ç›‘å¬</p>
  <pre class="line-numbers language-none"><code class="language-none">@GestureState var myGestureState: MyGestureType &#x3D; &lt; &gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>  å¯ä»¥å­˜å‚¨ä»»ä½•ä¿¡æ¯è®©è§†å›¾è‡ªåŠ¨æ›´æ–°ï¼Œå¹¶åœ¨æ‰‹åŠ¿è¿›è¡Œæ—¶é‡ç»˜è‡ªèº«</p>
<p>  <strong>å½“æ‰‹åŠ¿ç»“æŸæ—¶ï¼Œvarä¼šå›åˆ°åˆå§‹å€¼</strong></p>
  <pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">var</span> theGesture<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">Gesture</span> <span class="token punctuation">&#123;</span>
	<span class="token class-name">DragGesture</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">updating</span><span class="token punctuation">(</span>$myGestureState<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> value<span class="token punctuation">,</span> myGestureState<span class="token punctuation">,</span> transaction <span class="token keyword">in</span>
			myGestureState <span class="token operator">=</span> 
		<span class="token punctuation">&#125;</span>
		<span class="token punctuation">.</span><span class="token function">onEnded</span> <span class="token punctuation">(</span> value <span class="token keyword">in</span><span class="token punctuation">)</span><span class="token comment">//è¿½è¸ªç»“æŸæ—¶çŠ¶æ€</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>.updating å½“æ‰‹æŒ‡ç§»åŠ¨æ—¶è¢«é‡å¤è°ƒç”¨</li>
<li>$ æ”¾åœ¨@GestureStateå˜é‡å‰é¢ï¼Œå‘Šè¯‰ç³»ç»Ÿä½¿ç”¨å“ªä¸ªå˜é‡</li>
<li>valueå–å†³äºå“ªä¸ªæ‰‹åŠ¿</li>
<li>myGestureState ä¸€ä¸ªè¾“å…¥è¾“å‡ºå‚æ•°ï¼Œå”¯ä¸€æ–¹å¼ä¿®æ”¹GestureStateçš„å€¼ï¼Œå¤åˆ¶å€¼ç±»å‹ï¼Œåæ‚”çš„æ—¶å€™å†å¤åˆ¶å›å»</li>
<li>transaction åŠ¨ç”»ç›¸å…³</li>
</ul>
  <pre class="line-numbers language-none"><code class="language-none">DragGesture(...)
	.onChanged &#123; value in 
		&#x2F;&#x2F;æ— æ³•æ›´æ–°çŠ¶æ€ï¼Œåªæä¾›ä»·å€¼
	&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>  åªèƒ½æ ¹æ®å½“å‰çŠ¶æ€ç»˜åˆ¶å›¾å½¢ï¼Œæ›´æ–°æ°¸ä¹…çŠ¶æ€ï¼Œæ‰‹åŠ¿ç»“æŸä¹‹åä¸é‡ç½®</p>
</li>
</ul>
<h4 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h4><ul>
<li><p>è®¾ç½®åŒå‡»è°ƒæ•´èƒŒæ™¯é€‚åº”å±å¹•</p>
<p>  è®¾ç½®åŒå‡»æ‰‹åŠ¿æ•ˆæœ</p>
  <pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token punctuation">.</span><span class="token function">gesture</span><span class="token punctuation">(</span><span class="token function">doubleTapToZoom</span><span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">:</span> geometry<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">doubleTapToZoom</span><span class="token punctuation">(</span><span class="token keyword">in</span> size<span class="token punctuation">:</span> <span class="token class-name">CGSize</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">Gesture</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">TapGesture</span><span class="token punctuation">(</span>count<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>onEnded <span class="token punctuation">&#123;</span>
        withAnimation <span class="token punctuation">&#123;</span>
            <span class="token function">zoomToFit</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>backgroundImage<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> size<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>ä½¿ç”¨ææ‰‹åŠ¿è¿›è¡Œç¼©æ”¾</p>
  <pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token punctuation">.</span><span class="token function">gesture</span><span class="token punctuation">(</span><span class="token function">zoomGesture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">//ç¼©æ”¾æ‰‹åŠ¿</span>
<span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">zoomGesture</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">Gesture</span> <span class="token punctuation">&#123;</span>
	<span class="token class-name">MagnificationGesture</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//æåˆæ‰‹åŠ¿</span>
		<span class="token punctuation">.</span><span class="token function">updating</span><span class="token punctuation">(</span>$gestureZoomScale<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> latestGestureScale<span class="token punctuation">,</span> ourGestureStateInOut<span class="token punctuation">,</span> transaction <span class="token keyword">in</span><span class="token comment">//æ‰‹æŒ‡åˆ†å¼€è·ç¦»</span>
			ourGestureStateInOut <span class="token operator">=</span> latestGestureScale
		<span class="token punctuation">&#125;</span>
    <span class="token punctuation">.</span>onEnded <span class="token punctuation">&#123;</span> gestureScaleAtEnd <span class="token keyword">in</span> <span class="token comment">//æ˜¯å¼€å§‹æ‰‹æŒ‡è·ç¦»çš„å‡ å€</span>
		steadyStateZoomScale <span class="token operator">*=</span> gestureScaleAtEnd
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>æ‹–åŠ¨èƒŒæ™¯</p>
  <pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">panGesture</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">Gesture</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">DragGesture</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">updating</span><span class="token punctuation">(</span>$gesturePanOffset<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> latestDragGestureValue<span class="token punctuation">,</span> gesturePanOffset<span class="token punctuation">,</span> <span class="token omit keyword">_</span> <span class="token keyword">in</span>
            gesturePanOffset <span class="token operator">=</span> latestDragGestureValue<span class="token punctuation">.</span>translation <span class="token operator">/</span> zoomScale
        <span class="token punctuation">&#125;</span>
        <span class="token punctuation">.</span>onEnded <span class="token punctuation">&#123;</span> finalDragGestureValue <span class="token keyword">in</span>
            steadyStatePanOffset <span class="token operator">=</span> steadyStatePanOffset <span class="token operator">+</span> <span class="token punctuation">(</span>finalDragGestureValue<span class="token punctuation">.</span>translation <span class="token operator">/</span> zoomScale<span class="token punctuation">)</span> <span class="token comment">//å›¾ç‰‡å˜å¤§çš„æ—¶å€™,ç§»åŠ¨çš„è·ç¦»å°, translation ç»“æŸ-å¼€å§‹</span>
        <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>  ç»„åˆä¸¤ä¸ªä¸åŒæ‰‹åŠ¿</p>
  <pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token punctuation">.</span><span class="token function">gesture</span><span class="token punctuation">(</span><span class="token function">panGesture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">simultaneously</span><span class="token punctuation">(</span>with<span class="token punctuation">:</span> <span class="token function">zoomGesture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//ç»„åˆä¸¤ä¸ªä¸åŒæ‰‹åŠ¿</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
]]></content>
      <tags>
        <tag>swift</tag>
        <tag>cs193p</tag>
      </tags>
  </entry>
  <entry>
    <title>cs193p_note11_Error Persistence</title>
    <url>/2022/06/02/cs193p-note11/</url>
    <content><![CDATA[<h3 id="Error-Handing"><a href="#Error-Handing" class="headerlink" title="Error Handing"></a>Error Handing</h3><h4 id="Throwing-errors"><a href="#Throwing-errors" class="headerlink" title="Throwing errors"></a>Throwing errors</h4><p>å¾ˆå¤šå‡½æ•°éƒ½æœ‰<code>throws</code>å…³é”®å­—ï¼Œä½ å¯ä»¥æŠ›å‡ºé”™è¯¯</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">func</span> <span class="token function-definition function">attendLecture</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> sleptIn <span class="token punctuation">&#123;</span>
        <span class="token keyword">throw</span> <span class="token class-name">CS193pError</span><span class="token punctuation">.</span>missedLecture
    <span class="token punctuation">&#125;</span>
    <span class="token function">askQuestion</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//å¦‚æœæŠ›å‡ºé”™è¯¯ï¼Œå‡½æ•°åç»­æ— æ³•å®Œæˆ</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">enum</span> <span class="token class-name">CS193pError</span><span class="token punctuation">:</span> <span class="token class-name">Error</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> <span class="token class-name">LateHomework</span><span class="token punctuation">(</span>daysLate<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> missedLecture
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<span id="more"></span>

<p>ä½¿ç”¨tryè°ƒç”¨èƒ½æŠ›å‡ºé”™è¯¯çš„å‡½æ•°ï¼Œ<code>try head(from: url)</code></p>
<h4 id="ä¸å¤„ç†æŠ›å‡ºé”™è¯¯"><a href="#ä¸å¤„ç†æŠ›å‡ºé”™è¯¯" class="headerlink" title="ä¸å¤„ç†æŠ›å‡ºé”™è¯¯"></a>ä¸å¤„ç†æŠ›å‡ºé”™è¯¯</h4><ul>
<li><p>try? å¿½ç•¥å‘ç”Ÿçš„ä»»ä½•é”™è¯¯ï¼Œå¦‚æœæŠ›å‡ºé”™è¯¯åªä¼šè¿”å›nil</p>
</li>
<li><p>try! å¦‚æœé‡åˆ°é”™è¯¯ï¼Œä½¿ç¨‹åºå´©æºƒ</p>
</li>
<li><p>try ä»…é€‚ç”¨äºæœ¬èº«æŠ›å‡ºçš„å‡½æ•°ï¼Œå¦‚æœé”™è¯¯è¢«æŠ›å‡ºä¼šé‡æ–°æ‰”ç»™è°ƒç”¨fooçš„äºº</p>
  <pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">func</span> <span class="token function-definition function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">try</span> <span class="token function">somethingThatThrows</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h4 id="å¤„ç†æŠ›å‡ºé”™è¯¯"><a href="#å¤„ç†æŠ›å‡ºé”™è¯¯" class="headerlink" title="å¤„ç†æŠ›å‡ºé”™è¯¯"></a>å¤„ç†æŠ›å‡ºé”™è¯¯</h4><p>ä½¿ç”¨doå’ŒcatchåŒ…è£¹try</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">do</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">try</span> <span class="token function">functionThatThrows</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//å¯èƒ½ä¼šå‘ç”Ÿé”™è¯¯çš„å†…å®¹</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"hello"</span></span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token keyword">let</span> error <span class="token punctuation">&#123;</span>
    <span class="token comment">//æ•è·å’Œå¤„ç†é”™è¯¯</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token class-name">CS193pError</span><span class="token punctuation">.</span><span class="token function">lateHomeWork</span><span class="token punctuation">(</span><span class="token keyword">let</span> daysLate<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token comment">//æ•è·ç›¸å…³é”™è¯¯ï¼Œè·å–daysLateçš„å€¼</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token keyword">let</span> cs193pError <span class="token keyword">where</span> cs193pError <span class="token keyword">is</span> <span class="token class-name">CS193pError</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//æ•è·æ‰€æœ‰CS193pé”™è¯¯</span>
<span class="token punctuation">&#125;</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"keep going"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Persistence"><a href="#Persistence" class="headerlink" title="Persistence"></a>Persistence</h3><p>å¾ˆå¤šç§æ–¹å¼å»æ°¸ä¹…çš„ä¿å­˜æ–‡ä»¶</p>
<ul>
<li>iOSæœ‰ä¸€ä¸ªUnixæ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥ä½¿ç”¨FileManageråœ¨ç³»ç»Ÿä¸­å­˜å–æ–‡ä»¶</li>
<li>å¯ä»¥å­˜å‚¨åœ¨SQLæ•°æ®åº“ä¸­ï¼Œæœ‰ä¸€ä¸ªå®Œæ•´æ¡†æ¶ CoreData</li>
<li>iCloud ä½¿ç”¨CloudKitå°†æ–‡ä»¶å­˜å…¥iCloud</li>
<li>UserDefaults è½»é‡çº§ï¼Œå­˜å‚¨ç”¨æˆ·åå¥½ï¼ˆè°ƒè‰²æ¿ï¼‰</li>
</ul>
<h4 id="æ–‡ä»¶ç³»ç»Ÿ"><a href="#æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿ"></a>æ–‡ä»¶ç³»ç»Ÿ</h4><p>å’Œè®¿é—®Unixæ–‡ä»¶ç³»ç»Ÿä¸€æ ·ï¼Œä»¥&#x2F;å¼€å¤´ã€‚ä½†æ˜¯ä¸èƒ½è®¿é—®å¤§éƒ¨åˆ†å†…å®¹ï¼Œåªèƒ½è¯»å†™è®¿é—®è‡ªå·±ç¨‹åºæ²™ç›’ä¸­ç›®å½•ï¼ˆsandboxï¼‰æ²™ç›’ï¼Œæ›´åŠ å®‰å…¨ã€‚åœ¨åˆ é™¤åº”ç”¨æ—¶ï¼Œä¼šå°†æ²™ç›’å†…å®¹ä¸€èµ·åˆ é™¤ï¼Œä¸ä¼šæœ‰æ®‹ç•™ã€‚</p>
<p>æ²™ç›’ä¸­ç›®å½•ï¼šApplicationå­˜æ”¾å¯æ‰§è¡Œæ–‡ä»¶ã€å›¾ç‰‡ç­‰ï¼Œæ˜¯ä¸ªåªè¯»ç›®å½•ï¼›Documentå­˜å‚¨ç”¨æˆ·ä¿å­˜çš„æ–‡ä»¶å†…å®¹ ï¼›Application Supportéœ€è¦å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä½†ç”¨æˆ·ä¸è§†ä¸ºæ–‡ä»¶eg.è°ƒè‰²ç›˜ï¼›Caches ä¸ä¼šå¤‡ä»½</p>
<h5 id="å¦‚ä½•è®¿é—®æ²™ç›’ç›®å½•"><a href="#å¦‚ä½•è®¿é—®æ²™ç›’ç›®å½•" class="headerlink" title="å¦‚ä½•è®¿é—®æ²™ç›’ç›®å½•"></a>å¦‚ä½•è®¿é—®æ²™ç›’ç›®å½•</h5><p>ä½¿ç”¨FileManagerçš„URLæ¥è®¿é—®æ²™ç›’ä¸­çš„æ–‡ä»¶ï¼Œé€šå¸¸ä½¿ç”¨å…±äº«çš„çš„FileManager.defaultï¼Œå› ä¸ºæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥é€‚åˆåœ¨ä¸»é˜Ÿåˆ—ä¸­è®¿é—®æ²™ç›’</p>
<p>è·å–ç‰¹å®šç›®å½•çš„url</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">let</span> manager <span class="token operator">=</span> <span class="token class-name">FileManager</span><span class="token punctuation">.</span><span class="token keyword">default</span>
<span class="token keyword">let</span> url <span class="token operator">=</span> manager<span class="token punctuation">.</span><span class="token function">urls</span><span class="token punctuation">(</span><span class="token keyword">for</span><span class="token punctuation">:</span> <span class="token punctuation">.</span>documentDirectory<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> userDomainMask<span class="token punctuation">)</span><span class="token punctuation">.</span>first <span class="token comment">//è¿”å›å¤æ•°ï¼Œåªé€‰æ‹©ç¬¬ä¸€ä¸ª</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>è®¿é—®æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œæ€»æ˜¯å¼€å§‹äºä¸€ä¸ªç‰¹å®šç›®å½•çš„url</p>
<p>urlçš„å‡½æ•°ï¼Œæ·»åŠ å†…å®¹åˆ°æŒ‡å®šurl</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">func</span> <span class="token function-definition function">appendingPathComponent</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token constant">URL</span> <span class="token comment">//æ·»åŠ ç»„ä»¶ï¼ˆæ–‡ä»¶ï¼‰åˆ°self è¿”å›url</span>
<span class="token keyword">func</span> <span class="token function-definition function">appendingPathExtension</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token constant">URL</span> <span class="token comment">//æ·»åŠ æ‰©å±• .jpg</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æŸ¥æ‰¾ç‰¹å®šurlä¸­å†…å®¹</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">var</span> isFileURL<span class="token punctuation">:</span> <span class="token class-name">Bool</span> <span class="token comment">//æŒ‡å‘æ–‡ä»¶</span>
<span class="token keyword">func</span> <span class="token function-definition function">resourceValues</span><span class="token punctuation">(</span><span class="token keyword">for</span> key<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">URLResourceKey</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-></span> <span class="token punctuation">[</span><span class="token class-name">URLResourceKey</span><span class="token punctuation">:</span><span class="token keyword">Any</span><span class="token punctuation">]</span><span class="token operator">?</span>
<span class="token comment">//.creationDataKey .isDirectoryKey .fileSizeKey</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¯ä»¥æŸ¥æ‰¾æ–‡ä»¶åˆ›å»ºæ—¶é—´ã€å¤§å°ç­‰ä¿¡æ¯</p>
<h5 id="Data"><a href="#Data" class="headerlink" title="Data"></a>Data</h5><p>é€šè¿‡Dataå‘æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶å†™å…¥å®é™…å†…å®¹ï¼Œæ˜¯æ•°æ®ç»“æ„ï¼Œä»¥byteçš„æ–¹å¼å°†æ•°æ®è¯»å–å†™å…¥ã€‚</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">Data</span> <span class="token keyword">init</span><span class="token punctuation">(</span>contentsOf<span class="token punctuation">:</span> <span class="token constant">URL</span><span class="token punctuation">,</span> options<span class="token punctuation">:</span> <span class="token class-name">Data</span><span class="token punctuation">.</span><span class="token class-name">ReadingOptions</span><span class="token punctuation">)</span> <span class="token keyword">throws</span>
<span class="token comment">//æ ¹æ®urlæ¥è·å–æ•°æ®äºŒè¿›åˆ¶æ•°æ®</span>
<span class="token keyword">func</span> <span class="token function-definition function">write</span><span class="token punctuation">(</span>to url<span class="token punctuation">:</span> <span class="token constant">URL</span><span class="token punctuation">,</span> options<span class="token punctuation">:</span> <span class="token class-name">Data</span><span class="token punctuation">.</span><span class="token class-name">WritingOptions</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-></span> <span class="token class-name">Bool</span>
<span class="token comment">//options .atomic .withoutOverwriting</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="å­˜æ¡£-Archiving"><a href="#å­˜æ¡£-Archiving" class="headerlink" title="å­˜æ¡£ Archiving"></a>å­˜æ¡£ Archiving</h4><h5 id="Codableåè®®"><a href="#Codableåè®®" class="headerlink" title="Codableåè®®"></a>Codableåè®®</h5><p>ç¬¦åˆCodableåè®®ï¼Œå¯ä»¥å˜æˆä¸€å›¢æ”¾å…¥æ–‡ä»¶ç³»ç»Ÿã€‚ä»»ä½•ç»“æ„å˜é‡æœ¬èº«éƒ½å¯ä»¥ç¼–ç ï¼ŒSwiftå¯ä»¥è‡ªåŠ¨å®ç°ï¼Œä½†æ˜¯æšä¸¾æœ‰å…³è”å€¼çš„ä¸èƒ½è‡ªåŠ¨ç¼–ç <strong>ï¼ˆSwift5.5å¥½åƒå¯ä»¥äº†ï¼‰</strong>ï¼Œéœ€è¦æ‰‹åŠ¨å®ç°ã€‚</p>
<p>æ ‡è®°äº†åè®®åï¼Œå°†æ•°æ®è½¬æ¢æˆblobçš„æ–¹æ³•æœ€å¸¸ç”¨çš„å°±æ˜¯å°†å…¶ç¼–ç æˆæŸç§æ–‡ä»¶æ ¼å¼(JSON)ã€‚äº’è”ç½‘ä¸Šçš„APIè·å–å¤§é‡ä½¿ç”¨æ•°æ®éƒ½æ˜¯JSONæ ¼å¼ã€‚</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">let</span> object<span class="token punctuation">:</span> <span class="token class-name">MyType</span> <span class="token operator">=</span> <span class="token operator">...</span> <span class="token comment">//MyTypeè¦å¯ç¼–ç </span>
<span class="token keyword">let</span> jsonData<span class="token punctuation">:</span> <span class="token class-name">Data</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">?</span> <span class="token class-name">JSONEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>
<span class="token comment">//ä¸€ä¸ªä½¿ç”¨JSONè¡¨ç¤ºçš„Dataå®ä¾‹ä½œä¸ºblob</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ç¼–ç æœ‰æŠ›å‡ºï¼Œä½ èƒ½é€šè¿‡catchæ–¹ä¾¿çš„æ‰¾åˆ°é”™è¯¯ã€‚</p>
<p>JSONæ˜¯ä¸€ä¸ªæ–‡æœ¬æ ¼å¼ï¼Œå¯ä»¥æŸ¥çœ‹å†…å®¹ï¼ŒæŠŠjsonDataä½œä¸ºå†…å®¹è¿”å›å¹¶é€šè¿‡stringè½¬æ¢æˆå­—ç¬¦ä¸²</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">let</span> jsonData <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> jsonData<span class="token operator">!</span><span class="token punctuation">,</span> encoding<span class="token punctuation">:</span> <span class="token punctuation">.</span>utf8<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ä¹Ÿå¯ä»¥å†™å…¥jsonDataåˆ°æ–‡ä»¶å’Œå°†JSONè§£ç æˆæ•°æ®ç±»å‹</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">try</span> jsonData<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>to<span class="token punctuation">:</span> url<span class="token punctuation">)</span> <span class="token comment">//throws</span>
<span class="token keyword">if</span> <span class="token keyword">let</span> myObject<span class="token punctuation">:</span> <span class="token class-name">MyType</span> <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">?</span> <span class="token class-name">JSONDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token class-name">MyType</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">,</span> from<span class="token punctuation">:</span> jsonData<span class="token operator">!</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å…³äºè§£ç çš„é”™è¯¯å¤„ç†</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">do</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> object <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token class-name">JSONDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token class-name">MyType</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">,</span> from<span class="token punctuation">:</span> jsonData<span class="token operator">!</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token class-name">DecodingError</span><span class="token punctuation">.</span><span class="token function">keyNotFound</span><span class="token punctuation">(</span><span class="token keyword">let</span> key<span class="token punctuation">,</span> <span class="token keyword">let</span> context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"couldn't find key </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">key</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string"> in JSON: </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">context<span class="token punctuation">.</span>debugDescription</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token class-name">DecodingError</span><span class="token punctuation">.</span><span class="token function">valueNotFound</span><span class="token punctuation">(</span><span class="token keyword">let</span> type<span class="token punctuation">,</span> <span class="token keyword">let</span> context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    
<span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token class-name">DecodingError</span><span class="token punctuation">.</span><span class="token function">typeMismatch</span><span class="token punctuation">(</span><span class="token keyword">let</span> type<span class="token punctuation">,</span> <span class="token keyword">let</span> context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    
<span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token class-name">DecodingError</span><span class="token punctuation">.</span><span class="token function">dataCorrupted</span><span class="token punctuation">(</span><span class="token keyword">let</span> context<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h5><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">struct</span> <span class="token class-name">MyType</span><span class="token punctuation">:</span> <span class="token class-name">Codable</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> someData<span class="token punctuation">:</span> <span class="token class-name">Date</span>
    <span class="token keyword">var</span> someString<span class="token punctuation">:</span> <span class="token class-name">String</span>
    <span class="token keyword">var</span> other<span class="token punctuation">:</span> <span class="token class-name">SomeOtherType</span>
    <span class="token comment">//ä¿®æ”¹JSONçš„å†’å·å·¦é¢çš„å†…å®¹ï¼Œåœ¨JSONä¸­keyä½¿ç”¨çš„éƒ½æ˜¯å°å†™å­—æ¯ï¼Œå•è¯é—´ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†å‰²</span>
    <span class="token keyword">private</span> <span class="token keyword">enum</span> <span class="token class-name">CodingKeys</span><span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">CodingKey</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">case</span> someData <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"some_date"</span></span>
        <span class="token keyword">case</span> other
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">init</span><span class="token punctuation">(</span>from decoder<span class="token punctuation">:</span> <span class="token class-name">Decoder</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token punctuation">&#123;</span> <span class="token comment">//è§£ç </span>
        <span class="token keyword">let</span> container <span class="token operator">=</span> <span class="token keyword">try</span> decoder<span class="token punctuation">.</span><span class="token function">container</span><span class="token punctuation">(</span>keyedBy<span class="token punctuation">:</span> <span class="token class-name">CodingKeys</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span>
        <span class="token comment">//æŠ“ä½å®¹å™¨</span>
        someDate <span class="token operator">=</span> <span class="token keyword">try</span> container<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token punctuation">.</span>someDate<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//ç¼–ç </span>
    <span class="token keyword">func</span> <span class="token function-definition function">encode</span><span class="token punctuation">(</span>to encoder<span class="token punctuation">:</span> <span class="token class-name">Encoder</span><span class="token punctuation">)</span> <span class="token keyword">throws</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> container <span class="token operator">=</span> encoder<span class="token punctuation">.</span><span class="token function">container</span><span class="token punctuation">(</span>keyedBy<span class="token punctuation">:</span> <span class="token class-name">CodingKeys</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span> container<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>someDate<span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token punctuation">.</span>someDate<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="UserDefaults"><a href="#UserDefaults" class="headerlink" title="UserDefaults"></a>UserDefaults</h4><p>ç”¨æˆ·é»˜è®¤å€¼ æ˜¯ä¸ªå¼ºå¤§çš„ç³»ç»Ÿï¼Œæœ‰çš„æ—¶å€™ä¼šå’Œæ–‡ä»¶ç³»ç»Ÿç»“åˆèµ·æ¥ã€‚å¯¹äºè½»é‡çº§æ•°æ®ã€ç”¨æˆ·åå¥½å†…å®¹çš„å­˜å‚¨ã€‚</p>
<h5 id="Property-List"><a href="#Property-List" class="headerlink" title="Property List"></a>Property List</h5><p>UserDefaultsåªèƒ½åœ¨å±æ€§åˆ—è¡¨(Property List)ä¸­å­˜å‚¨å†…å®¹ï¼Œåˆ—è¡¨å±æ€§ä¸æ˜¯åè®®æˆ–è€…ç»“æ„ä½“ç­‰ï¼Œæ˜¯ä¸ªæ¦‚å¿µï¼Œåªèƒ½ç”±å­—ç¬¦ä¸²ã€æ­£æ•°ã€å¸ƒå°”å€¼ã€æµ®ç‚¹æ•°ã€æ—¥æœŸã€æ•°æ®ã€æ•°ç»„æˆ–è€…å­—å…¸ç»„æˆã€‚å¦‚æœè¿˜æœ‰åˆ«çš„ç±»å‹çš„å†…å®¹ï¼Œå°±ä¸å†è§†ä¸ºå±æ€§åˆ—è¡¨ï¼Œä¸èƒ½æ”¾è¿›UserDefaultsä¸­ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥æŠŠä»»ä½•å¯ç¼–ç çš„å†…å®¹æ”¾è¿›Dataã€‚</p>
<h5 id="Any"><a href="#Any" class="headerlink" title="Any"></a>Any</h5><p>Anyæ˜¯æ— ç±»å‹ã€‚Swiftæ˜¯ä¸€ä¸ªå¼ºç±»å‹è¯­è¨€ï¼Œè¿™ä¸ªå¾ˆåSwiftï¼Œä½†æ˜¯æˆ‘ä»¬ä¼šå°½é‡å¿½ç•¥Anyã€‚</p>
<h5 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h5><p>ä½¿ç”¨æ—¶ï¼Œé¦–å…ˆéœ€è¦ä¸€ä¸ªUserDefaultsçš„å®ä¾‹</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">let</span> defaults <span class="token operator">=</span> <span class="token class-name">UserDefaults</span><span class="token punctuation">.</span>standard
<span class="token comment">//å­˜å‚¨å†…å®¹</span>
defaults<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> forKeys<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"SomeKey"</span></span><span class="token punctuation">)</span> <span class="token comment">//objectå¿…é¡»æ˜¯Property List</span>
<span class="token function">setDouble</span><span class="token punctuation">(</span><span class="token number">31.1</span><span class="token punctuation">,</span> forKeys<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">""</span></span><span class="token punctuation">)</span> <span class="token comment">// å¯ä»¥ä¿è¯å­˜å‚¨çš„æ˜¯double</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è·å–æ•°æ®</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">let</span> i<span class="token punctuation">:</span> <span class="token class-name">Int</span> <span class="token operator">=</span> defaults<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span>forKeys<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"MyInteger"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å¦‚æœè¿”å›çš„ç±»å‹æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå°†ä¼šè¿”å›<code>Array&lt;Any&gt;</code>ï¼Œå› ä¸ºSwiftä¸èƒ½ç›´æ¥å¯¹Anyå¤„ç†ï¼Œæ‰€ä»¥è¦æŠŠArrayä½¿ç”¨asè½¬æ¢æˆèƒ½å¤„ç†çš„å†…å®¹ã€‚</p>
<h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><h4 id="ä½¿æ–‡æ¡£æŒä¹…åŒ–"><a href="#ä½¿æ–‡æ¡£æŒä¹…åŒ–" class="headerlink" title="ä½¿æ–‡æ¡£æŒä¹…åŒ–"></a>ä½¿æ–‡æ¡£æŒä¹…åŒ–</h4><p>ä¸€èˆ¬ä¸åœ¨Viewä¸­åšæŒä¹…åŒ–ï¼Œå¤§å¤šæ•°åœ¨ViewModelä¸­è¿›è¡ŒæŒä¹…åŒ–ã€‚ä¹Ÿæœ‰å¯èƒ½åœ¨Modelä¸­ï¼Œç”šè‡³åšä¸€ä¸ªæŒä¹…åŒ–å¼•æ“ç±»ä¼¼SQLæ•°æ®åº“ç­‰ã€‚</p>
<p>åœ¨viewmodelä¸­æ·»åŠ saveå‡½æ•°ï¼Œå‡½æ•°ä¸­å…ˆå¾—åˆ°ä¸€äº›æ•°æ®ï¼Œç„¶åè·å–æ•°æ®å¹¶å†™å…¥åˆ°urlä¸­ã€‚éœ€è¦çŸ¥é“å°†åœ¨Dataä¸­å†…å®¹çš„ç±»å‹ï¼Œä»¥JSONçš„æ ¼å¼æ•°æ®åŒ–ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠEmojiArtModelè½¬æ¢æˆJSONè¡¨ç¤ºï¼Œå¹¶ä»¥æŸç§æ–¹å¼æ”¾è¿›dataä¸­ï¼Œç„¶åå†™åˆ°urlã€‚</p>
<p>åœ¨Modelä¸­æ·»åŠ å°†è‡ªå·±è½¬æ¢æˆJSONçš„å‡½æ•°</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"> <span class="token comment">//ä¿å­˜æ–‡ä»¶,urlä¸ºæ–‡ä»¶url,åœ¨æœ¬åœ°ç³»ç»Ÿä¸­çš„æŸä¸ªä½ç½®</span>
<span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">save</span><span class="token punctuation">(</span>to url<span class="token punctuation">:</span> <span class="token constant">URL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">let</span> thisfunction <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation"><span class="token class-name">String</span><span class="token punctuation">(</span>describing<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">)</span></span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">.</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation"><span class="token literal constant">#function</span></span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span> <span class="token comment">// EmojiArtDocument.save(to:)</span>
    <span class="token keyword">do</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">let</span> data<span class="token punctuation">:</span> <span class="token class-name">Data</span> <span class="token operator">=</span> <span class="token keyword">try</span> emojiArt<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">thisfunction</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string"> json = </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation"><span class="token class-name">String</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> data<span class="token punctuation">,</span> encoding<span class="token punctuation">:</span> <span class="token punctuation">.</span>utf8<span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string-literal"><span class="token string">"nil"</span></span></span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span> <span class="token comment">//å¦‚æœæ˜¯å›¾è±¡ç­‰ ä¸ºnil</span>
        <span class="token keyword">try</span> data<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>to<span class="token punctuation">:</span> url<span class="token punctuation">)</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">thisfunction</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string"> success!"</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token keyword">let</span> encodingError <span class="token keyword">where</span> encodingError <span class="token keyword">is</span> <span class="token class-name">EncodingError</span> <span class="token punctuation">&#123;</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">thisfunction</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string"> coundn't encode EmojiArt as JSON because </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">encodingError<span class="token punctuation">.</span>localizedDescription</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span> <span class="token comment">//æœ¬åœ°åŒ–å½“åœ°è¯­è¨€</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">&#123;</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">thisfunction</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string"> error = </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">error</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="å®ç°è‡ªåŠ¨ä¿å­˜æ–‡ä»¶"><a href="#å®ç°è‡ªåŠ¨ä¿å­˜æ–‡ä»¶" class="headerlink" title="å®ç°è‡ªåŠ¨ä¿å­˜æ–‡ä»¶"></a>å®ç°è‡ªåŠ¨ä¿å­˜æ–‡ä»¶</h6><p>è·å–æ–‡ä»¶ç›®å½•æ—¶ï¼Œåœ¨iOSä¸­inå‚æ•°çš„å†…å®¹æ°¸è¿œæ˜¯.userDomainMask</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">private</span> <span class="token keyword">struct</span>  <span class="token class-name">Autosave</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">static</span> <span class="token keyword">let</span> filename <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"Autosaved.emojiart"</span></span> <span class="token comment">//åæœŸåšæˆæ‰©å±•å,ç°åœ¨åªæ˜¯æ–‡ä»¶å</span>
    <span class="token keyword">static</span> <span class="token keyword">var</span> url<span class="token punctuation">:</span> <span class="token constant">URL</span><span class="token operator">?</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//åœ¨iOSä¸­ å§‹ç»ˆæ˜¯.userDomainMask</span>
        <span class="token keyword">let</span> documentDirectory <span class="token operator">=</span> <span class="token class-name">FileManager</span><span class="token punctuation">.</span><span class="token keyword">default</span><span class="token punctuation">.</span><span class="token function">urls</span><span class="token punctuation">(</span><span class="token keyword">for</span><span class="token punctuation">:</span> <span class="token punctuation">.</span>documentDirectory<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token punctuation">.</span>userDomainMask<span class="token punctuation">)</span><span class="token punctuation">.</span>first 
        <span class="token comment">//åœ¨å¾—åˆ°çš„urlä¸­æ·»åŠ ç»„ä»¶</span>
        <span class="token keyword">return</span> documentDirectory<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">appendingPathComponent</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> 
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">autosave</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token class-name">Autosave</span><span class="token punctuation">.</span>url <span class="token punctuation">&#123;</span>
        <span class="token function">save</span><span class="token punctuation">(</span>to<span class="token punctuation">:</span> url<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è‡ªåŠ¨ä¿å­˜çš„é¢‘ç‡å¤ªè¿‡é¢‘ç¹ï¼Œä¼˜åŒ–è‡ªåŠ¨ä¿å­˜å‡½æ•°ï¼Œæ”¹ä¸ºä¸æ“ä½œä¸€æ®µæ—¶é—´åè‡ªåŠ¨ä¿å­˜</p>
<p>ä½¿ç”¨selfï¼Œå¦‚æœå®‰æ’ä¿å­˜æ—¶ä¸å°å¿ƒå…³é—­ç•Œé¢ï¼Œåœ¨å†…å­˜ä¸­ä¿ç•™selfï¼Œç›´åˆ°æœ‰æœºä¼šè‡ªåŠ¨ä¿å­˜</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">scheduleAutosave</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    autosaveTimer<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//å–æ¶ˆå‰ä¸€ä¸ªTimer</span>
	autosaveTimer <span class="token operator">=</span> <span class="token class-name">Timer</span><span class="token punctuation">.</span><span class="token function">scheduledTimer</span><span class="token punctuation">(</span>withTimeInterval<span class="token punctuation">:</span> <span class="token class-name">Autosave</span><span class="token punctuation">.</span>coalescingInterval<span class="token punctuation">,</span> repeats<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> timer <span class="token keyword">in</span>
		<span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">autosave</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>self</p>
<blockquote>
<p>å¸¦æœ‰å…³è”å€¼çš„æšä¸¾å†…ï¼Œè‡ªå®šä¹‰ç¼–ç  Swift5.5èƒ½è‡ªåŠ¨ç¼–ç äº†ï¼Œä¸éœ€è¦æ‰‹åŠ¨è¿›è¡Œï¼Œä½†æ˜¯æŠŠä»£ç æ‘†ä¸Šå§</p>
</blockquote>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token comment">//è‡ªå®šä¹‰ç¼–ç ...</span>
<span class="token keyword">init</span><span class="token punctuation">(</span>from decoder<span class="token punctuation">:</span> <span class="token class-name">Decoder</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> container <span class="token operator">=</span> <span class="token keyword">try</span> decoder<span class="token punctuation">.</span><span class="token function">container</span><span class="token punctuation">(</span>keyedBy<span class="token punctuation">:</span> <span class="token class-name">CodingKeys</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">?</span> container<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token punctuation">.</span>url<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">self</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token keyword">let</span> imageData <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">?</span> container<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token class-name">Data</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token punctuation">.</span>imageData<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">self</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token function">imageData</span><span class="token punctuation">(</span>imageData<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">self</span> <span class="token operator">=</span> <span class="token punctuation">.</span>blank
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">func</span> <span class="token function-definition function">encode</span><span class="token punctuation">(</span>to encoder<span class="token punctuation">:</span> <span class="token class-name">Encoder</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> container <span class="token operator">=</span> encoder<span class="token punctuation">.</span><span class="token function">container</span><span class="token punctuation">(</span>keyedBy<span class="token punctuation">:</span> <span class="token class-name">CodingKeys</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span>
    <span class="token keyword">switch</span> <span class="token keyword">self</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token keyword">let</span> url<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">try</span> container<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token punctuation">.</span>url<span class="token punctuation">)</span>
        <span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">imageData</span><span class="token punctuation">(</span><span class="token keyword">let</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">try</span> container<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token punctuation">.</span>imageData<span class="token punctuation">)</span>
        <span class="token keyword">case</span> <span class="token punctuation">.</span>blank<span class="token punctuation">:</span> <span class="token keyword">break</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">enum</span> <span class="token class-name">CodingKeys</span><span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">CodingKey</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> url <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"theURL"</span></span>
    <span class="token keyword">case</span> imageData
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="åŠ è½½è‡ªåŠ¨ä¿å­˜çš„æ–‡ä»¶"><a href="#åŠ è½½è‡ªåŠ¨ä¿å­˜çš„æ–‡ä»¶" class="headerlink" title="åŠ è½½è‡ªåŠ¨ä¿å­˜çš„æ–‡ä»¶"></a>åŠ è½½è‡ªåŠ¨ä¿å­˜çš„æ–‡ä»¶</h6><p>å¯¹modelè¿›è¡Œåˆå§‹åŒ–</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">init</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token constant">URL</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token class-name">Data</span><span class="token punctuation">(</span>contentsOf<span class="token punctuation">:</span> url<span class="token punctuation">)</span> <span class="token comment">//åˆå§‹åŒ–Data,é€šè¿‡æ–‡ä»¶åœ°å€è·å–æ–‡ä»¶å†…Data</span>
    <span class="token keyword">self</span> <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token class-name">EmojiArtModel</span><span class="token punctuation">(</span>json<span class="token punctuation">:</span> data<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">init</span><span class="token punctuation">(</span>json<span class="token punctuation">:</span> <span class="token class-name">Data</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">self</span> <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token class-name">JSONDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token class-name">EmojiArtModel</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">,</span> from<span class="token punctuation">:</span> json<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨viewmodelä¸­ï¼Œè¿›è¡Œåˆå§‹åŒ–</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token class-name">Autosave</span><span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token keyword">let</span> autosavedEmojiArt <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">?</span> <span class="token class-name">EmojiArtModel</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> url<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        emojiArt <span class="token operator">=</span> autosavedEmojiArt
        <span class="token function">fetchBackgroundImageDataIfNecessary</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        emojiArt <span class="token operator">=</span> <span class="token class-name">EmojiArtModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="è°ƒè‰²æ¿çš„ç‹¬ç«‹MVVM"><a href="#è°ƒè‰²æ¿çš„ç‹¬ç«‹MVVM" class="headerlink" title="è°ƒè‰²æ¿çš„ç‹¬ç«‹MVVM"></a>è°ƒè‰²æ¿çš„ç‹¬ç«‹MVVM</h4><p>åˆ›å»ºè°ƒè‰²æ¿ViewModel</p>
<p>é‡æ–°åŠ è½½è°ƒè‰²æ¿ï¼Œè½¬åŒ–æˆå­—ç¬¦ä¸²æ•°ç»„ä½¿ç”¨UserDefaults</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token comment">//ä½¿ç”¨UserDefaultå­˜å‚¨è°ƒè‰²æ¿å†…å®¹</span>
<span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">storeInUserDefaults</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">UserDefaults</span><span class="token punctuation">.</span>standard<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>palettes<span class="token punctuation">.</span>map <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span><span class="token short-argument">$0</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>emojis<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token short-argument">$0</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> userDefaultsKey<span class="token punctuation">)</span> <span class="token comment">// å¿…é¡»æ˜¯å±æ€§åˆ—è¡¨å†…å®¹</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">restoreFromUserDefaults</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> palettesAsPropertyList <span class="token operator">=</span> <span class="token class-name">UserDefaults</span><span class="token punctuation">.</span>standard<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span>forKey<span class="token punctuation">:</span> userDefaultsKey<span class="token punctuation">)</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">&#123;</span> <span class="token comment">//å˜æˆå­—ç¬¦ä¸²æ•°ç»„,å¦‚æœä¸è¡Œåˆ™ä¸ºç©º</span>
        <span class="token keyword">for</span> paletteAsArray <span class="token keyword">in</span> palettesAsPropertyList <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> paletteAsArray<span class="token punctuation">.</span>count <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token class-name">Int</span><span class="token punctuation">(</span>paletteAsArray<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">!</span>palettes<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token keyword">where</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>id <span class="token operator">==</span> id<span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">let</span> palette <span class="token operator">=</span> <span class="token class-name">Palette</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> paletteAsArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> emojis<span class="token punctuation">:</span> paletteAsArray<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> id<span class="token punctuation">:</span> id<span class="token punctuation">)</span>
                palettes<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>palette<span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯å¤ªéº»çƒ¦äº†ï¼Œæ‰€ä»¥ä½¿ç”¨æ•°æ®è¿›è¡Œå­˜å‚¨æ›´æ–¹ä¾¿</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">UserDefaults</span><span class="token punctuation">.</span>standard<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token keyword">try</span><span class="token operator">?</span> <span class="token class-name">JSONEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>palettes<span class="token punctuation">)</span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> userDefaultsKey<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">if</span> <span class="token keyword">let</span> jsonData <span class="token operator">=</span> <span class="token class-name">UserDefaults</span><span class="token punctuation">.</span>standard<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span>forKey<span class="token punctuation">:</span> userDefaultsKey<span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token keyword">let</span> decodedPalettes <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">?</span> <span class="token class-name">JSONDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token class-name">Palette</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">,</span> from<span class="token punctuation">:</span> jsonData<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	palettes <span class="token operator">=</span> decodedPalettes
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

]]></content>
      <tags>
        <tag>swift</tag>
        <tag>cs193p</tag>
      </tags>
  </entry>
  <entry>
    <title>cs193p_note12_Bindings Sheet Navigation EditMode</title>
    <url>/2022/06/05/cs193p-note12/</url>
    <content><![CDATA[<h3 id="Property-Wrappers"><a href="#Property-Wrappers" class="headerlink" title="Property Wrappers"></a>Property Wrappers</h3><p>å±æ€§åŒ…è£…å™¨ï¼Œå«æœ‰@somethingçš„è¯­å¥ã€‚å±æ€§åŒ…è£…å™¨åªæ˜¯ä¸€ä¸ªç»“æ„ï¼Œç»“æ„ä¸­å°è£…äº†åº”ç”¨äºå˜é‡çš„æŸç§æ¨¡æ¿è¡Œä¸ºã€‚ä¾‹å¦‚@Stateã€@Publishedã€@ObservedObjectç­‰</p>
<h4 id="Published"><a href="#Published" class="headerlink" title="Published"></a>Published</h4><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token attribute atrule">@Published</span> <span class="token keyword">var</span> emojiArt<span class="token punctuation">:</span> <span class="token class-name">EmojiArt</span> <span class="token operator">=</span> <span class="token class-name">EmojiArt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//å…·ä½“å®ç°</span>
<span class="token keyword">struct</span> <span class="token class-name">Published</span> <span class="token punctuation">&#123;</span><span class="token comment">//åˆ›å»ºä¸€ä¸ªç»“æ„ä½“</span>
    <span class="token keyword">var</span> wrappedValue<span class="token punctuation">:</span> <span class="token class-name">EmojiArt</span>
    <span class="token comment">//å‘ç”Ÿå˜åŒ–æ—¶ï¼Œåœ¨ä¿¡æ¯æµä¸­å‘å¸ƒå˜åŒ–</span>
    <span class="token keyword">var</span> projectedValue<span class="token punctuation">:</span> <span class="token class-name">Publisher</span><span class="token operator">&lt;</span><span class="token class-name">EmojiArt</span><span class="token punctuation">,</span> <span class="token class-name">Never</span><span class="token operator">></span> <span class="token comment">//å¯ä»¥è®¿é—®ä½¿ç”¨$emojiArtè·å–æŠ•å½±å€¼</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//è¿˜æä¾›äº†å…¶ä»–å˜é‡,ä»»ä½•@çš„å†…å®¹éƒ½å¯ä»¥åˆ¶ä½œä¸‹åˆ’çº¿å˜é‡</span>
<span class="token keyword">var</span> _emojiArt<span class="token punctuation">:</span> <span class="token class-name">Published</span> <span class="token operator">=</span> <span class="token class-name">Published</span><span class="token punctuation">(</span>wrappedValue<span class="token punctuation">:</span> <span class="token class-name">EmojiArt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//æ•°æ®ç±»å‹æ˜¯å·²å‘å¸ƒç±»å‹</span>
<span class="token comment">//åŒ…è£…ä¹‹åï¼Œå˜æˆè®¡ç®—å±æ€§</span>
<span class="token keyword">var</span> emojiArt<span class="token punctuation">:</span> <span class="token class-name">EmojiArt</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">get</span> <span class="token punctuation">&#123;</span> _emojiArt<span class="token punctuation">.</span>wrappedValue <span class="token punctuation">&#125;</span>
    <span class="token keyword">set</span> <span class="token punctuation">&#123;</span> _emojiArt<span class="token punctuation">.</span>wrappedValue <span class="token operator">=</span> newvalue <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<span id="more"></span>

<p>å½“wrappedValueå‘ç”Ÿå˜åŒ–æ—¶ï¼Œé€šè¿‡projectedValue($emojiArt)å‘å¸ƒæ›´æ”¹ã€‚æœ‰ä»£ç åœ¨å°é—­çš„ObservableObjectä¸­è°ƒç”¨<code>objectWillChange.send()</code></p>
<h4 id="State"><a href="#State" class="headerlink" title="@State"></a>@State</h4><p>wrappedValueç±»å‹æ˜¯ä»»ä½•å€¼ç±»å‹ã€‚åœ¨å †ä¸­å­˜å‚¨wrappedValueï¼Œå½“å€¼å‘ç”Ÿå˜åŒ–æ—¶ä½¿è§†å›¾æ— æ•ˆï¼Œé‡å»ºbodyã€‚éšç€è§†å›¾çš„åˆ›å»ºå’Œé”€æ¯ï¼Œåªè¦è§†å›¾ä¸»ä½“åœ¨å±å¹•ä¸Šï¼Œå€¼ä¿æŒä¸å˜ä¸€ç›´æŒ‡å‘å †ä¸­çš„åŒä¸€ä¸ªä¸œè¥¿ã€‚</p>
<p>projected value $ æ˜¯ä¸€ä¸ªBinding ç»‘å®šï¼Œè¿™ä¸ªå€¼åœ¨å †ä¸­çš„ç»‘å®šã€‚</p>
<p>å¦‚æœä½¿ç”¨<code>@State</code>å£°æ˜ï¼Œä½†å¹¶æ²¡æœ‰èµ‹å€¼ï¼Œæƒ³è¦åœ¨initä¸­åˆå§‹åŒ–ã€‚_æ˜¯Stateç»“æ„ï¼Œé€šè¿‡<code>.init</code>å®ç°ï¼Œä½¿å…¶æœ‰åˆå§‹å€¼ã€‚</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> foo<span class="token punctuation">:</span> <span class="token class-name">Int</span>
<span class="token keyword">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	_foo <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>initialValue<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="StateObject"><a href="#StateObject" class="headerlink" title="@StateObject"></a>@StateObject</h4><p>å’Œ@Stateå¾ˆç›¸ä¼¼ï¼Œå°†æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œä½†æ˜¯å®ƒç”¨ç”¨äºObservableObjectsï¼ˆViewModelï¼‰ã€‚è§†å›¾å’ŒéªŒè¯ç­‰è¡Œä¸ºç±»ä¼¼äº@ObservedObjectã€‚ç”¨åœ¨Appsã€Viewã€Scenesä¸­ã€‚</p>
<p>@StateObjectæ˜¯ä¸€ä¸ªæ•°æ®çš„çœŸå®çš„æ¥æºï¼Œå°±åƒstateå¯¹äºviewæœ¬åœ°çš„å€¼ä¸€æ ·ã€‚æ‰€æœ‰éœ€è¦å¸¦æœ‰åˆå§‹åŒ–å€¼çš„æ–¹å¼åˆ›å»º<code>@StateObject var foo = SomeObservableObject()</code>ã€‚@ObservedObjectä¸æ˜¯çœŸå®æ¥æºï¼Œæ˜¯å¯¹çœŸå®æ¥æºçš„å¼•ç”¨ï¼Œæ‰€ä»¥åé¢ä¸ä¼šè·Ÿä¸Šâ€œ&#x3D;â€ã€‚ObservedObjectå¯ä»¥å­˜åœ¨äºStateObjectä¸­ï¼Œå¯ä»¥æ‹¥æœ‰ä¸€ä¸ªViewModelæ•°ç»„ï¼Œviewmodelä¼šè¢«å›ºå®šåˆ°viewçš„å£°æ˜å‘¨æœŸã€‚</p>
<p>å¦‚æœæŠŠStateObjectæ”¾è¿›è§†å›¾ä¸­ï¼Œç”Ÿå‘½å‘¨æœŸå’Œå±å¹•ä¸Šè§†å›¾çš„ç”Ÿå‘½å‘¨æœŸä¸€è‡´ï¼Œä¸€æ—¦è§†å›¾ç¦»å¼€å±å¹•ViewModelä¼šè¢«ç ´åï¼Œæ‰€æœ‰çš„å­˜å‚¨éƒ½ä¼šæ¶ˆå¤±ã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªæ¥å—urlçš„viewmodelï¼Œå»æ‹¿å»å†…å®¹ï¼Œä¸€æ—¦ç¦»å¼€å±å¹•å°±é”€æ¯æ‹¿æ¥çš„å†…å®¹ã€‚</p>
<h4 id="StateObject-å’Œ-ObservedObject"><a href="#StateObject-å’Œ-ObservedObject" class="headerlink" title="@StateObject å’Œ @ObservedObject"></a>@StateObject å’Œ @ObservedObject</h4><p>wrappedValueæ˜¯å®ç°ObservableObjectåè®®çš„ä¸œè¥¿ï¼ŒåŸºæœ¬ä¸Šæ˜¯ViewModelã€‚å½“wrappedValueå‘ç”Ÿæ”¹å˜æ—¶ï¼Œä½¿è¯•å›¾å¤±æ•ˆã€‚ProjectValueçš„å€¼æ˜¯ä¸€ä¸ªå¯¹ViewModelä¸­å˜é‡çš„Bindingï¼Œè¿™ä¸ªæŠ•å½±å€¼å¯ä»¥æ˜¯ä»»ä½•å˜é‡çš„è¡¨è¾¾å¼ï¼Œç”šè‡³åšä¸‹æ ‡ <code>$myViewModel.data.stuff[3]</code>ã€‚</p>
<h4 id="Binding"><a href="#Binding" class="headerlink" title="@Binding"></a>@Binding</h4><p>wrappedValueæ˜¯ç»‘å®šåˆ°åˆ«çš„ä¸œè¥¿çš„å€¼ï¼Œå†…å®¹æ¥æºä¸»è¦æ˜¯@Stateã€@StateObjectã€@ObservedObjectã€‚å½“ç»‘å®šå†…å®¹æ”¹å˜æ—¶ï¼Œä½¿è§†å›¾æ— æ•ˆã€‚ProjectedValueæ˜¯ä¸€ä¸ªç»‘å®šåˆ°è‡ªå·±çš„Bindingï¼Œå¦‚æœç»‘å®šæŸç‰©å¹¶è°ƒç”¨æ¥å—å¦ä¸€ä¸ªç»‘å®šçš„å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ã€‚ä½œç”¨æ˜¯ä¸Šçº§è§†å›¾ä¼ é€’åˆ°å­è§†å›¾çš„æ•°æ®å¯ä¿®æ”¹ç‰ˆæœ¬ã€‚</p>
<p>ä»TextFieldä¸­è·å–æ–‡æœ¬ï¼Œä½¿ç”¨Toggleæˆ–å…¶ä»–çŠ¶æ€ä¿®æ”¹UIå…ƒç´ ï¼ŒæŸ¥æ‰¾NavigationViewä¸­å“ªä¸ªé¡¹ç›®è¢«é€‰ä¸­ï¼Œæ‰‹åŠ¿çŠ¶æ€ä¸­çš„ .updatingâ€¦â€¦</p>
<p>Bindingèƒ½è®©æˆ‘ä»¬æ‹¥æœ‰å•ä¸€çš„çœŸå®æ¥æºï¼Œæ‹¥æœ‰ä¸éœ€è¦å¤åˆ¶çŠ¶æ€ï¼Œæˆ–å°†å…¶å¤åˆ¶åˆ°Viewï¼Œèƒ½ä½¿ç”¨@Bindingåˆ°æ•°æ®çš„çœŸå®æ¥æºã€‚</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">struct</span> <span class="token class-name">MyView</span><span class="token punctuation">:</span> <span class="token class-name">View</span><span class="token punctuation">&#123;</span>
    <span class="token attribute atrule">@State</span> <span class="token keyword">var</span> myString <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"Hello"</span></span> <span class="token comment">//æ¥æº</span>
    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        <span class="token function">otherView</span><span class="token punctuation">(</span>sharedText<span class="token punctuation">:</span> $myString<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">struct</span> <span class="token class-name">OtherView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
    <span class="token attribute atrule">@Binding</span> <span class="token keyword">var</span> sharedText<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token comment">//ç»‘å®š </span>
    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Text</span><span class="token punctuation">(</span>sharedText<span class="token punctuation">)</span>
        <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Shared"</span></span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> $sharedText<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¸¸é‡ç»‘å®šï¼Œç»‘å®šä¸€ä¸ªå¸¸é‡æ¯æ¬¡è¯¢é—®æ—¶éƒ½ä¸ä¼šæ”¹å˜ã€‚é¢„è§ˆæ—¶å¸¸ç”¨<code>Binding.constant(value)</code>ã€‚<code>OtherView(sharedText: .constant(&quot;Howdy&quot;))</code>ã€‚è®¡ç®—ç»‘å®š<code>Binding(get:, set:)</code> </p>
<h4 id="EnvironmentObject"><a href="#EnvironmentObject" class="headerlink" title="@EnvironmentObject"></a>@EnvironmentObject</h4><p>å’Œ@ObservedObjectå®Œå…¨ç›¸åŒï¼Œæ˜¯ObservedObjectçš„å¼•ç”¨ï¼Œä»¥ä¸åŒçš„æ–¹å¼ä¼ é€’ç»™è§†å›¾ï¼Œä¸æ˜¯é€šè¿‡å‚æ•°ä¼ é€’ï¼Œé€šè¿‡è§†å›¾ä¿®æ”¹å™¨ä¼ é€’ã€‚å¦‚æœæˆ‘ä»¬çš„æ•´ä¸ªViewå±‚æ¬¡ç»“æ„ä¸­çš„æ‰€æœ‰è§†å›¾éƒ½éœ€è¦ä½¿ç”¨è¿™ä¸ªæ•°æ®ï¼Œå°±éœ€è¦é€šè¿‡EnvironmentObjectæ¥ä¼ é€’ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥çœç•¥åˆ°å„ç§è§†å›¾çš„å‚æ•°äº†(å·æ‡’ä¸“ç”¨ä»£ç )ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠEnvironmentObjectè®¤ä¸ºæ˜¯å°†æ•°æ®æ³¨å…¥åˆ°æ‰€æœ‰çš„è§†å›¾ä¸­å»ã€‚åªèƒ½æ‹¥æœ‰ä¸€ä¸ª@EnvironmentObjectã€‚</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">let</span> myView <span class="token operator">=</span> <span class="token class-name">MyView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">environmentObject</span><span class="token punctuation">(</span>theViewModel<span class="token punctuation">)</span> <span class="token comment">//ä¼ é€’æ•°æ®</span>
<span class="token attribute atrule">@EnvironmentObject</span> <span class="token keyword">var</span> viewModel<span class="token punctuation">:</span> <span class="token class-name">ViewModelClass</span> <span class="token comment">//æ¥å—æ•°æ®</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>wrappedValueæ˜¯ObservableObjectè·å¾—é€šè¿‡.environmentObject()è¢«æ³¨å…¥åˆ°è§†å›¾</p>
<h4 id="Environment"><a href="#Environment" class="headerlink" title="@Environment"></a>@Environment</h4><p>å’Œ@EnvironmentObjectæ²¡å…³ç³»ã€‚å±æ€§åŒ…è£…å™¨åœ¨åˆ›å»ºæ—¶å¯ä»¥æœ‰å‚æ•°ï¼Œä½¿ç”¨()æŒ‡å®šå‚æ•°<code>@Environment(\.colorScheme) var colorScheme</code>ã€‚å†…å®¹æ˜¯å½“è§†å›¾æ­£åœ¨ç»˜åˆ¶çš„æ—¶å€™ï¼Œä¸€å †æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…çš„å˜é‡ã€‚</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift">view<span class="token punctuation">.</span><span class="token function">environment</span><span class="token punctuation">(</span><span class="token punctuation">\</span><span class="token punctuation">.</span>colorScheme<span class="token punctuation">,</span> <span class="token punctuation">.</span>dark<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>wrappedValueæ˜¯EnvironmentValuesä¸­çš„ä¸€äº›å˜é‡ã€‚</p>
<h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><h4 id="ä»æ¨¡å‹ä¸­æå–ä¿¡æ¯"><a href="#ä»æ¨¡å‹ä¸­æå–ä¿¡æ¯" class="headerlink" title="ä»æ¨¡å‹ä¸­æå–ä¿¡æ¯"></a>ä»æ¨¡å‹ä¸­æå–ä¿¡æ¯</h4><p>å°†storeè®¾ç½®æˆEnvironmentObjectï¼Œæ–¹ä¾¿æ³¨å…¥åˆ°æ‰€æœ‰è§†å›¾ã€‚</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">struct</span> <span class="token class-name">PaletteChooser</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> emojiFontSize<span class="token punctuation">:</span> <span class="token class-name">CGFloat</span> <span class="token operator">=</span> <span class="token number">40</span>
    <span class="token keyword">var</span> emojiFont<span class="token punctuation">:</span> <span class="token class-name">Font</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token function">system</span><span class="token punctuation">(</span>size<span class="token punctuation">:</span> emojiFontSize<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
    
    <span class="token attribute atrule">@EnvironmentObject</span> <span class="token keyword">var</span> store<span class="token punctuation">:</span> <span class="token class-name">PaletteStore</span> <span class="token comment">//æ•°æ®æºåœ¨app</span>
    
    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> chosenPaletteIndex <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">//é€‰æ‹©çš„è°ƒè‰²æ¿ä¸‹æ ‡</span>
    
    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">HStack</span> <span class="token punctuation">&#123;</span>
            paletteControlButton
            <span class="token function">body</span><span class="token punctuation">(</span><span class="token keyword">for</span><span class="token punctuation">:</span> store<span class="token punctuation">.</span><span class="token function">palette</span><span class="token punctuation">(</span>at<span class="token punctuation">:</span> chosenPaletteIndex<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">var</span> paletteControlButton<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Button</span> <span class="token punctuation">&#123;</span>
            chosenPaletteIndex <span class="token operator">=</span> <span class="token punctuation">(</span>chosenPaletteIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> store<span class="token punctuation">.</span>palettes<span class="token punctuation">.</span>count
        <span class="token punctuation">&#125;</span> label<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">Image</span><span class="token punctuation">(</span>systemName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"paintpalette"</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
        <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span>emojiFont<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">body</span><span class="token punctuation">(</span><span class="token keyword">for</span> palette<span class="token punctuation">:</span> <span class="token class-name">Palette</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">HStack</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">Text</span><span class="token punctuation">(</span>palette<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
            <span class="token class-name">ScrollingEmojisView</span><span class="token punctuation">(</span>emojis<span class="token punctuation">:</span> palette<span class="token punctuation">.</span>emojis<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span>emojiFont<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="æ·»åŠ è°ƒè‰²æ¿çš„åŠ¨ç”»"><a href="#æ·»åŠ è°ƒè‰²æ¿çš„åŠ¨ç”»" class="headerlink" title="æ·»åŠ è°ƒè‰²æ¿çš„åŠ¨ç”»"></a>æ·»åŠ è°ƒè‰²æ¿çš„åŠ¨ç”»</h4><p>ç‚¹å‡»è°ƒè‰²æ¿æŒ‰é’®æ—¶ï¼Œå¹³æ»‘æ»šåŠ¨åˆ‡æ¢è°ƒè‰²æ¿ï¼Œæ–°å†…å®¹ä»åº•éƒ¨å¾€ä¸Šæ»‘åŠ¨ï¼Œå°±å†…å®¹å‘ä¸Šæ»‘è¡Œåˆ°é¡¶éƒ¨ç¦»å¼€ï¼Œä½¿ç”¨è¿‡æ¸¡åŠ¨ç”»ã€‚</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">func</span> <span class="token function-definition function">body</span><span class="token punctuation">(</span><span class="token keyword">for</span> palette<span class="token punctuation">:</span> <span class="token class-name">Palette</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">HStack</span> <span class="token punctuation">&#123;</span>
        <span class="token operator">...</span>
    <span class="token punctuation">&#125;</span>
    <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span>palette<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token comment">//ç±»ä¼¼äºå˜æˆå¯æ˜¯åˆ«çš„,å‘ç”Ÿå˜åŒ–çš„æ—¶å€™,åˆ é™¤æ—§çš„åˆ›å»ºæ–°çš„ä»£æ›¿</span>
    <span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span>rollTransition<span class="token punctuation">)</span> <span class="token comment">//ä¸èƒ½å®ç°,åªæ˜¯æ”¹å˜äº†è¯•å›¾å¹¶æ²¡æœ‰åœ¨è¿‡æ¸¡</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//è¿‡æ¸¡åŠ¨ç”»</span>
<span class="token keyword">var</span> rollTransition<span class="token punctuation">:</span> <span class="token class-name">AnyTransition</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">AnyTransition</span><span class="token punctuation">.</span><span class="token function">asymmetric</span><span class="token punctuation">(</span>insertion<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> emojiFontSize<span class="token punctuation">)</span><span class="token punctuation">,</span> removal<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">-</span>emojiFontSize<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// ä¸å¯¹ç§°è¿‡æ¸¡</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="ä¸Šä¸‹æ–‡èœå•"><a href="#ä¸Šä¸‹æ–‡èœå•" class="headerlink" title="ä¸Šä¸‹æ–‡èœå•"></a>ä¸Šä¸‹æ–‡èœå•</h4><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">Button</span><span class="token punctuation">.</span>contextMenu <span class="token punctuation">&#123;</span> contextMenu <span class="token punctuation">&#125;</span> <span class="token comment">//ä¸Šä¸‹æ–‡èœå•æ ,åªéœ€è¦åˆ—å‡ºè¦æ”¾ä¸‹çš„æŒ‰é’®</span>
<span class="token attribute atrule">@ViewBuilder</span>
<span class="token keyword">var</span> contextMenu<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">AnimatedActionButton</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"New"</span></span><span class="token punctuation">,</span> systemImage<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"plus"</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        store<span class="token punctuation">.</span><span class="token function">insertPalette</span><span class="token punctuation">(</span>named<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"New"</span></span><span class="token punctuation">,</span> emojis<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">""</span></span><span class="token punctuation">,</span> at<span class="token punctuation">:</span> chosenPaletteIndex<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token class-name">AnimatedActionButton</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"Delete"</span></span><span class="token punctuation">,</span> systemImage<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"minus.circle"</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        chosenPaletteIndex <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">removePalette</span><span class="token punctuation">(</span>at<span class="token punctuation">:</span> chosenPaletteIndex<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="go-to"><a href="#go-to" class="headerlink" title="go to"></a>go to</h4><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">var</span> gotoMenu<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">Menu</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">ForEach</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>palettes<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> palette <span class="token keyword">in</span>
            <span class="token class-name">AnimatedActionButton</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> palette<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">if</span> <span class="token keyword">let</span> index <span class="token operator">=</span> store<span class="token punctuation">.</span>palettes<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>matching<span class="token punctuation">:</span> palette<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    chosenPaletteIndex <span class="token operator">=</span> index
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span> label<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Label</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Go To"</span></span><span class="token punctuation">,</span> systemImage<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"text.insert"</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="åˆ›å»ºæ–°çš„ç¼–è¾‘è§†å›¾"><a href="#åˆ›å»ºæ–°çš„ç¼–è¾‘è§†å›¾" class="headerlink" title="åˆ›å»ºæ–°çš„ç¼–è¾‘è§†å›¾"></a>åˆ›å»ºæ–°çš„ç¼–è¾‘è§†å›¾</h4><p>ä½¿ç¼–è¾‘çª—å£å‡ºç°åœ¨é¡µé¢ä¸Š</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token punctuation">.</span><span class="token function">popover</span><span class="token punctuation">(</span>isPresented<span class="token punctuation">:</span> $editing<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//ç»™å®šæ¡ä»¶ä¸ºçœŸæ—¶æ˜¾ç¤ºå¼¹å‡ºæ¡† .sheet</span>
	<span class="token class-name">PaletteEditor</span><span class="token punctuation">(</span>palette<span class="token punctuation">:</span> $store<span class="token punctuation">.</span>palettes<span class="token punctuation">[</span>chosenPaletteIndex<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//ç”±å®é™…è¦æ”¹å˜çš„è°ƒè‰²æ¿é©±åŠ¨</span>
body<span class="token punctuation">.</span><span class="token function">popover</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> $paletteToEdit<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> palette <span class="token keyword">in</span> <span class="token comment">//nilä¸å‡ºç°åœ¨å±å¹•ä¸Š</span>
	<span class="token class-name">PaletteEditor</span><span class="token punctuation">(</span>palette<span class="token punctuation">:</span> $store<span class="token punctuation">.</span>palettes<span class="token punctuation">[</span>palette<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">//ç”¨è°ƒè‰²æ¿ç´¢å¼•</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>TextField è¾“å…¥æ–‡æœ¬æ¡† è¿˜æœ‰è‡ªåŠ¨å¤§å°å†™ï¼Œç¦æ­¢è‡ªåŠ¨æ›´æ­£ï¼Œè½¬ä¹‰åŸå¸‚åœ°å€ç­‰åŠŸèƒ½</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">struct</span> <span class="token class-name">PaletteEditor</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
    <span class="token attribute atrule">@Binding</span> <span class="token keyword">var</span> palette<span class="token punctuation">:</span> <span class="token class-name">Palette</span> <span class="token comment">//ç¼–è¾‘ä½äºå…¶ä»–åœ°æ–¹çš„è°ƒè‰²æ¿   </span>
    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Form</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">//æ­£å¼éƒ¨åˆ†</span>
<span class="token comment">//            Section(header: Text("N")) &#123;</span>
<span class="token comment">//                TextField("Name", text: $palette.name)</span>
<span class="token comment">//            &#125;</span>
            nameSection
            addEmojiSection
            removeEmojiSection
            
        <span class="token punctuation">&#125;</span>
        <span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>minWidth<span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span> minHeight<span class="token punctuation">:</span> <span class="token number">350</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">var</span> nameSection<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Section</span><span class="token punctuation">(</span>content<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Name"</span></span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> $palette<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> header<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Name"</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> emojiToAdd <span class="token operator">=</span> <span class="token string-literal"><span class="token string">""</span></span>
    <span class="token keyword">var</span> addEmojiSection<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Section</span><span class="token punctuation">(</span>content<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">""</span></span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> $emojiToAdd<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span>of<span class="token punctuation">:</span> emojiToAdd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> emojis <span class="token keyword">in</span>   <span class="token comment">//å€¼å‘ç”Ÿæ”¹å˜æ—¶æ“ä½œ</span>
                    <span class="token function">addEmojis</span><span class="token punctuation">(</span>emojis<span class="token punctuation">)</span>
                <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> header<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Add Emojis"</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">addEmojis</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> emojis<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        withAnimation <span class="token punctuation">&#123;</span>
            palette<span class="token punctuation">.</span>emojis <span class="token operator">=</span> <span class="token punctuation">(</span>emojis <span class="token operator">+</span> palette<span class="token punctuation">.</span>emojis<span class="token punctuation">)</span>
                <span class="token punctuation">.</span>filter <span class="token punctuation">&#123;</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>isEmoji <span class="token punctuation">&#125;</span> <span class="token comment">//è¿‡æ»¤ä¸æ˜¯è¡¨æƒ…ç¬¦å·çš„å†…å®¹</span>
                <span class="token punctuation">.</span>removingDuplicateCharacters <span class="token comment">//å¦‚æœå­˜åœ¨ä¸æƒ³å¤åˆ¶</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">var</span> removeEmojiSection<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Section</span><span class="token punctuation">(</span>content<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">let</span> emojis <span class="token operator">=</span> palette<span class="token punctuation">.</span>emojis<span class="token punctuation">.</span>removingDuplicateCharacters<span class="token punctuation">.</span>map <span class="token punctuation">&#123;</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token short-argument">$0</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
            <span class="token class-name">LazyVGrid</span><span class="token punctuation">(</span>columns<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">GridItem</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">adaptive</span><span class="token punctuation">(</span>minimum<span class="token punctuation">:</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">ForEach</span><span class="token punctuation">(</span>emojis<span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> emoji <span class="token keyword">in</span>
                    <span class="token class-name">Text</span><span class="token punctuation">(</span>emoji<span class="token punctuation">)</span>
                        <span class="token punctuation">.</span>onTapGesture <span class="token punctuation">&#123;</span>
                            withAnimation <span class="token punctuation">&#123;</span>
                                palette<span class="token punctuation">.</span>emojis<span class="token punctuation">.</span><span class="token function">removeAll</span><span class="token punctuation">(</span><span class="token keyword">where</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token short-argument">$0</span><span class="token punctuation">)</span> <span class="token operator">==</span> emoji <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
                            <span class="token punctuation">&#125;</span>
                        <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">system</span><span class="token punctuation">(</span>size<span class="token punctuation">:</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> header<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Remove Emoji"</span></span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="ç®¡ç†ç•Œé¢"><a href="#ç®¡ç†ç•Œé¢" class="headerlink" title="ç®¡ç†ç•Œé¢"></a>ç®¡ç†ç•Œé¢</h4><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">struct</span> <span class="token class-name">PaletteManager</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
    <span class="token attribute atrule">@EnvironmentObject</span> <span class="token keyword">var</span> store<span class="token punctuation">:</span> <span class="token class-name">PaletteStore</span>
    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">NavigationView</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">List</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">ForEach</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>palettes<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> palette <span class="token keyword">in</span>
                    <span class="token comment">//ç‚¹å‡»ä¹‹åè·³è½¬ç›®çš„åœ° å¯¼èˆªé“¾æ¥</span>
                    <span class="token comment">//å¿…éœ€åœ¨NavifationViewä¸­ä½¿ç”¨</span>
                    <span class="token comment">//é¡¶éƒ¨æœ‰æ›´å¤šç©ºé—´,ä¸ºäº†æ”¾ç½®æ ‡é¢˜</span>
                    <span class="token class-name">NavigationLink</span><span class="token punctuation">(</span>destination<span class="token punctuation">:</span> <span class="token class-name">PaletteEditor</span><span class="token punctuation">(</span>palette<span class="token punctuation">:</span> $store<span class="token punctuation">.</span>palettes<span class="token punctuation">[</span>palette<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//å†…éƒ¨çš„æ ‡é¢˜åœ¨editorä¿®æ”¹</span>
                        <span class="token class-name">VStack</span><span class="token punctuation">(</span>alignment<span class="token punctuation">:</span> <span class="token punctuation">.</span>leading<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                            <span class="token class-name">Text</span><span class="token punctuation">(</span>palette<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
                            <span class="token class-name">Text</span><span class="token punctuation">(</span>palette<span class="token punctuation">.</span>emojis<span class="token punctuation">)</span>
                        <span class="token punctuation">&#125;</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token punctuation">.</span><span class="token function">navigationTitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Manager Palettes"</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">navigationBarTitleDisplayMode</span><span class="token punctuation">(</span><span class="token punctuation">.</span>inline<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">struct</span> <span class="token class-name">PaletteManager_Previews</span><span class="token punctuation">:</span> <span class="token class-name">PreviewProvider</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">static</span> <span class="token keyword">var</span> previews<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">PaletteManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">environmentObject</span><span class="token punctuation">(</span><span class="token class-name">PaletteStore</span><span class="token punctuation">(</span>named<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"preview"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="åˆ é™¤ç®¡ç†åˆ—è¡¨"><a href="#åˆ é™¤ç®¡ç†åˆ—è¡¨" class="headerlink" title="åˆ é™¤ç®¡ç†åˆ—è¡¨"></a>åˆ é™¤ç®¡ç†åˆ—è¡¨</h4><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token punctuation">.</span>onDelete <span class="token punctuation">&#123;</span> indexSet <span class="token keyword">in</span> <span class="token comment">//æ•°ç»„ç´¢å¼•</span>
    store<span class="token punctuation">.</span>palettes<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>atOffsets<span class="token punctuation">:</span> indexSet<span class="token punctuation">)</span> <span class="token comment">//åˆ é™¤æŒ‡å®šåç§»é‡çš„æ‰€æœ‰å…ƒç´ </span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">.</span>onMove <span class="token punctuation">&#123;</span> indexSet<span class="token punctuation">,</span> newOffset <span class="token keyword">in</span>
    store<span class="token punctuation">.</span>palettes<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span>fromOffsets<span class="token punctuation">:</span> indexSet<span class="token punctuation">,</span> toOffset<span class="token punctuation">:</span> newOffset<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="è­¦å‘Š"><a href="#è­¦å‘Š" class="headerlink" title="è­¦å‘Š"></a>è­¦å‘Š</h4><p>æé†’ç”¨æˆ·å‡ºç°é—®é¢˜</p>
<pre class="line-numbers language-none"><code class="language-none">@State private var alertToShow: IdentifiableAlert?

private func showBackgroundImageFetchFailedAlert(_ url: URL) &#123;
    alertToShow &#x3D; IdentifiableAlert(id: &quot;fetch failed: &quot; + url.absoluteString, alert: &#123;
        Alert(
            title: Text(&quot;Background Image Fetch&quot;),
            message: Text(&quot;Couldn&#39;t load from \(url).&quot;),
            dismissButton: .default(Text(&quot;OK&quot;))
        )
    &#125;)
&#125;

&#x2F;&#x2F;å¥½åƒç°åœ¨æœ€å¥½ä¸ç”¨,ä½†æ˜¯è¿˜æ²¡æ”¹
&#x2F;&#x2F;æ”¾åœ¨æ–‡ä»¶ä¸»ä½“
.alert(item: $alertToShow) &#123; alertToShow in
    alertToShow.alert()
&#125;
.onChange(of: document.backgroundImageFetchStatus) &#123; status in
    switch status &#123;
    case .failed(let url):
        showBackgroundImageFetchFailedAlert(url)
    default:
        break
    &#125;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>å­¦ä¹ äº†ä½¿ç”¨EnvironmentObjectæœºåˆ¶ä¼ é€’ViewModelï¼Œå¯¹æ‰§è¡Œè¿‡æ¸¡æ—¶ä½¿ç”¨idè®©è§†å›¾å¯è¯†åˆ«å®ç°è¿‡æ¸¡ï¼Œåœ¨æŒ‰é’®ä¸Šåˆ¶ä½œèœå•ï¼Œä½¿ç”¨Bindingä»è§†å›¾ä¸€ç›´è¿”å›åˆ°æ¨¡å‹ã€å†³å®šè§†å›¾ä»€ä¹ˆæ—¶å€™å‡ºç°ï¼ŒFormã€Listã€åœ¨ForEachä¸­çš„onDeleteå’ŒonMoveï¼Œæ”¾ç½®å·¥å…·æ ï¼ŒEditButton()ä¼šè®¾ç½®EditModeï¼Œè­¦å‘Š</p>
]]></content>
      <tags>
        <tag>swift</tag>
        <tag>cs193p</tag>
      </tags>
  </entry>
  <entry>
    <title>cs193p_note13_Published More Persistence</title>
    <url>/2022/06/09/cs193p-note13/</url>
    <content><![CDATA[<h3 id="Publisher"><a href="#Publisher" class="headerlink" title="Publisher"></a>Publisher</h3><p>åè®®ã€‚å®ç°å‘å‡ºå€¼çš„å¯¹è±¡ã€‚</p>
<p><code>Publisher&lt;Output, Failure&gt;</code>ï¼ŒOutputæ˜¯å‘å¸ƒè€…å‘å¸ƒçš„å†…å®¹çš„ç±»å‹ï¼ŒFailureé€šå¸¸æ˜¯ä¸€ä¸ªæšä¸¾ï¼Œå¿…é¡»å®ç°Errorï¼Œå¤±è´¥åä¸ä¼šæŠ›å‡ºã€‚å¯¹äºå‘å¸ƒè€…ï¼Œæˆ‘ä»¬å¯ä»¥è®¢é˜…å®ƒã€å³æ—¶è½¬æ¢å®ƒçš„å€¼ã€æŠŠå€¼ä¼ é€åˆ°ä¸€äº›åœ°æ–¹ã€‚å±äºCombineæ¡†æ¶ï¼ˆå¯èƒ½ä¼šåè¡¥è¯¦ç»†å†…å®¹ï¼‰</p>
<span id="more"></span>

<h4 id="è®¢é˜…å‘å¸ƒè€…"><a href="#è®¢é˜…å‘å¸ƒè€…" class="headerlink" title="è®¢é˜…å‘å¸ƒè€…"></a>è®¢é˜…å‘å¸ƒè€…</h4><p>å½“å‘å¸ƒæ²¡æœ‰è®¢é˜…è€…ï¼Œä¼šåœæ­¢å‘å¸ƒ</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift">cancellable <span class="token operator">=</span> myPublisher<span class="token punctuation">.</span><span class="token function">sink</span><span class="token punctuation">(</span>
	receiveCompletion<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> result <span class="token keyword">in</span> <span class="token operator">...</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>	<span class="token comment">//å®Œæˆã€å¤±è´¥æˆ–å…¶ä»–æ–¹å¼</span>
	receiveValue<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> thingThePublisherPublishes <span class="token keyword">in</span> <span class="token operator">...</span> <span class="token punctuation">&#125;</span> <span class="token comment">//éšç€å‘å¸ƒè€…å‘å¸ƒä¿¡æ¯è¢«åå¤è°ƒç”¨ï¼Œè·å¾—å‘å¸ƒçš„æœ€æ–°å†…å®¹</span>
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœè°ƒç”¨.sinkï¼Œå‘å¸ƒè€…æ˜¯Neverï¼Œå¯ä»¥å¿½ç•¥ receiveCompletionã€‚</p>
<p>è¿”å›çš„å†…å®¹å®ç°äº†å¯å–æ¶ˆåè®® Cancellableï¼Œé€šå¸¸ä½¿ç”¨ç±»å‹æ“¦å‡ºå°†å®ƒå¤„ç†æˆAnyCancellableã€‚ä¸éœ€è¦å‘å¸ƒå†…å®¹æ—¶å¯ä»¥ä½¿ç”¨<code>.cancel()</code>å–æ¶ˆï¼Œè¿˜å¯ä»¥è®©.sink()è®¢é˜…è€…ä¿æŒæ´»åŠ›ã€‚å½“è¿”å›cancellableå€¼æ—¶.sinkå°†åœ¨å†…å­˜å¸¸è·“ï¼Œè¿™æ˜¯å› ä¸º.sinkæŒ‡å‘äº†cancellableå˜é‡ã€‚</p>
<p>å½“æŠŠcancellableè®¾ç½®ä¸ºnilæ—¶å®ƒå°†ä¸ä¼šæŒ‡å‘.sinkè¿”å›çš„ä»»ä½•å†…å®¹ã€‚è¿™ä¹Ÿä¼šå¯¼è‡´.sinkåœæ­¢å·¥ä½œï¼ˆå†…å­˜å›æ”¶ï¼‰ï¼Œæ‰€ä»¥å®ƒçš„ç”Ÿå‘½å‘¨æœŸæ˜¯ç»‘å®šåœ¨ä¸€èµ·çš„ã€‚å°±åƒ@Stateä¸è§†å›¾çš„å…³ç³»ï¼Œæ˜¯ç›¸äº’ä¾èµ–çš„ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›.sinkç»§ç»­è®¢é˜…ï¼Œå°±éœ€è¦ä¸€ç›´ä½¿ç”¨ä¸€ä¸ªå˜é‡æ¥æ¥æ”¶.sinkçš„è¿”å›å€¼ã€‚</p>
<p>.assign()å†…å®¹ç±»ä¼¼ï¼Œä½†éœ€è¦å¤±è´¥ç±»å‹ä¸ºNever</p>
<h4 id="è§†å›¾ç›‘å¬å‘å¸ƒå†…å®¹"><a href="#è§†å›¾ç›‘å¬å‘å¸ƒå†…å®¹" class="headerlink" title="è§†å›¾ç›‘å¬å‘å¸ƒå†…å®¹"></a>è§†å›¾ç›‘å¬å‘å¸ƒå†…å®¹</h4><p>é€šè¿‡è§†å›¾ä¿®æ”¹å™¨onReceiveï¼Œè®¢é˜…å‘å¸ƒå†…å®¹</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token punctuation">.</span><span class="token function">onReceive</span><span class="token punctuation">(</span>publisher<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> thingThePublisherPublishes <span class="token keyword">in</span> <span class="token comment">//æ¯æ¬¡å‘å¸ƒçš„å€¼</span>
    <span class="token comment">//å‘å¸ƒæ—¶æ‰§è¡Œçš„é—­åŒ…</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ä¼šä½¿è§†å›¾é‡å»ºï¼Œä½†æ›´å¤šçš„æ—¶å€™ä½¿ç”¨onChange</p>
<h4 id="è·å–å‘å¸ƒè€…"><a href="#è·å–å‘å¸ƒè€…" class="headerlink" title="è·å–å‘å¸ƒè€…"></a>è·å–å‘å¸ƒè€…</h4><p>ä¸Šé¢è¯´åˆ°çš„å‘å¸ƒè€…æ˜¯ç”±Combineæ¡†æ¶æä¾›çš„ï¼Œè¿™é‡Œçš„<strong>Foundation</strong>å‘å¸ƒå•†ï¼ˆä¹Ÿå¯ä»¥å«<strong>Foundation</strong>å‘å¸ƒè€…ï¼‰ï¼Œæ˜¯ç”±<strong>Foundation</strong>æ¡†æ¶æä¾›ã€‚</p>
<ul>
<li>åœ¨@Publishedå˜é‡å‰é¢ä½¿ç”¨$</li>
<li>å¤šçº¿ç¨‹è·å–èƒŒæ™¯å›¾ç‰‡ä½¿ç”¨åŸå§‹çš„GCDï¼Œä½†åœ¨URLSessionï¼Œæä¾›dataTaskPublisherå‘å¸ƒæœ€ç»ˆæ¥è‡ªäº’è”ç½‘ä¸Šçš„æ•°æ®</li>
<li>Timerç±»æœ‰ä¸€ä¸ªpublish(every:)çš„å‡½æ•°ï¼Œæ¯ç§’æˆ–å‡ ç§’å‘å¸ƒä¸€æ¬¡ï¼Œå‘å¸ƒå½“å‰æ—¥æœŸå’Œæ—¶é—´çš„å‘å¸ƒè€…</li>
<li>NotificationCenteré€šçŸ¥ä¸­å¿ƒå‘å¸ƒå™¨ï¼Œç³»ç»Ÿç»™ç”¨æˆ·å’Œå‘å¸ƒé€šçŸ¥</li>
</ul>
<h3 id="More-Pesistence"><a href="#More-Pesistence" class="headerlink" title="More Pesistence"></a>More Pesistence</h3><h4 id="Cloud-Kit"><a href="#Cloud-Kit" class="headerlink" title="Cloud Kit"></a>Cloud Kit</h4><p>åœ¨äº‘æ•°æ®åº“å­˜å‚¨å†…å®¹ï¼Œæ•°æ®ä¼šå‡ºç°åœ¨ç”¨æˆ·çš„å…¨éƒ¨è®¾å¤‡ä¸­ã€‚åŒ…å«ä¸€ç§ç½‘ç»œä¸Šçš„UserDefaultsï¼Œåœ¨CoreDataä¸Šè¡¨ç°çš„å¾ˆå¥½ã€‚ä»»ä½•ä½¿ç”¨ç½‘ç»œçš„å†…å®¹éƒ½æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ã€‚</p>
<h4 id="Core-Data"><a href="#Core-Data" class="headerlink" title="Core Data"></a>Core Data</h4><p>æ˜¯ä¸€ä¸ªé¢å‘å¯¹è±¡çš„å±‚ï¼ŒåŸºæœ¬ä¸Šä½äºå…³ç³»æ•°æ®åº“ä¹‹ä¸Šã€‚ä¸ºæ•°æ®åº“ä¸­æ‰€æœ‰çš„è¡Œå’Œè¡¨éƒ½åˆ›å»ºäº†å°çš„ViewModelã€‚</p>
<p>å…·ä½“å†…å®¹åœ¨å»å¹´ï¼Œæˆ‘ä¼šè¡¥ä¸Šçš„ã€‚ï¼ˆåˆä¸€ä¸ªå‘ï¼‰</p>
<h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><h4 id="ä½¿ç”¨URLSession"><a href="#ä½¿ç”¨URLSession" class="headerlink" title="ä½¿ç”¨URLSession"></a>ä½¿ç”¨URLSession</h4><p>ç”¨URLSessionæ›¿æ¢æ‰åŸæœ¬ä½¿ç”¨GCDè·å–èƒŒæ™¯å›¾ç‰‡çš„ä»£ç </p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift">backgroundImageFetchStatus <span class="token operator">=</span> <span class="token punctuation">.</span>fetching
backgroundImageFetchCancellable<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//å¦‚æœæ¥æ–°çš„,é©¬ä¸Šå–æ¶ˆæ—§çš„</span>
<span class="token keyword">let</span> session <span class="token operator">=</span> <span class="token class-name">URLSession</span><span class="token punctuation">.</span>shared <span class="token comment">//ä½¿ç”¨sharedåˆå§‹åŒ–urlè¯·æ±‚å™¨</span>
<span class="token comment">//Publisheråœ¨åå°çº¿ç¨‹æ‰§è¡Œ,UIè¦åœ¨ä¸»çº¿ç¨‹è§£å†³</span>
<span class="token comment">//Outputæ˜¯ä¸€ä¸ªå…ƒç»„,dataæŸ¥æ‰¾urlè¿”å›çš„æ•°æ®,responseä¼šå…±äº«è¯·æ±‚æ—¶çš„ä¸€äº›æ•°æ®</span>
<span class="token keyword">let</span> publisher <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">dataTaskPublisher</span><span class="token punctuation">(</span><span class="token keyword">for</span><span class="token punctuation">:</span> url<span class="token punctuation">)</span> <span class="token comment">//ä½¿ç”¨æ˜ å°„å°†æ•°æ®è½¬æ¢æˆUIImage</span>
    <span class="token punctuation">.</span>map <span class="token punctuation">&#123;</span> <span class="token punctuation">(</span>data<span class="token punctuation">,</span> urlResponse<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token class-name">UIImage</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
    <span class="token punctuation">.</span><span class="token function">replaceError</span><span class="token punctuation">(</span>with<span class="token punctuation">:</span> <span class="token nil constant">nil</span><span class="token punctuation">)</span>    <span class="token comment">//å‡ºç°é”™è¯¯æ—¶,ä¸æŠ¥å‘Šé”™è¯¯,å°†å€¼æ›¿æ¢æˆnil</span>
    <span class="token punctuation">.</span><span class="token function">receive</span><span class="token punctuation">(</span>on<span class="token punctuation">:</span> <span class="token class-name">DispatchQueue</span><span class="token punctuation">.</span>main<span class="token punctuation">)</span> <span class="token comment">//å‘å¸ƒç»™ä¸»é˜Ÿåˆ—çš„è®¢é˜…è€…,æ‰€ä»¥åé¢çš„.sinkå‘ç”Ÿåœ¨ä¸»é˜Ÿåˆ—</span>
<span class="token comment">//å®Œæˆè·å–æ—¶å¤„ç†å›¾è±¡,å¹¶å°†ç…§ç‰‡å‘å¸ƒ</span>
<span class="token comment">//å…³é—­æ–‡æ¡£è‡ªåŠ¨åœæ­¢</span>
backgroundImageFetchCancellable <span class="token operator">=</span> publisher <span class="token comment">//éšæ—¶ä½¿ç”¨cancellable.cancel()å–æ¶ˆè®¢é˜…,ç¦»å¼€å‡½æ•°ä¹Ÿä¼šå±€éƒ¨å˜é‡æ¶ˆå¤±ä¹Ÿä¼šç»“æŸ</span>
    <span class="token comment">//.assign(to: \EmojiArtDocument.backgroundImage, on: self) //å‘å¸ƒçš„å¤±è´¥ç±»å‹ä¸ºNever</span>
    <span class="token punctuation">.</span>sink <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span><span class="token keyword">weak</span> <span class="token keyword">self</span><span class="token punctuation">]</span> image <span class="token keyword">in</span>
        <span class="token keyword">self</span><span class="token operator">?</span><span class="token punctuation">.</span>backgroundImage <span class="token operator">=</span> image
        <span class="token keyword">self</span><span class="token operator">?</span><span class="token punctuation">.</span>backgroundImageFetchStatus <span class="token operator">=</span> <span class="token punctuation">(</span>image <span class="token operator">!=</span> <span class="token nil constant">nil</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">.</span>idle <span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">failed</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="è§†å›¾è‡ªé€‚åº”å¤§å°"><a href="#è§†å›¾è‡ªé€‚åº”å¤§å°" class="headerlink" title="è§†å›¾è‡ªé€‚åº”å¤§å°"></a>è§†å›¾è‡ªé€‚åº”å¤§å°</h4><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token punctuation">.</span><span class="token function">onReceive</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>$backgroundImage<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> image <span class="token keyword">in</span> <span class="token comment">//$document.backgroundImageæ˜¯ç»‘å®šå€¼,ä¸æ˜¯å‘å¸ƒè€…</span>
    <span class="token function">zoomToFit</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> geometry<span class="token punctuation">.</span>size <span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

]]></content>
      <tags>
        <tag>swift</tag>
        <tag>cs193p</tag>
      </tags>
  </entry>
  <entry>
    <title>CS193p_note5 Properties Layout @ViewBuilder</title>
    <url>/2022/02/28/cs193p-note5/</url>
    <content><![CDATA[<h3 id="Computed-Properties-è®¡ç®—å±æ€§"><a href="#Computed-Properties-è®¡ç®—å±æ€§" class="headerlink" title="Computed Properties è®¡ç®—å±æ€§"></a>Computed Properties è®¡ç®—å±æ€§</h3><p>ä¸æä¾›å­˜å‚¨å€¼ï¼Œæä¾›è¯»å–å™¨å’Œè®¾ç½®å™¨ï¼Œæ¥æ”¶å’Œè®¾ç½®å…¶ä»–å±æ€§</p>
<p>getç”¨æ¥æ¥æ”¶æ•°æ®ï¼Œå¹¶ä¸”è¿”å›å€¼ï¼Œsetç”¨æ¥è®¾ç½®å…¶ä»–å±æ€§æˆ–å€¼</p>
<h3 id="State"><a href="#State" class="headerlink" title="@State"></a>@State</h3><p>å˜åŒ–ä¼šåœ¨å¿…è¦æ—¶é‡æ–°ç»˜åˆ¶ï¼Œç›¸å½“äº@ObservedObject</p>
<span id="more"></span>

<h3 id="Layout"><a href="#Layout" class="headerlink" title="Layout"></a>Layout</h3><p>å±å¹•çš„ç©ºé—´å¦‚ä½•åˆ†é…ç»™æ‰€æœ‰è§†å›¾</p>
<ol>
<li>è§†å›¾å®¹å™¨ä¸ºå…¶ä¸­çš„è§†å›¾æä¾›ç©ºé—´</li>
<li>è§†å›¾æ ¹æ®æä¾›ç»™ä»–ä»¬çš„ç©ºé—´é€‰æ‹©è‡ªå·±çš„å°ºå¯¸ï¼Œä¸æ˜¯è¢«åˆ†é…</li>
<li>ä¸€æ—¦è§†å›¾è°ƒæ•´äº†è‡ªå·±çš„å¤§å°ï¼Œå°†è§†å›¾æ”¾ç½®åœ¨è§†å›¾å®¹å™¨é‡Œ</li>
<li>è§†å›¾å®¹å™¨é€‰æ‹©å¤§å°ï¼ŒåŸºäºé‡Œé¢çš„è§†å›¾</li>
</ol>
<h4 id="HStack-amp-VStack"><a href="#HStack-amp-VStack" class="headerlink" title="HStack &amp; VStack"></a>HStack &amp; VStack</h4><p>æœ€ä¸çµæ´»çš„è§†å›¾</p>
<p>ä¾‹å¦‚ï¼ŒImageå’ŒTextæœ‰å›ºå®šå¤§å°ï¼ŒImageçš„è‡ªç„¶å¤§å°ï¼ŒTextå°†å­—ç¬¦ä¸²æ”¾è¿›å»ï¼Œä¸çµæ´»ï¼›RoundedRectangleéå¸¸çµæ´»ï¼Œå¦‚æœä½ ç»™ä»–ç©ºé—´ï¼Œä»–ä¼šå æ®å…¨éƒ¨ç©ºé—´ï¼Œå¡«æ»¡ã€‚</p>
<p>ä»æœ€ä¸çµæ´»çš„è§†å›¾å…ˆåˆ†é…ï¼Œtextå¦‚æœç©ºé—´ä¸å¤Ÿä¼šè‡ªåŠ¨çœç•¥ï¼Œå¦‚æœstacké‡Œé¢çš„è§†å›¾éå¸¸çµæ´»ï¼Œé‚£ä¹ˆæœ¬èº«å°±ä¼šå˜çµæ´»</p>
<ul>
<li><p><code>Spacer(miniLength: CGFloat)</code>éå¸¸çµæ´»ï¼Œéœ€è¦å°½å¯èƒ½å¤šçš„ç©ºé—´</p>
</li>
<li><p><code>Divide()</code> ç”»ä¸€æ¡çº¿åˆ†å‰²è§†å›¾</p>
</li>
<li><p><code>.layoutPriority()</code> å…ˆè·å¾—è§†å›¾çš„åˆ†é…ï¼Œé»˜è®¤æ˜¯0</p>
</li>
</ul>
<p>Vstackç”Ÿæˆä¸€åˆ—è§†å›¾ï¼Œé»˜è®¤å±…ä¸­     </p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">VStack</span><span class="token punctuation">(</span>alignment<span class="token punctuation">:</span> <span class="token punctuation">.</span>leading<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span> <span class="token punctuation">&#125;</span> <span class="token comment">//.leading .trailing</span>
<span class="token class-name">VStack</span><span class="token punctuation">(</span>alignment<span class="token punctuation">:</span> <span class="token punctuation">.</span>firstTextBaseline<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> <span class="token comment">//æ–‡æœ¬åŸºçº¿</span>
<span class="token comment">//å®šä¹‰è‡ªå·±çš„æ’åˆ—æ–¹å¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-swiftUI" data-language="swiftUI"><code class="language-swiftUI">Hstack &#123;
	ForEach(viewModel.cards)&#123; card in
		CardView(card: card).aspectRatio(2&#x2F;3, contentMode: .fit)
	&#125;
&#125;
.foregroundColor(Color.orange)
.padding(10)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="LazyHStack-amp-LazyVStack"><a href="#LazyHStack-amp-LazyVStack" class="headerlink" title="LazyHStack &amp; LazyVStack"></a>LazyHStack &amp; LazyVStack</h4><ul>
<li><p>ä¸æ„å»ºä¸åœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„è§†å›¾ï¼Œåªæ„å»ºScrollViewä¸­æ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„</p>
</li>
<li><p>ä¸çµæ´»ï¼Œå¦‚æœæœ‰çµæ´»è§†å›¾ï¼Œä¸èƒ½ç»™æ‰€æœ‰ç©ºé—´ï¼Œä¼šå°½å¯èƒ½çš„å°</p>
</li>
</ul>
<h4 id="ScrollView"><a href="#ScrollView" class="headerlink" title="ScrollView"></a>ScrollView</h4><p>æ¥æ”¶ä»»ä½•è§†å›¾åœ¨å…¶ä¸­æ»šåŠ¨</p>
<h4 id="LazyHGrid-amp-LazyVGrid"><a href="#LazyHGrid-amp-LazyVGrid" class="headerlink" title="LazyHGrid &amp; LazyVGrid"></a>LazyHGrid &amp; LazyVGrid</h4><p>æ§åˆ¶å¤šå°‘åˆ—æˆ–è€…å¤šå°‘è¡Œ</p>
<h4 id="ZStack"><a href="#ZStack" class="headerlink" title="ZStack"></a>ZStack</h4><p>è°ƒæ•´è‡ªå·±çš„å¤§å°åˆé€‚å­é¡¹</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"hello"</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">background</span><span class="token punctuation">(</span><span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">foregroundColor</span><span class="token punctuation">(</span><span class="token punctuation">.</span>red<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">//èƒŒæ™¯å¤§å°å–å†³äºæ–‡å­—ï¼Œä¸æ˜¯çµæ´»çš„å°ºå¯¸</span>
<span class="token class-name">Circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">overlay</span><span class="token punctuation">(</span><span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"hello"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> alignment<span class="token punctuation">:</span> <span class="token punctuation">.</span>center<span class="token punctuation">)</span>
<span class="token comment">//æ–‡å­—ä¸é‡è¦ï¼Œå¾ˆçµæ´»</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">Hstack</span><span class="token punctuation">&#123;</span>
    <span class="token class-name">ForEach</span><span class="token punctuation">(</span>viewmodel<span class="token punctuation">.</span>cards<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> card <span class="token keyword">in</span>
    	<span class="token class-name">CardView</span><span class="token punctuation">(</span>card<span class="token punctuation">:</span> card<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">aspectRatio</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> contentMode<span class="token punctuation">:</span> <span class="token punctuation">.</span>fit<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">.</span><span class="token function">foregroundColor</span><span class="token punctuation">(</span><span class="token class-name">Color</span><span class="token punctuation">.</span>orange<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li>é¦–å…ˆæä¾›paddingçš„ç©ºé—´ï¼Œå®¹å™¨æœ€å¤–å±‚çš„ç©ºé—´ï¼Œå°†ç©ºé—´-10åæä¾›ç»™foregroundColor</li>
<li>foregroundColoræä¾›ç›¸åŒçš„ç©ºé—´ç»™Hstack</li>
<li>Hstackå°†ç©ºé—´å¹³å‡åˆ†ç»™aspectRatio</li>
<li>æä¾›ç©ºé—´ç»™CardView</li>
</ol>
<h4 id="GeometryReader"><a href="#GeometryReader" class="headerlink" title="GeometryReader"></a>GeometryReader</h4><p>æœ¬èº«æ€»æ˜¯é€‚åº”æä¾›çš„ç©ºé—´</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">GeometryReader</span><span class="token punctuation">&#123;</span> geometry <span class="token keyword">in</span> 
		<span class="token operator">...</span>
<span class="token punctuation">&#125;</span><span class="token comment">//æ”¾åœ¨è§†å›¾é‡Œ è®¡ç®—è§†å›¾å¤§å°</span>
<span class="token keyword">struct</span> <span class="token class-name">GrometryProxy</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> size<span class="token punctuation">:</span> <span class="token class-name">CGSize</span> <span class="token comment">//æä¾›è§†å›¾å¤§å°</span>
    <span class="token keyword">func</span> <span class="token function-definition function">frame</span><span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token class-name">CoordinateSpace</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">CGRect</span>
    <span class="token keyword">var</span> safeAreaInsets<span class="token punctuation">:</span> <span class="token class-name">EdgeInsets</span>
<span class="token punctuation">&#125;</span>
<span class="token class-name">ZStack</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">.</span><span class="token function">edgesIgnoringSafeArea</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">.</span>top<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">//ç”»å…¥å®‰å…¨åŒºåŸŸ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="ViewBuilder"><a href="#ViewBuilder" class="headerlink" title="@ViewBuilder"></a>@ViewBuilder</h3><p>å°†å‡½æ•°è¿”å›æˆå¾ˆå¯¹ä¸ªè§†å›¾ç»„æˆçš„ä¸€ä¸ªè§†å›¾ï¼Œåˆ›å»ºçš„è§†å›¾è¢«ç§°ä¸ºTupleView</p>
<p>ä»»æ„<code>func</code>æˆ–<code>åªè¯»çš„è®¡ç®—å±æ€§</code>éƒ½å¯ä»¥æ ‡è¯†ä¸º<code>@ViewBuilder</code>ï¼Œä¸€æ—¦æ ‡è¯†ï¼Œå®ƒé‡Œé¢çš„å†…å®¹å°†ä¼šè¢«è§£æä¸º<code>a list of Views</code></p>
<h3 id="é›¶æ•£çš„ä¸œè¥¿"><a href="#é›¶æ•£çš„ä¸œè¥¿" class="headerlink" title="é›¶æ•£çš„ä¸œè¥¿"></a>é›¶æ•£çš„ä¸œè¥¿</h3><p>å‡½æ•°å¼ç¼–ç¨‹</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">let</span> faceUpCardIndices <span class="token operator">=</span> cards<span class="token punctuation">.</span>indices<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> cards<span class="token punctuation">[</span><span class="token short-argument">$0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isFaceUp <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token comment">//cards.indicesæ˜¯0..&lt;cards.count filterè¿”å›ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„æ•°ç»„</span>
<span class="token keyword">var</span> faceUpCardIndices <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">Int</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> index <span class="token keyword">in</span> cards<span class="token punctuation">.</span>indices <span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span> cards<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>isFaceUp <span class="token punctuation">&#123;</span>
		faceUpCardIndices<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
		<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

]]></content>
      <tags>
        <tag>swift</tag>
        <tag>cs193p</tag>
      </tags>
  </entry>
  <entry>
    <title>CS193p_note6 Protocols Shapes</title>
    <url>/2022/03/05/cs193p-note6/</url>
    <content><![CDATA[<h3 id="Protocol"><a href="#Protocol" class="headerlink" title="Protocol"></a>Protocol</h3><p>åè®®æ˜¯ä¸€ä¸ªç²¾ç®€çš„<code>class</code>æˆ–<code>struct</code></p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">protocol</span> <span class="token class-name">Moveable</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">func</span> <span class="token function-definition function">move</span><span class="token punctuation">(</span>by<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> hasMoved<span class="token punctuation">:</span> <span class="token class-name">Bool</span> <span class="token punctuation">&#123;</span> <span class="token keyword">get</span> <span class="token punctuation">&#125;</span>
    <span class="token keyword">var</span> distanceFromStart<span class="token punctuation">:</span> <span class="token class-name">Int</span> <span class="token punctuation">&#123;</span> <span class="token keyword">get</span> <span class="token keyword">set</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è‹¥åè®®è¦æ±‚ä¸€ä¸ªå±æ€§ä¸ºå¯è¯»å’Œå¯å†™çš„ï¼Œé‚£ä¹ˆè¯¥å±æ€§è¦æ±‚ä¸èƒ½ç”¨å¸¸é‡å­˜å‚¨å±æ€§æˆ–åªè¯»è®¡ç®—å±æ€§æ¥æ»¡è¶³ã€‚è‹¥åè®®åªè¦æ±‚å±æ€§ä¸ºå¯è¯»çš„ï¼Œé‚£ä¹ˆä»»ä½•ç§ç±»çš„å±æ€§éƒ½èƒ½æ»¡è¶³è¿™ä¸ªè¦æ±‚ï¼Œè€Œä¸”å¦‚æœä½ çš„ä»£ç éœ€è¦çš„è¯ï¼Œè¯¥å±æ€§ä¹Ÿå¯ä»¥æ˜¯å¯å†™çš„ã€‚</p>
<span id="more"></span>

<p>funcå’Œvaræ²¡æœ‰ä»»ä½•å®ç°</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">struct</span> <span class="token class-name">ProtableThing</span><span class="token punctuation">:</span> <span class="token class-name">Moveable</span> <span class="token punctuation">&#123;</span>
	<span class="token comment">//å¿…é¡»æ‰§è¡Œmove(by: Int),hasMoved,distanceFromStart</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">protocol</span> <span class="token class-name">Vehicle</span><span class="token punctuation">:</span> <span class="token class-name">Moveable</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> passengerCount<span class="token punctuation">:</span> <span class="token class-name">Int</span> <span class="token punctuation">&#123;</span> <span class="token keyword">get</span> <span class="token keyword">set</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Car</span><span class="token punctuation">:</span> <span class="token class-name">Vehiche</span><span class="token punctuation">,</span> <span class="token class-name">Leasable</span> <span class="token punctuation">&#123;</span>
    
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h4><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">func</span> <span class="token function-definition function">travelAround</span><span class="token punctuation">(</span>using moveable<span class="token punctuation">:</span> <span class="token class-name">Moveable</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">Moveable</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>è®©donâ€™t careå˜å¾—æœ‰ä¸€ç‚¹åœ¨ä¹ <code>struct MemoryGame&lt;CardContent&gt; where CardContent: Equatable</code></p>
<p>å°†extensionæ‰©å±•ä¸ºä»…ä½¿ç”¨æŸäº›äº‹æƒ…ï¼Œä¹Ÿå¯ä»¥é™åˆ¶ä¸ªåˆ«åŠŸèƒ½</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">init</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token class-name">Data</span><span class="token punctuation">)</span> <span class="token keyword">where</span> <span class="token class-name">Date</span><span class="token punctuation">:</span> <span class="token class-name">Collection</span><span class="token punctuation">,</span> <span class="token class-name">Data</span><span class="token punctuation">.</span><span class="token class-name">Element</span><span class="token punctuation">:</span> <span class="token class-name">Identifiable</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>åªä¸ºæ¥æ”¶åˆ°ç‰¹å®šç±»å‹æ•°æ®è¿›è¡Œåˆå§‹åŒ–</p>
<p>&#x3D;&#x3D;åè®®å¯ä»¥é€šè¿‡åˆ›å»ºextensionæ¥å®æ–½ï¼Œå¯ä»¥åœ¨æ‰©å±•ä¸­æ·»åŠ é»˜è®¤å®æ–½&#x3D;&#x3D;</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">func</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> isInclude<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token class-name">Element</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Bool</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Array</span><span class="token operator">&lt;</span><span class="token class-name">Element</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>é€‚ç”¨äºæ•°ç»„ã€å­—ç¬¦ä¸²ã€èŒƒå›´ç­‰ï¼Œè¢«æ·»åŠ åˆ°åŸºç¡€åº“ä¸­ï¼Œä½œä¸ºSequenceåè®®çš„æ‰©å±•</p>
<h4 id="Identifiable"><a href="#Identifiable" class="headerlink" title="Identifiable"></a>Identifiable</h4><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">protocol</span> <span class="token class-name">Identifiable</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">associatedtype</span> <span class="token constant">ID</span><span class="token punctuation">:</span> <span class="token class-name">Hashable</span> <span class="token comment">//å…³è”ç±»å‹</span>
    <span class="token keyword">var</span> id<span class="token punctuation">:</span> <span class="token constant">ID</span> <span class="token punctuation">&#123;</span> <span class="token keyword">get</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="Hashable"><a href="#Hashable" class="headerlink" title="Hashable"></a>Hashable</h4><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">protocol</span> <span class="token class-name">Hashable</span><span class="token punctuation">:</span> <span class="token class-name">Equatable</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">hash</span><span class="token punctuation">(</span>into hasher<span class="token punctuation">:</span> <span class="token keyword">inout</span> <span class="token class-name">Hasher</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h4 id="Equatable"><a href="#Equatable" class="headerlink" title="Equatable"></a>Equatable</h4><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">protocol</span> <span class="token class-name">Equatable</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token operator">==</span><span class="token punctuation">(</span>lhs<span class="token punctuation">:</span> <span class="token keyword">Self</span><span class="token punctuation">,</span> rhs<span class="token punctuation">:</span> <span class="token keyword">Self</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Bool</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è‡ªå¼•ç”¨åè®®ä¸èƒ½ä½œä¸ºæ™®é€šç±»å‹ä½¿ç”¨</p>
<h3 id="Shape"><a href="#Shape" class="headerlink" title="Shape"></a>Shape</h3><p>Shape is a <code>protocol</code> that inherits from View</p>
<p>RoundedRectangle,Circle,Capsule</p>
<p> é»˜è®¤è¢«å¡«æ»¡é¢œè‰²ï¼Œå¯ä»¥é€šè¿‡<code>.stock()</code>å’Œ<code>.fill()</code>æ”¹å˜</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">func</span> <span class="token function-definition function">fill</span><span class="token operator">&lt;</span><span class="token class-name">S</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token omit keyword">_</span> whatToFillWith<span class="token punctuation">:</span> <span class="token class-name">S</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token keyword">where</span> <span class="token class-name">S</span><span class="token punctuation">:</span> <span class="token class-name">ShapeStyle</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>åˆ›å»ºè‡ªå·±çš„Shape</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">func</span> <span class="token function-definition function">path</span><span class="token punctuation">(</span><span class="token keyword">in</span> rect<span class="token punctuation">:</span> <span class="token class-name">CGRect</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Path</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> a <span class="token class-name">Path</span> 
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>èƒ½æ·»åŠ lineã€arcã€berzier curve</p>
<p>ç»˜å›¾åæ ‡ç³»ï¼Œéç¬›å¡å°”åæ ‡ç³»ï¼Œé›¶åæ ‡åœ¨å·¦ä¸Šè§’ï¼Œé¡ºé€†æ—¶é’ˆä¼šç›¸å</p>
]]></content>
      <tags>
        <tag>swift</tag>
        <tag>cs193p</tag>
      </tags>
  </entry>
  <entry>
    <title>cs193p_note7 ViewModifier Animation</title>
    <url>/2022/04/15/cs193p-note7/</url>
    <content><![CDATA[<h3 id="Animation"><a href="#Animation" class="headerlink" title="Animation"></a>Animation</h3><ul>
<li>ä¸ºShapeè®¾ç½®åŠ¨ç”»</li>
<li>ä½¿ç”¨ViewModifieråšåŠ¨ç”»</li>
</ul>
<p>åªæœ‰æ”¹å˜å¯ä»¥è¢«åŠ¨ç”»åŒ–ï¼Œæ”¹å˜ViewModifierçš„å‚æ•°ï¼ŒShapeçš„å‚æ•°ï¼ŒUIä¸­æ˜¯å¦å­˜åœ¨è§†å›¾</p>
<p>åŠ¨ç”»æ˜¾ç¤ºç»™ç”¨æˆ·å·²ç»å‘ç”Ÿçš„å˜åŒ–</p>
<span id="more"></span>

<p>ViewModifieræ˜¯ä¸»è¦çš„å˜æ›´ä»£ç†ï¼Œæ›´æ”¹å‚æ•°å¿…é¡»åœ¨Viewæ”¾å…¥UIä¹‹å</p>
<p>è§†å›¾åŠ å…¥æˆ–ç¦»å¼€ä¸€ä¸ªå·²ç»åœ¨ç”¨æˆ·ç•Œé¢çš„å®¹å™¨æ—¶ï¼Œæ‰ä¼šè¢«åŠ¨ç”»ã€‚å¦‚æœä¸€ä¸ªè§†å›¾å¸¦ç€å®¹å™¨ä¸€èµ·å‡ºç°åœ¨å±å¹•ä¸Šï¼Œå®¹å™¨ä¼šè¢«åŠ¨ç”»åŒ–ï¼Œè€Œä¸æ˜¯è§†å›¾</p>
<h4 id="å¦‚ä½•åˆ¶ä½œåŠ¨ç”»"><a href="#å¦‚ä½•åˆ¶ä½œåŠ¨ç”»" class="headerlink" title="å¦‚ä½•åˆ¶ä½œåŠ¨ç”»"></a>å¦‚ä½•åˆ¶ä½œåŠ¨ç”»</h4><ol>
<li><p>Implicitly éšå«çš„è‡ªåŠ¨çš„ï¼Œé€šè¿‡ä½¿ç”¨<code>.animation(Animation)</code> </p>
</li>
<li><p>Explicitly æƒ³è¦æ•´ä¸ªUIåè°ƒå˜åŒ–çš„åŠ¨ç”» <code>withAnimation(Animation) &#123;&#125;</code> </p>
</li>
<li><p>ä»UIä¸­åŒ…æ‹¬æˆ–æ’é™¤è§†å›¾ï¼Œåšç‹¬ç«‹è§†å›¾</p>
<p> æ‰€æœ‰çš„åªå‘ç”Ÿåœ¨è§†å›¾å·²ç»å­˜åœ¨äºUIä¸­æˆ–æˆ–å®¹å™¨åœ¨UIä¸­</p>
</li>
</ol>
<h4 id="Implicit-Animation"><a href="#Implicit-Animation" class="headerlink" title="Implicit Animation"></a>Implicit Animation</h4><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">" "</span></span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">opacity</span><span class="token punctuation">(</span>scary <span class="token operator">?</span> <span class="token number">1</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">rotationEffect</span><span class="token punctuation">(</span><span class="token class-name">Angle</span><span class="token punctuation">.</span><span class="token function">degrees</span><span class="token punctuation">(</span>upsideDown <span class="token operator">?</span> <span class="token number">180</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">animation</span><span class="token punctuation">(</span><span class="token class-name">Animation</span><span class="token punctuation">.</span>easeInOut<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è®©ä¸Šé¢çš„å˜åŒ–å˜æˆåŠ¨ç”»</p>
<ul>
<li>ä¸é€‚ç”¨äºä»»ä½•å®¹å™¨ï¼Œå®¹å™¨ä¼šä¼ æ’­åˆ°é‡Œé¢çš„è§†å›¾ä¸­</li>
<li>å…¶ä¸­çš„å‚æ•°æ˜¯ä¸€ä¸ªAnimationç»“æ„ï¼ŒdurationæŒç»­æ—¶é—´ï¼Œdelayè°ƒç”¨ä¸€ä¸ªå°å‡½æ•°ï¼Œrepeaté‡å¤ä¸€å®šæ¬¡æ•°æˆ–æ°¸ä¹…é‡å¤(repeatForever)ï¼ŒcurveåŠ¨ç”»æ›²çº¿</li>
</ul>
<h5 id="Animation-Curve"><a href="#Animation-Curve" class="headerlink" title="Animation Curve"></a>Animation Curve</h5><ul>
<li>linearçº¿æ€§çš„æ–¹å¼æ—‹è½¬æˆ–æ·¡å…¥æ·¡å‡º</li>
<li>easeInOut å¼€å§‹å’Œç»“æŸæ”¾æ…¢é€Ÿåº¦</li>
<li>spring ç»“æŸæ—¶éœ‡è¡ï¼Œæä¾›è‡ªç„¶çš„è½åœ°æ•ˆæœ</li>
</ul>
<h4 id="Explicit-Animation"><a href="#Explicit-Animation" class="headerlink" title="Explicit Animation"></a>Explicit Animation</h4><p>åˆ›å»ºä¸€ä¸ªåŠ¨ç”»äº‹åŠ¡(transaction)ï¼Œæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æ›´æ”¹ä¸€èµ·åˆ¶ä½œåŠ¨ç”»</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token function">withAnimation</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">linear</span><span class="token punctuation">(</span>dutation<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ˜¾å¼åŠ¨ç”»æ€»æ˜¯å›´ç»•ç€ViewModel Intent functionsï¼Œå¾ˆæœ‰å¯èƒ½æ”¹å˜æ¨¡å‹ã€‚</p>
<p>&#x3D;&#x3D;<strong>æ˜¾å¼åŠ¨ç”»ä¸ä¼šè¦†ç›–éšå¼åŠ¨ç”»</strong>&#x3D;&#x3D;</p>
<h4 id="transition"><a href="#transition" class="headerlink" title="transition"></a>transition</h4><p>è§†å›¾çš„æ¥å»ï¼Œä»…é€‚ç”¨äºå·²ç»å‡ºç°åœ¨å±å¹•ä¸Šçš„è§†å›¾</p>
<p>å¤§å¤šæ•°æƒ…å†µä½¿ç”¨é¢„å…ˆç½è£…(opacity, scaling, moving across the screen)ï¼Œæ˜¯åœ¨AnyTransitionç»“æ„ä¸Šçš„é™æ€å‡½æ•°å’Œå˜é‡</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">if</span> isFaceUp <span class="token punctuation">&#123;</span>
    <span class="token class-name">RoundedRectangle</span><span class="token punctuation">(</span>cornerRadius<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"ğŸ‘»"</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token class-name">AnyTransition</span><span class="token punctuation">.</span>scale<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">RoundedRectangle</span><span class="token punctuation">(</span>cornerRadius<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token class-name">AnyTransition</span><span class="token punctuation">.</span>identity<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="onAppear"><a href="#onAppear" class="headerlink" title=".onAppear"></a>.onAppear</h5><p>å½“è§†å›¾å‡ºç°åœ¨å±å¹•æ—¶æ‰§è¡Œä¸€ä¸ªé—­åŒ…ï¼Œåœ¨å®¹å™¨è§†å›¾ä¸Šä½¿ç”¨<code>.onAppear&#123;&#125;</code>ï¼Œå½“è§†å›¾å‡ºç°åœ¨å±å¹•æ—¶å¯ä»¥æ‰§è¡Œä¸€ç³»åˆ—ä»£ç </p>
<h3 id="ViewModifier"><a href="#ViewModifier" class="headerlink" title="ViewModifier"></a>ViewModifier</h3><p>ä¿®æ”¹è§†å›¾çš„å°åŠŸèƒ½ï¼Œä¾‹å¦‚<code>.aspectRatio(2/3)</code></p>
<p>å”¯ä¸€çš„å·¥ä½œå°±æ˜¯ä¿®æ”¹è§†å›¾</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">protocol</span> <span class="token class-name">ViewModifier</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">typealias</span> <span class="token class-name">Content</span><span class="token comment">//æ­£åœ¨ä¿®æ”¹çš„è§†å›¾</span>
    <span class="token keyword">func</span> <span class="token function-definition function">body</span><span class="token punctuation">(</span>content<span class="token punctuation">:</span> <span class="token class-name">Content</span><span class="token punctuation">)</span> <span class="token operator">-></span> someView <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">some</span> <span class="token class-name">View</span> that almost certainly contains the <span class="token class-name">View</span> content
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>ç‰¹æ®Šçš„ViewModifierï¼Œæ˜¯GeometryEffectï¼Œåªä¿®æ”¹å‡ ä½•ï¼Œå¦‚ç¼©æ”¾ã€å¹³è¡Œã€æ—‹è½¬</li>
</ul>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">struct</span> <span class="token class-name">Cardify</span><span class="token punctuation">:</span> <span class="token class-name">ViewModifier</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> isFaceUp<span class="token punctuation">:</span> <span class="token class-name">Bool</span>
    <span class="token keyword">func</span> <span class="token function-definition function">body</span><span class="token punctuation">(</span>content<span class="token punctuation">:</span> <span class="token class-name">Content</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">ZStack</span> <span class="token punctuation">&#123;</span>
            <span class="token operator">...</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">" "</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modifier</span><span class="token punctuation">(</span><span class="token class-name">Cardify</span><span class="token punctuation">(</span>isFaceUp<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">extension</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">cardify</span><span class="token punctuation">(</span>isFaceUp<span class="token punctuation">:</span> <span class="token class-name">Bool</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">modifier</span><span class="token punctuation">(</span><span class="token class-name">Cardify</span><span class="token punctuation">(</span>isFaceUp<span class="token punctuation">:</span> isFaceUp<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><h4 id="GeometryEffect"><a href="#GeometryEffect" class="headerlink" title="GeometryEffect"></a>GeometryEffect</h4><p>ä½¿äº‹ç‰©æ—‹è½¬ï¼Œç§»åŠ¨ç‰©ä½“ï¼Œè°ƒæ•´ç‰©ä½“å¤§å°ç­‰</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token punctuation">.</span><span class="token function">rotationEffect</span><span class="token punctuation">(</span><span class="token class-name">Angle</span><span class="token punctuation">.</span><span class="token function">degrees</span><span class="token punctuation">(</span>card<span class="token punctuation">.</span>isMatched <span class="token operator">?</span> <span class="token number">360</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">animation</span><span class="token punctuation">(</span><span class="token class-name">Animation</span><span class="token punctuation">.</span><span class="token function">easeInOut</span><span class="token punctuation">(</span>duration<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">repeatForever</span><span class="token punctuation">(</span>autoreverses<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//ä¸ä¼šè‡ªåŠ¨åè½¬</span>
<span class="token punctuation">.</span><span class="token function">animation</span><span class="token punctuation">(</span><span class="token class-name">Animation</span><span class="token punctuation">.</span><span class="token function">linear</span><span class="token punctuation">(</span>duration<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">repeatForever</span><span class="token punctuation">(</span>autoreverses<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> card<span class="token punctuation">.</span>isMatched<span class="token punctuation">)</span> <span class="token comment">//iOS15.0æ¨èç”¨æ³•</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>æ—‹è½¬åŒ¹é…æˆåŠŸçš„å†…å®¹ï¼Œï¼Œè¿™ä¹ˆåªä¼šæ—‹è½¬ç¬¬ä¸€ä¸ªå†…å®¹ï¼Œè€Œä¸”æ—‹è½¬æ—¶å­—ä½“å¤§å°æ”¹å˜ï¼Œå­—ä½“ä¸èƒ½è¿›è¡ŒåŠ¨ç”»ï¼Œæ—‹è½¬æ—¶æœ‰å¤šä¸ªåŠ¨ç”»ä¸€èµ·å‘ç”Ÿï¼Œè¦ä½¿ç”¨å›ºå®šå¤§å°å­—ä½“ã€‚</p>
<p>åˆ›å»ºåŠ¨ç”»æ—¶æ³¨æ„ä¸‰ä¸ªåŸåˆ™ï¼Œå¯ä»¥é€šè¿‡opacityä½¿å†…å®¹åœ¨å±å¹•ä¸Šéšè—ã€‚</p>
<p>animationå‚è€ƒï¼š<a href="https://juejin.cn/post/7067340603494924296">https://juejin.cn/post/7067340603494924296</a></p>
]]></content>
      <tags>
        <tag>swift</tag>
        <tag>cs193p</tag>
      </tags>
  </entry>
  <entry>
    <title>cs193p_note8 Animation Demostrastion</title>
    <url>/2022/05/02/cs193p-note8/</url>
    <content><![CDATA[<h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><h4 id="å®ç°æ´—ç‰ŒåŠ¨ç”»"><a href="#å®ç°æ´—ç‰ŒåŠ¨ç”»" class="headerlink" title="å®ç°æ´—ç‰ŒåŠ¨ç”»"></a>å®ç°æ´—ç‰ŒåŠ¨ç”»</h4><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">var</span> shuffle<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Shuffle"</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        withAnimation <span class="token punctuation">&#123;</span>
            game<span class="token punctuation">.</span><span class="token function">shuffle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¿«é€Ÿç‚¹å‡»shuffleæŒ‰é’®ï¼Œæœªå®Œæˆçš„åŠ¨ç”»ä¼šè‡ªåŠ¨æš‚åœå¹¶ç»§ç»­æ–°çš„æ“ä½œï¼Œä¸Šé¢å›¾æ¡ˆæ—‹è½¬ä½¿ç”¨çš„æ˜¯éšå¼åŠ¨ç”»ï¼Œç‹¬ç«‹äºæ˜¾ç¤ºï¼Œæ‰€ä»¥èƒ½åœ¨æ—‹è½¬çš„æ—¶å€™å®Œæˆæ´—ç‰Œæ“ä½œã€‚</p>
<span id="more"></span>

<h4 id="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ˜¾ç¤ºåŠ¨ç”»"><a href="#ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ˜¾ç¤ºåŠ¨ç”»" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ˜¾ç¤ºåŠ¨ç”»"></a>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ˜¾ç¤ºåŠ¨ç”»</h4><p>ç”¨äºIntentå‡½æ•°ï¼Œå½“ä½ è¡¨è¾¾ä½ çš„æ„å›¾æ—¶ï¼Œæ€»æ˜¯è¦ä¿®æ”¹æ¨¡å‹ã€‚åœ¨å› ä¸ºååº”è€Œå¯¹æ¨¡å‹ä¿®æ”¹ï¼Œå˜åŠ¨è§†å›¾æ—¶ä½¿ç”¨</p>
<p>ä¸€è¾¹ä½¿ç”¨<code>withAnimation() &#123;&#125;</code>åŒ…è£¹åœ¨Intentå‘¨å›´</p>
<h4 id="ä¸ºå¡ç‰‡ç¿»è½¬åšåŠ¨ç”»"><a href="#ä¸ºå¡ç‰‡ç¿»è½¬åšåŠ¨ç”»" class="headerlink" title="ä¸ºå¡ç‰‡ç¿»è½¬åšåŠ¨ç”»"></a>ä¸ºå¡ç‰‡ç¿»è½¬åšåŠ¨ç”»</h4><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token punctuation">.</span><span class="token function">rotation3DEffect</span><span class="token punctuation">(</span><span class="token class-name">Angle</span><span class="token punctuation">.</span><span class="token function">degrees</span><span class="token punctuation">(</span>isFaceUp <span class="token operator">?</span> <span class="token number">0</span> <span class="token punctuation">:</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ä½¿ç”¨æ—¶ï¼Œè¿˜æ²¡ç¿»è½¬90åº¦ï¼Œå°±ä¼šå‡ºç°å›¾æ¡ˆï¼Œä¸åˆç†ã€‚å› ä¸ºåŠ¨ç”»æ˜¯æ·¡å…¥æ·¡å‡ºï¼Œæ²¡ç¿»è½¬90åº¦æ—¶ï¼Œçº¢è‰²çš„èƒŒé¢ä¼šå˜æ·¡ï¼Œè€Œè¡¨æƒ…ç¬¦å·ä¼šæ…¢æ…¢æ˜¾ç°ï¼Œæ‰€ä»¥è¦è·Ÿè¸ªæ—‹è½¬å¤šå°‘è§’åº¦ï¼Œè¿›è¡Œçªç„¶æ˜¾ç¤º</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">init</span><span class="token punctuation">(</span>isFaceUp<span class="token punctuation">:</span> <span class="token class-name">Bool</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	rotation <span class="token operator">=</span> isFaceUp <span class="token operator">?</span> <span class="token number">0</span> <span class="token punctuation">:</span> <span class="token number">180</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ä½¿ç”¨isFaceUpå¯¹æ—‹è½¬è§’åº¦è¿›è¡Œåˆå§‹åŒ–ã€‚</p>
<p>ä½¿ç”¨Animatableï¼Œå¯¹æ—‹è½¬è§’åº¦è¿›è¡Œé€æ­¥å˜åŒ–ï¼Œå®ç°åˆ°è¾¾90åº¦æ‰ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè‡ªå®šä¹‰ViewModifier</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">var</span> animatableData<span class="token punctuation">:</span> <span class="token class-name">Double</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">get</span> <span class="token punctuation">&#123;</span> rotation <span class="token punctuation">&#125;</span>
    <span class="token keyword">set</span> <span class="token punctuation">&#123;</span> rotation <span class="token operator">=</span> newValue <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="Transition"><a href="#Transition" class="headerlink" title="Transition"></a>Transition</h4><p>åŒ¹é…æˆåŠŸæ—¶ï¼Œå¡ç‰‡æ¶ˆå¤±æ—¶ä½¿ç”¨äº†è¿‡æ¸¡ï¼Œæ˜¯æ·¡å…¥æ·¡å‡ºçš„å½¢å¼æ¶ˆå¤±çš„</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">CardView</span><span class="token punctuation">(</span>card<span class="token punctuation">:</span> card<span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token class-name">AnyTransition</span><span class="token punctuation">.</span>scale<span class="token punctuation">)</span> <span class="token comment">//ä½¿è§†å›¾ç¼©å°å¹¶é€æ¸æ¶ˆå¤±</span>
	<span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token class-name">AnyTransition</span><span class="token punctuation">.</span><span class="token function">asymmetric</span><span class="token punctuation">(</span>insertion<span class="token punctuation">:</span> <span class="token punctuation">.</span>scale<span class="token punctuation">,</span> removal<span class="token punctuation">:</span> <span class="token punctuation">.</span>opacity<span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token comment">//è¿›å…¥çš„æ•ˆæœå’Œæ¶ˆå¤±çš„æ•ˆæœä¸ä¸€æ ·ï¼Œä½†æ˜¯æœ¬æ¬¡è§†å›¾æ²¡æœ‰å‡ºç°çš„æ—¶å€™ï¼Œä¸€ç›´åœ¨å±å¹•ä¸Šï¼Œæ‰€ä»¥è¦è®©AspectVGridå…ˆå‡ºç°ï¼Œç„¶åå†å‡ºç°å†…éƒ¨å¡ç‰‡</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä½¿ç”¨<code>@State</code>è¿›è¡ŒçŠ¶æ€è®¾ç½®ï¼Œåˆ©ç”¨ã€‚<code>onAppear()</code>è®©å¡ç‰‡å¤„ç†å‘ç”Ÿåœ¨AspectVGridå‡ºç°åã€‚</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> dealt <span class="token operator">=</span> <span class="token class-name">Set</span><span class="token operator">&lt;</span><span class="token class-name">Int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">deal</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> card<span class="token punctuation">:</span> <span class="token class-name">EmojiMemoryGame</span><span class="token punctuation">.</span><span class="token class-name">Card</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    dealt<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>card<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">isUndealt</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> card<span class="token punctuation">:</span> <span class="token class-name">EmojiMemoryGame</span><span class="token punctuation">.</span><span class="token class-name">Card</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Bool</span><span class="token punctuation">&#123;</span>
    <span class="token operator">!</span>dealt<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>card<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token class-name">AspectVGrid</span><span class="token punctuation">(</span>items<span class="token punctuation">:</span> game<span class="token punctuation">.</span>cards<span class="token punctuation">,</span> aspectRatio<span class="token punctuation">:</span> <span class="token number">2</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> card <span class="token keyword">in</span>
            <span class="token keyword">if</span> <span class="token function">isUndealt</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>card<span class="token punctuation">.</span>isMatched <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>card<span class="token punctuation">.</span>isFaceUp<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">Color</span><span class="token punctuation">.</span>clear
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">CardView</span><span class="token punctuation">(</span>card<span class="token punctuation">:</span> card<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
        <span class="token punctuation">.</span>onAppear<span class="token punctuation">&#123;</span>
            <span class="token comment">// "deal" card</span>
            withAnimation <span class="token punctuation">&#123;</span>
                <span class="token keyword">for</span> card <span class="token keyword">in</span> game<span class="token punctuation">.</span>cards <span class="token punctuation">&#123;</span>
                    <span class="token function">deal</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="çœŸæ­£çš„å‘ç‰Œ"><a href="#çœŸæ­£çš„å‘ç‰Œ" class="headerlink" title="çœŸæ­£çš„å‘ç‰Œ"></a>çœŸæ­£çš„å‘ç‰Œ</h4><p>matchedGeometryEffect</p>
<p>å¦‚æœä½ æƒ³ï¼Œå¯ä»¥å’Œtransitionå…±åŒè¿›è¡Œ</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token attribute atrule">@Namespace</span> <span class="token keyword">private</span> <span class="token keyword">var</span> dealingNameSpace
<span class="token class-name">CardView</span><span class="token punctuation">(</span>card<span class="token punctuation">:</span> card<span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">matchedGeometryEffect</span><span class="token punctuation">(</span>id<span class="token punctuation">:</span> card<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> dealingNameSpace<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å®ç°ä¸€å¼ ä¸€å¼ çš„å‘ç‰Œ</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">dealAnimation</span><span class="token punctuation">(</span><span class="token keyword">for</span> card<span class="token punctuation">:</span> <span class="token class-name">EmojiMemoryGame</span><span class="token punctuation">.</span><span class="token class-name">Card</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Animation</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> delay <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> index <span class="token operator">=</span> game<span class="token punctuation">.</span>cards<span class="token punctuation">.</span><span class="token function">firstIndex</span><span class="token punctuation">(</span><span class="token keyword">where</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>id <span class="token operator">==</span> card<span class="token punctuation">.</span>id <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        delay <span class="token operator">=</span> <span class="token class-name">Double</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token class-name">CardConstants</span><span class="token punctuation">.</span>totalDealDuration <span class="token operator">/</span>      <span class="token class-name">Double</span><span class="token punctuation">(</span>game<span class="token punctuation">.</span>cards<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token class-name">Animation</span><span class="token punctuation">.</span><span class="token function">easeInOut</span><span class="token punctuation">(</span>duration<span class="token punctuation">:</span> <span class="token class-name">CardConstants</span><span class="token punctuation">.</span>dealDuration<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">delay</span><span class="token punctuation">(</span>delay<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">for</span> card <span class="token keyword">in</span> game<span class="token punctuation">.</span>cards <span class="token punctuation">&#123;</span>
    <span class="token function">withAnimation</span><span class="token punctuation">(</span><span class="token function">dealAnimation</span><span class="token punctuation">(</span><span class="token keyword">for</span><span class="token punctuation">:</span> card<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">deal</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ç°ä»å¡æ’å †ä»ä¸Šåˆ°ä¸‹å‘ç‰Œï¼Œåœ¨å‘ç‰Œæ—¶æ’é˜Ÿ</p>
<p>åœ¨gamebodyå’ŒdeckbodyåŒæ—¶æ·»åŠ zIndex</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token punctuation">.</span><span class="token function">zIndex</span><span class="token punctuation">(</span><span class="token function">zIndex</span><span class="token punctuation">(</span>of<span class="token punctuation">:</span> card<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è¾ƒé«˜çš„æ•°å­—æ’åœ¨å‰é¢</p>
<h4 id="é‡å¯æ¸¸æˆ"><a href="#é‡å¯æ¸¸æˆ" class="headerlink" title="é‡å¯æ¸¸æˆ"></a>é‡å¯æ¸¸æˆ</h4><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">var</span> restart<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Restart"</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        withAnimation <span class="token punctuation">&#123;</span>
            dealt <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            game<span class="token punctuation">.</span><span class="token function">restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="è®¡æ—¶ç³»ç»Ÿ"><a href="#è®¡æ—¶ç³»ç»Ÿ" class="headerlink" title="è®¡æ—¶ç³»ç»Ÿ"></a>è®¡æ—¶ç³»ç»Ÿ</h4><p>ä½¿ç”¨å±æ€§è§‚å¯Ÿè€…ï¼Œè®¡ç®—æ—¶é—´</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">var</span> isFaceUp <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">didSet</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> isFaceUp <span class="token punctuation">&#123;</span>
            <span class="token function">startUsingBonusTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token function">stopUsingBonusTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">var</span> isMatched <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">didSet</span> <span class="token punctuation">&#123;</span>
        <span class="token function">stopUsingBonusTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ›´æ”¹Pieä¸­çš„å‚æ•°è®¾ç½®ï¼Œ<code>endAngle: Angle(degrees: (1-card.bonusRemaining)*360-90)</code>ï¼Œå‘ç°ï¼Œæ—¶é—´åœ¨è®¡æ—¶ï¼Œä½†æ˜¯è§†å›¾å¹¶æ²¡æœ‰å®æ—¶è·Ÿè¸ªã€‚</p>
<p>ä½¿ç”¨@Stateï¼Œè¿½è¸ªæ—¶é—´</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">Group</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> card<span class="token punctuation">.</span>isConsumingBonusTime <span class="token punctuation">&#123;</span> <span class="token comment">//å¡ç‰‡æ­£é¢</span>
        <span class="token class-name">Pie</span><span class="token punctuation">(</span>startAngle<span class="token punctuation">:</span> <span class="token class-name">Angle</span><span class="token punctuation">(</span>degrees<span class="token punctuation">:</span> <span class="token number">0</span><span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span> endAngle<span class="token punctuation">:</span> <span class="token class-name">Angle</span><span class="token punctuation">(</span>degrees<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>animatedBonusRemaining<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">360</span><span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>onAppear <span class="token punctuation">&#123;</span>
            <span class="token comment">//å¡ç‰‡å‡ºç°æ—¶ï¼Œè®©è¿½è¸ªå˜æˆpieå‰©ä½™å¤§å°ï¼Œç„¶åä»¥å‰©ä½™æ—¶é—´ä¸ºæŒç»­æ—¶é—´å‘0åšåŠ¨ç”»</span>
            animatedBonusRemaining <span class="token operator">=</span> card<span class="token punctuation">.</span>bonusRemaining 
            <span class="token function">withAnimation</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">linear</span><span class="token punctuation">(</span>duration<span class="token punctuation">:</span> card<span class="token punctuation">.</span>bonusTimeRemaining<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                animatedBonusRemaining <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>

    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Pie</span><span class="token punctuation">(</span>startAngle<span class="token punctuation">:</span> <span class="token class-name">Angle</span><span class="token punctuation">(</span>degrees<span class="token punctuation">:</span> <span class="token number">0</span><span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span> endAngle<span class="token punctuation">:</span> <span class="token class-name">Angle</span><span class="token punctuation">(</span>degrees<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>card<span class="token punctuation">.</span>bonusRemaining<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">360</span><span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

]]></content>
      <tags>
        <tag>swift</tag>
        <tag>cs193p</tag>
      </tags>
  </entry>
  <entry>
    <title>cs193p_note9_EmojiArt Drag and Drop Multithreading</title>
    <url>/2022/05/04/cs193p-note9/</url>
    <content><![CDATA[<h3 id="Collection-of-Identifiables"><a href="#Collection-of-Identifiables" class="headerlink" title="Collection of Identifiables"></a>Collection of Identifiables</h3><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">func</span> <span class="token function-definition function">choose</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> card<span class="token punctuation">:</span> <span class="token class-name">Card</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> index <span class="token operator">=</span> cards<span class="token punctuation">.</span><span class="token function">firstIndex</span><span class="token punctuation">(</span><span class="token keyword">where</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>id <span class="token operator">==</span> card<span class="token punctuation">,</span>id<span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        cards<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>isFaceUp <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Cardæ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œç»“æ„ä½“æ˜¯å€¼ç±»å‹ï¼Œåœ¨ä¼ é€’æ—¶ä¼šè¢«å¤åˆ¶ï¼Œæ‰€ä»¥æƒ³è¦æ”¹å˜å¡ç‰‡çš„isFaceUpéœ€è¦è·å–ç´¢å¼•ï¼Œåœ¨æ•°ç»„ä¸­æ‰¾åˆ°ä¿®æ”¹çš„ä½ç½®ã€‚</p>
<span id="more"></span>

<p>åœ¨æ•°ç»„ä¸­å­˜ç»“æ„ä½“æ—¶å¾ˆå¸¸è§ï¼Œå¯ä»¥åˆ©ç”¨ä¸€ä¸ªå°å‡½æ•°è§£å†³ã€‚</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">func</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span>matching element<span class="token punctuation">:</span> <span class="token class-name">Element</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Int</span><span class="token operator">?</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">firstIndex</span><span class="token punctuation">(</span><span class="token keyword">where</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>id <span class="token operator">==</span> element<span class="token punctuation">.</span>id <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
card<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>matching<span class="token punctuation">:</span> card<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å°†å‡½æ•°æ”¾åœ¨æ‰©å±•Arrayä¸­ï¼ˆä¹Ÿé€‚ç”¨äºSetï¼‰</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">extension</span> <span class="token class-name">Array</span> <span class="token keyword">where</span> <span class="token class-name">Element</span><span class="token punctuation">:</span> <span class="token class-name">Identifiable</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span>matching element<span class="token punctuation">:</span> <span class="token class-name">Element</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Int</span><span class="token operator">?</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">firstIndex</span><span class="token punctuation">(</span><span class="token keyword">where</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>id <span class="token operator">==</span> element<span class="token punctuation">.</span>id <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠä»£ç æ”¾åœ¨Collectionåè®®ä¸­ï¼ŒSetå’ŒArrayéƒ½å®ç°</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">extension</span> <span class="token class-name">Collection</span> <span class="token keyword">where</span> <span class="token class-name">Element</span><span class="token punctuation">:</span> <span class="token class-name">Identifiable</span> <span class="token punctuation">&#123;</span><span class="token comment">//ä¸å¯å˜é›†åˆ</span>
    <span class="token keyword">func</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span>matching element<span class="token punctuation">:</span> <span class="token class-name">Element</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">Self</span><span class="token punctuation">.</span><span class="token class-name">Index</span><span class="token operator">?</span> <span class="token punctuation">&#123;</span><span class="token comment">//ç´¢å¼•ä¸ä¸€å®šæ˜¯Intï¼Œæ˜¯ä¸ªæ³›å‹</span>
        <span class="token function">firstIndex</span><span class="token punctuation">(</span><span class="token keyword">where</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>id <span class="token operator">==</span> element<span class="token punctuation">.</span>id <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
    <span class="token comment">//Collectionä¸­ä¸åŒ…æ‹¬removeï¼Œæ‰€ä»¥æŠŠå†…å®¹æ·»åŠ åˆ°RangeReplaceableCollection</span>
<span class="token keyword">extension</span> <span class="token class-name">RangeReplaceableCollection</span> <span class="token keyword">where</span> <span class="token class-name">Element</span><span class="token punctuation">:</span> <span class="token class-name">Identifiable</span> <span class="token punctuation">&#123;</span><span class="token comment">//å¯å˜é›†åˆ</span>
    <span class="token keyword">mutating</span> <span class="token keyword">func</span> <span class="token function-definition function">remove</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> element<span class="token punctuation">:</span> <span class="token class-name">Element</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token function">index</span><span class="token punctuation">(</span>matching<span class="token punctuation">:</span> element<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">remove</span><span class="token punctuation">(</span>at<span class="token punctuation">:</span> index<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>RangeReplaceCollectionå¯ä»¥æ·»åŠ ä¸‹æ ‡ï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„ä¸‹æ ‡æˆ–å¯è¯†åˆ«çš„é›†åˆå˜æˆå¯è¯†åˆ«çš„ï¼Œ<code>cards[card].isFaceUp = true</code></p>
<h3 id="Color-amp-UIColor-amp-CGColor"><a href="#Color-amp-UIColor-amp-CGColor" class="headerlink" title="Color&amp;UIColor&amp;CGColor"></a>Color&amp;UIColor&amp;CGColor</h3><h4 id="Color"><a href="#Color" class="headerlink" title="Color"></a>Color</h4><ul>
<li>ç”¨æ¥æŒ‡å®šé¢œè‰² <code>.foregroundColor(Color.green)</code></li>
<li>ä½œä¸ºShapeStyleï¼Œå¡«å……ï¼Œ<code>.fill(Color.blue)</code></li>
<li>åƒè§†å›¾ä¸€æ ·ï¼Œ<code>Color.white</code></li>
</ul>
<h4 id="UIColor"><a href="#UIColor" class="headerlink" title="UIColor"></a>UIColor</h4><ul>
<li>æœ‰å¾ˆå¤šAPIï¼Œèƒ½è·å–å¹¶è°ƒæ•´RGBï¼Œé¢œè‰²é¥±å’Œåº¦ï¼Œäº®åº¦</li>
<li>æ‹¥æœ‰UIColorï¼Œå¯ä»¥ç”¨Colorä½¿ç”¨ï¼Œ<code>Color(uiColor: )</code></li>
</ul>
<h4 id="CGColor"><a href="#CGColor" class="headerlink" title="CGColor"></a>CGColor</h4><ul>
<li>Core Graphicä¸­åŸºç¡€çš„é¢œè‰²è¡¨ç¤º</li>
<li>ä½¿ç”¨<code>color.cgColor</code>è¡¨ç¤º ä¸èƒ½ä¿è¯æ¯ä¸€ä¸ªéƒ½èƒ½è¢«è¡¨ç¤º</li>
<li>å¦‚æœå°†Colorå˜æˆUIColorå¯èƒ½ä¼šä½¿ç”¨</li>
</ul>
<h3 id="Image-amp-UIImage"><a href="#Image-amp-UIImage" class="headerlink" title="Image&amp;UIImage"></a>Image&amp;UIImage</h3><h4 id="Image"><a href="#Image" class="headerlink" title="Image"></a>Image</h4><ul>
<li>ä¸»è¦æ˜¯ä¸€ä¸ªè§†å›¾</li>
<li>ä¸æ˜¯å®¹çº³å›¾ç‰‡çš„ç±»å‹ï¼Œæ˜¯æ˜¾ç¤ºå›¾ç‰‡çš„è§†å›¾</li>
<li>å¯ä»¥åœ¨Assets.xcassetsä¸­è®¿é—®å›¾ç‰‡ <code>Image(_ name: String)</code></li>
<li>ä½¿ç”¨<code>Image(systemName:)</code>åˆ›å»ºSFç¬¦å·ï¼Œä½¿ç”¨<code>.imageScale()</code>è°ƒæ•´SFç¬¦å·å¤§å°ï¼ŒSFè§†å›¾å—å­—ä½“å½±å“ï¼Œå¯ä»¥å½“è’™ç‰ˆä½¿ç”¨</li>
</ul>
<h4 id="UIImage"><a href="#UIImage" class="headerlink" title="UIImage"></a>UIImage</h4><ul>
<li>èƒ½ç¼©æ”¾è°ƒæ•´å¤§å°ç­‰ï¼Œæ˜¯ç”¨æ¥å­˜å‚¨å›¾ç‰‡çš„å˜é‡</li>
<li>ä½¿ç”¨<code>Image(uiImage:)</code>æ¥æ˜¾ç¤º</li>
</ul>
<h3 id="Drag-and-Drop"><a href="#Drag-and-Drop" class="headerlink" title="Drag and Drop"></a>Drag and Drop</h3><p>ä»ä¸€ä¸ªåº”ç”¨æ‹–åˆ°å¦ä¸€ä¸ªåº”ç”¨ä¼ è¾“æ•°æ®ï¼Œä»Safariæ‹–åŠ¨å›¾ç‰‡åˆ°appã€‚æ ¸å¿ƒç±»æ˜¯<code>NSItemProvider</code>ç±»ï¼Œè¿›ç¨‹ä¹‹é—´çš„æ•°æ®ä¼ è¾“ã€‚</p>
<p>ä¾¿åˆ©åœ°è½¬ç§»ä¸åŒæ•°æ®ç±»å‹</p>
<ul>
<li>NSAttributedStringå…·æœ‰æ ¼å¼çš„å­—ç¬¦ä¸²  NSString</li>
<li>NSURL</li>
<li>UIImage UIColor</li>
</ul>
<p>ä½¿ç”¨è¿æ¥æ•°æ®ç±»å‹å’ŒNSç±»å‹ï¼ŒString as NSString</p>
<h3 id="Dome"><a href="#Dome" class="headerlink" title="Dome"></a>Dome</h3><h4 id="æ‹–æ”¾"><a href="#æ‹–æ”¾" class="headerlink" title="æ‹–æ”¾"></a>æ‹–æ”¾</h4><p>å€ŸåŠ©OCä¸­å†…å®¹å®Œæˆæ‹–æ”¾ï¼Œä½¿ç”¨asè½¬æ¢æ•°æ®ç±»å‹ï¼ŒNSItemProviderå°†æ•°æ®æä¾›ç»™åˆ«äºº</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">Text</span><span class="token punctuation">(</span>emoji<span class="token punctuation">)</span>
	<span class="token punctuation">.</span>onDrag <span class="token punctuation">&#123;</span> <span class="token class-name">NSItemProvider</span><span class="token punctuation">(</span>object<span class="token punctuation">:</span> emoji <span class="token keyword">as</span> <span class="token class-name">NSString</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æ”¾ä¸‹æ—¶ï¼Œéœ€è¦å°†æ•´ä¸ªVstackä¸‹æ”¾ç½®drop</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token comment">//ofåæ·»åŠ å¯æ”¾ä¸‹çš„ç±»å‹</span>
<span class="token punctuation">.</span><span class="token function">onDrop</span><span class="token punctuation">(</span>of<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">.</span>plainText<span class="token punctuation">]</span><span class="token punctuation">,</span> isTargeted<span class="token punctuation">:</span> <span class="token nil constant">nil</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> providers<span class="token punctuation">,</span> location <span class="token keyword">in</span>
	<span class="token keyword">return</span> <span class="token function">drop</span><span class="token punctuation">(</span>providers<span class="token punctuation">:</span> providers<span class="token punctuation">,</span> at<span class="token punctuation">:</span> location<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">drop</span><span class="token punctuation">(</span>providers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">NSItemProvider</span><span class="token punctuation">]</span><span class="token punctuation">,</span> at location<span class="token punctuation">:</span> <span class="token class-name">CGPoint</span><span class="token punctuation">,</span> <span class="token keyword">in</span> geometry<span class="token punctuation">:</span> <span class="token class-name">GeometryProxy</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Bool</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">return</span> providers<span class="token punctuation">.</span><span class="token function">loadObjects</span><span class="token punctuation">(</span>ofType<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> string <span class="token keyword">in</span> <span class="token comment">//æä¾›è€…æ˜¯å¦æœ‰å­—ç¬¦ä¸²,å°†å¼‚æ­¥æ“ä½œå†…å®¹,å› ä¸ºæä¾›è€…å¯èƒ½é‡‡ç”¨å¤šçº¿ç¨‹æä¾›ä¿¡æ¯,è„±ç¦»ä¸»çº¿ç¨‹</span>
		<span class="token keyword">if</span> <span class="token keyword">let</span> emoji <span class="token operator">=</span> string<span class="token punctuation">.</span>first<span class="token punctuation">,</span> emoji<span class="token punctuation">.</span>isEmoji <span class="token punctuation">&#123;</span>
			document<span class="token punctuation">.</span><span class="token function">addEmoji</span><span class="token punctuation">(</span>
				<span class="token class-name">String</span><span class="token punctuation">(</span>emoji<span class="token punctuation">)</span><span class="token punctuation">,</span>
				at<span class="token punctuation">:</span> <span class="token function">convertToEmojiCoordinates</span><span class="token punctuation">(</span>location<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> geometry<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//å°†CGPointè½¬æ¢æˆå…ƒç»„</span>
				size<span class="token punctuation">:</span> defaultEmojiFontSize<span class="token punctuation">)</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="å¤šçº¿ç¨‹-Multithreading"><a href="#å¤šçº¿ç¨‹-Multithreading" class="headerlink" title="å¤šçº¿ç¨‹ Multithreading"></a>å¤šçº¿ç¨‹ Multithreading</h3><p>ä»æµè§ˆå™¨æ‰¾åˆ°å›¾ç‰‡æ‹–è¿›å»ï¼Œä½†æ˜¯ä»äº’è”ç½‘ä¸‹è½½å›¾ç‰‡å¯èƒ½éœ€è¦å‡ ç§’é’Ÿï¼Œå¯èƒ½ä¼šå½±å“UIå“åº”ã€‚</p>
<p>UIéœ€è¦å“åº”ç”¨æˆ·å†…å®¹ï¼Œä½†æœ‰äº›æ“ä½œéœ€è¦æ¯”è¾ƒé•¿çš„æ—¶é—´ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸åŒçš„çº¿ç¨‹ä¸Šæ‰§è¡Œæ“ä½œï¼Œæ‰èƒ½ä¿è¯UIå“åº”</p>
<h4 id="çº¿ç¨‹-treads"><a href="#çº¿ç¨‹-treads" class="headerlink" title="çº¿ç¨‹ treads"></a>çº¿ç¨‹ treads</h4><p>å¯ä»¥æŒ‡å®šçº¿ç¨‹ç”¨äºå“ªäº›ä»£ç ï¼Œå¿«é€Ÿåˆ‡æ¢çº¿ç¨‹çœ‹èµ·æ¥åƒåŒæ—¶åœ¨è¿è¡Œã€‚æœ‰ä¸€äº›çº¿ç¨‹æ‹¥æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§</p>
<p>ä½¿ç”¨é˜Ÿåˆ—ç®¡ç†å¤æ‚çš„çº¿ç¨‹</p>
<h4 id="Queues-Closures"><a href="#Queues-Closures" class="headerlink" title="Queues Closures"></a>Queues Closures</h4><p>é˜Ÿåˆ—åªæ˜¯ä¸€å †æ’é˜Ÿç­‰å¾…çº¿ç¨‹æ‰§è¡Œçš„ä»£ç å—ã€‚æŒ‡å®šåœ¨é˜Ÿåˆ—é‡Œç­‰å¾…çš„ä»£ç å—æ˜¯é—­åŒ…ã€‚</p>
<p>å¤šçº¿ç¨‹APIçš„æ ¸å¿ƒæ˜¯&#x3D;&#x3D;å°†é—­åŒ…æ”¾è¿›é˜Ÿåˆ—&#x3D;&#x3D;</p>
<h4 id="Main-Queue"><a href="#Main-Queue" class="headerlink" title="Main Queue"></a>Main Queue</h4><p>æœ€é‡è¦çš„é˜Ÿåˆ—æ˜¯main queueï¼Œæ˜¯åŒ…å«æ‰€æœ‰å¯èƒ½ç ´åUIç•Œé¢çš„ä»£ç å—ï¼Œæ‰€æœ‰çš„UIçš„æ“ä½œéƒ½éœ€è¦ä¸»é˜Ÿåˆ—</p>
<p>ç³»ç»Ÿä½¿ç”¨å•çº¿ç¨‹æ‰§è¡Œå¤„ç†æ‰€æœ‰åœ¨ä¸»é˜Ÿåˆ—ä¸­çš„ä»£ç å—ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ä¸»é˜Ÿåˆ—ä½œä¸ºåŒæ­¥ç‚¹(synchronize)ã€‚å¯ä»¥å¯¹æ•°æ®ç»“æ„çš„å†™å…¥åœ¨ä¸»é˜Ÿåˆ—ï¼Œä½ çš„è¯»å–å¯ä»¥å‘ç”Ÿåœ¨ä»»ä½•é˜Ÿåˆ—ã€‚</p>
<h4 id="Background-Queues"><a href="#Background-Queues" class="headerlink" title="Background Queues"></a>Background Queues</h4><p>æœ‰ä¸€å †åå°é˜Ÿåˆ—ç”¨æ¥æ‰§è¡Œé•¿æœŸçš„ã€éUIä»»åŠ¡ï¼Œä¾‹å¦‚è¯·æ±‚ç½‘ç»œã€æœºå™¨å­¦ä¹ ã€‚</p>
<p>ç³»ç»Ÿæœ‰ä¸€å †å¯ç”¨çš„çº¿ç¨‹æ‰§è¡Œåå°é˜Ÿåˆ—ä¸Šçš„ä»£ç å—ï¼Œå¯ä»¥å¹¶è¡Œæ‰§è¡Œ</p>
<h4 id="GCD"><a href="#GCD" class="headerlink" title="GCD"></a>GCD</h4><p>å¤„ç†é˜Ÿåˆ—çš„åŸºç¡€APIæ˜¯GCD(Grand Central Dispatch)</p>
<p>åŸºç¡€åŠŸèƒ½</p>
<ul>
<li>è®¿é—®é˜Ÿåˆ—</li>
<li>å°†ä¸€æ®µä»£ç æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­</li>
</ul>
<h4 id="åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—"><a href="#åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—" class="headerlink" title="åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—"></a>åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—</h4><p>main queueæ˜¯DispatchQueueä¸Šçš„é™æ€å˜é‡</p>
<pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token class-name">DispatchQueue</span><span class="token punctuation">.</span>main <span class="token comment">//æ‰€æœ‰çš„UIä»£ç å¿…é¡»æ”¾åœ¨è¿™é‡Œå‘å¸ƒ</span>
<span class="token class-name">DispatchQueue</span><span class="token punctuation">.</span><span class="token function">global</span><span class="token punctuation">(</span>qos<span class="token punctuation">:</span> <span class="token class-name">QoS</span><span class="token punctuation">)</span> <span class="token comment">//æœåŠ¡è´¨é‡</span>
qos
	<span class="token punctuation">.</span>userInteractive <span class="token comment">//å‡ ä¹å’Œä¸»é˜Ÿåˆ—ä¸€æ ·é‡è¦ï¼Œä¸ç”¨æˆ·è¿›è¡Œå®æ—¶äº¤äº’ï¼Œè®¡ç®—å†…å®¹æ›´æ–°åˆ°UIä¸Šï¼Œé€Ÿåº¦æœ€å¿«</span>
	<span class="token punctuation">.</span>userInitiated   <span class="token comment">//ç”¨æˆ·è§¦å‘çº§ï¼Œç”¨æˆ·ç‚¹å‡»æŒ‰é’®ï¼Œåœ¨ç½‘ä¸Šç‚¹å‡»ä¸‹è½½ç­‰ç°åœ¨é©¬ä¸Šè¦åšçš„å†…å®¹ UIç•Œé¢ä¾ç„¶æ´»è·ƒ</span>
	<span class="token punctuation">.</span>utility	  	 <span class="token comment">//å®ç”¨çº§ æ¸…ç†æ•°æ®åº“ç­‰ï¼Œä¸éœ€è¦é©¬ä¸Šå»åš</span>
	<span class="token punctuation">.</span>background		 <span class="token comment">//èƒŒæ™¯çº§ è‡ªåŠ¨ä»»åŠ¡æˆ–å®šæ—¶å¤„ç†ä»»åŠ¡ç­‰</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="åœ¨é˜Ÿåˆ—ä¸Šæ”¾ç½®é—­åŒ…"><a href="#åœ¨é˜Ÿåˆ—ä¸Šæ”¾ç½®é—­åŒ…" class="headerlink" title="åœ¨é˜Ÿåˆ—ä¸Šæ”¾ç½®é—­åŒ…"></a>åœ¨é˜Ÿåˆ—ä¸Šæ”¾ç½®é—­åŒ…</h4><pre class="line-numbers language-swift" data-language="swift"><code class="language-swift"><span class="token keyword">let</span> queue <span class="token operator">=</span> <span class="token class-name">DispatchQueue</span><span class="token punctuation">.</span>main
queue<span class="token punctuation">.</span><span class="token keyword">async</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span> <span class="token comment">//å¼‚æ­¥</span>
queue<span class="token punctuation">.</span>sync <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token comment">//åŒæ­¥</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>åŒæ­¥ï¼Œä»£ç æ‰§è¡Œå®Œæ‰ä¼šè¿”å›ï¼Œé˜»å¡å½“å‰çº¿ç¨‹ï¼Œä¸åœ¨ä¸»é˜Ÿåˆ—ä¸­ä½¿ç”¨</p>
<p>å¼‚æ­¥ï¼Œå°†ä»£ç å—æ”¾åˆ°é˜Ÿåˆ—ä¸­ï¼Œç«‹åˆ»è¿”å›</p>
<p>å¯ä»¥æŠŠå»¶æ—¶æ”¾åœ¨é˜Ÿåˆ—ä¸­</p>
<h4 id="URLSession"><a href="#URLSession" class="headerlink" title="URLSession"></a>URLSession</h4>]]></content>
      <tags>
        <tag>swift</tag>
        <tag>cs193p</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¿¡æ¯æœé›†</title>
    <url>/2022/03/08/%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/</url>
    <content><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>ä¿¡æ¯æ”¶é›†çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚ä¸ä¸æ”»å‡»ç›®æ ‡ç›´æ¥æ¥è§¦ï¼Œä»å…¬å¼€ä¿¡æ¯å…¥æ‰‹äº†è§£æ”»å‡»ï¼Œç§°ä¸ºè¢«åŠ¨ä¿¡æ¯æ”¶é›†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç½‘ç»œæ‰«æç­‰æ‰‹æ®µä¸»åŠ¨ä¸æ”»å‡»å¯¹è±¡å‘ç”Ÿæ¥è§¦ï¼Œç§°ä¸»åŠ¨ä¿¡æ¯æ”¶é›†ã€‚</p>
<p>ä¿¡æ¯æ”¶é›†å†…å®¹ï¼ŒæŠ€æœ¯ç›¸å…³ä¿¡æ¯ï¼šIPåœ°å€ã€å­åŸŸåã€æ•°æ®åº“çš„ç±»å‹ã€å¼€æ”¾çš„ç«¯å£ï¼ŒéæŠ€æœ¯ä¿¡æ¯ï¼šå…¬å¸ä¿¡æ¯ã€ä¸ªäººä¿¡æ¯ã€ä¹ æƒ¯ã€å‘è¡¨çš„ä¸œè¥¿</p>
<span id="more"></span>

<h3 id="ç›®æ ‡åŸºæœ¬ä¿¡æ¯"><a href="#ç›®æ ‡åŸºæœ¬ä¿¡æ¯" class="headerlink" title="ç›®æ ‡åŸºæœ¬ä¿¡æ¯"></a>ç›®æ ‡åŸºæœ¬ä¿¡æ¯</h3><p>ç›®æ ‡åŸºæœ¬ä¿¡æ¯æŒ‡ä¼ä¸šæ¦‚å†µã€ä¼ä¸šç†å¿µã€è§„æ¨¡ã€äº§å“ã€å·¥å•†æ³¨å†Œç­‰ä¿¡æ¯ã€‚é€šè¿‡å¯¹ç›®æ ‡åŸºæœ¬ä¿¡æ¯çš„æ”¶é›†ï¼Œæ”»å‡»è€…å¯ä»¥å¯¹ç›®æ ‡å½¢æˆåˆæ­¥äº†è§£ï¼Œå®šä½å…¶æ ¸å¿ƒä»·å€¼èµ„äº§</p>
<p>å…¬å¸çš„å®˜ç½‘ä¼šä»‹ç»å…¬å¸çš„ç»„ç»‡ç»“æ„ã€æ ¸å¿ƒæˆå‘˜ã€åœ°ç†ä½ç½®ç­‰ä¿¡æ¯ï¼Œâ€œå…³äºâ€ã€â€œäº†è§£â€ã€ICPå¤‡æ¡ˆè¯ä¹¦ç­‰ï¼Œè·å–äº†å…¬å¸åœ°å€å¯ä»¥å°è¯•è¿æ¥æ— è®¤è¯æˆ–é‡‡ç”¨WEPåŠ å¯†çš„wifiçƒ­ç‚¹ï¼Œå‡†å¤‡å‡wifiè®©å‘˜å·¥åŠ å…¥ç­‰ã€‚è·å–æ³•äººä»£è¡¨ä¿¡æ¯ï¼ŒæŸ¥è¯¢åŒä¸€äººåçš„å¤šä¸ªå…¬å¸ï¼Œè¿›è¡Œçªç ´ï¼Œå¯ä»¥ç”¨æ¥é’“é±¼</p>
<h3 id="ç›®æ ‡ç»„ç»‡æ¶æ„"><a href="#ç›®æ ‡ç»„ç»‡æ¶æ„" class="headerlink" title="ç›®æ ‡ç»„ç»‡æ¶æ„"></a>ç›®æ ‡ç»„ç»‡æ¶æ„</h3><p>ç›®æ ‡ç»„ç»‡æ¶æ„æ˜¯è¿›è¡Œä¼ä¸šæµç¨‹è¿è½¬ã€éƒ¨é—¨è®¾ç½®åŠèŒèƒ½è§„åˆ’ç­‰æœ€åŸºæœ¬çš„ç»“æ„ä¾æ®ï¼Œå¯¹å­å…¬å¸ã€æ¯å…¬å¸ç­‰è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œå¯ä»¥æ‰©å¤§æ”»å‡»é¢ï¼Œå¢åŠ æˆåŠŸç‡</p>
<h3 id="ç›®æ ‡å…¶ä»–å…¬å¼€ä¿¡æ¯"><a href="#ç›®æ ‡å…¶ä»–å…¬å¼€ä¿¡æ¯" class="headerlink" title="ç›®æ ‡å…¶ä»–å…¬å¼€ä¿¡æ¯"></a>ç›®æ ‡å…¶ä»–å…¬å¼€ä¿¡æ¯</h3><p>åŒ…æ‹¬æ–°é—»ã€æ‹›æŠ•æ ‡ä¿¡æ¯</p>
<h3 id="ç›®æ ‡åŸŸåä¿¡æ¯"><a href="#ç›®æ ‡åŸŸåä¿¡æ¯" class="headerlink" title="ç›®æ ‡åŸŸåä¿¡æ¯"></a>ç›®æ ‡åŸŸåä¿¡æ¯</h3><p>ç›®æ ‡åŸŸåä¿¡æ¯æ”¶é›†åŒ…æ‹¬å¯¹ç›®æ ‡åŸŸåçš„whoisä¿¡æ¯ã€åŸŸåå†å²ä¿¡æ¯æ”¶é›†ã€æ³¨å†Œäºº&#x2F;æ³¨å†Œé‚®ç®±&#x2F;æ³¨å†Œç”µè¯åæŸ¥ç­‰ã€‚æŠ€æœ¯æ‰‹æ®µä¿¡æ¯ç­‰ç¬¬ä¸€ä¸ªæ­¥éª¤ã€‚</p>
<p>é€šè¿‡whoisåæŸ¥å¯ä»¥é€šè¿‡é‚®ç®±æŸ¥æ‰¾åˆ°åŒä¸€ä¸ªé‚®ç®±å¤‡æ¡ˆçš„å¤šä¸ªåŸŸå</p>
<h3 id="ç›®æ ‡å­åŸŸå"><a href="#ç›®æ ‡å­åŸŸå" class="headerlink" title="ç›®æ ‡å­åŸŸå"></a>ç›®æ ‡å­åŸŸå</h3><p>ç›®æ ‡å­åŸŸåæ”¶é›†åŒ…æ‹¬å¯¹ç›®æ ‡çš„äºŒçº§åŸŸåã€ä¸‰çº§åŸŸåã€å››çº§åŸŸåç­‰è¿›è¡Œæ”¶é›†ã€‚å‘ç°éšè—çš„ã€è¢«é—å¿˜çš„å­åŸŸåä¸Šçš„åº”ç”¨ç¨‹åºå¯èƒ½æ„å‘³ç€å‘ç°å…³é”®æ¼æ´ã€‚å­åŸŸåæ”¶é›†æ·±åº¦å’Œå¹¿åº¦å†³å®šäº†è¿›è¡Œæ”»å‡»æ—¶çš„èŒƒå›´ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šä¹Ÿå†³å®šæ˜¯å¦å¯ä»¥æˆåŠŸçªç ´ç›®æ ‡è¾¹ç•Œç³»ç»Ÿã€‚</p>
<p>å¸¸è§çš„å­åŸŸåæ”¶é›†æ‰‹æ®µï¼š</p>
<ul>
<li>æœç´¢å¼•æ“æ¥å£æŸ¥è¯¢ï¼Œè¡¨è¾¾å¼ï¼š site:example.com</li>
<li>ä¸€äº›ç½‘ç«™ å¦‚dnsdbæä¾›æŸ¥è¯¢å­åŸŸåçš„æœåŠ¡</li>
<li>Sslè¯ä¹¦çš„Subject Alternative Nameå­—æ®µæä¾›å¯¹åº”çš„å­åŸŸå å¦‚ <a href="http://censys.io.certificates/">http://censys.io.certificates</a></li>
<li>å­åŸŸåæš´åŠ›ç ´è§£ï¼Œä½¿ç”¨æš´åŠ›ç ´è§£å·¥å…·éå†å„ç§å­åŸŸå</li>
</ul>
<h3 id="ç›®æ ‡IP"><a href="#ç›®æ ‡IP" class="headerlink" title="ç›®æ ‡IP"></a>ç›®æ ‡IP</h3><p>ç›®æ ‡IPå³æµ‹è¯•ç›®æ ‡å¯¹å¤–å¼€æ”¾çš„åº”ç”¨äºå¯¹å¤–æœåŠ¡çš„IPåœ°å€ã€‚å½“å­åŸŸåæ— æ³•çªç ´ç›®æ ‡æ—¶ï¼Œé€šè¿‡å¯¹ipåŠå…¶å¼€æ”¾ç«¯å£å’ŒæœåŠ¡è¿›è¡Œæ”»å‡»ï¼Œç”šè‡³æœ‰äº›ä¸åœ¨ç®¡ç†åŠä¿æŠ¤èŒƒå›´å†…çš„åœ°å€ã€‚</p>
<h3 id="é‚®ä»¶ä¿¡æ¯æ”¶é›†"><a href="#é‚®ä»¶ä¿¡æ¯æ”¶é›†" class="headerlink" title="é‚®ä»¶ä¿¡æ¯æ”¶é›†"></a>é‚®ä»¶ä¿¡æ¯æ”¶é›†</h3><p>åˆ©ç”¨é‚®ä»¶ç³»ç»Ÿå¯¹ç›®æ ‡å£ä»¤æš´åŠ›ç ´è§£æˆ–é’“é±¼</p>
<h3 id="èŠå¤©ç¾¤ç»„"><a href="#èŠå¤©ç¾¤ç»„" class="headerlink" title="èŠå¤©ç¾¤ç»„"></a>èŠå¤©ç¾¤ç»„</h3><p>ç¾¤æ–‡ä»¶ç­‰å…³é”®ä¿¡æ¯ æœç´¢å…¬å¸å…³é”®å­—</p>
<h3 id="å†å²æ¼æ´"><a href="#å†å²æ¼æ´" class="headerlink" title="å†å²æ¼æ´"></a>å†å²æ¼æ´</h3><p>ä»¥å¾€åœ¨äº’è”ç½‘å…¬å¼€çš„ç›®æ ‡çš„å„ç³»ç»Ÿæ¼æ´ä¿¡æ¯ã€‚å¯æ”¶é›†åŸŸåä¿¡æ¯ã€IPä¿¡æ¯ã€ç³»ç»Ÿç»“æ„ç­‰</p>
<p>é€šè¿‡æœç´¢å¼•æ“æ”¶é›†</p>
<h3 id="ç½‘ç»œæ‰«æ"><a href="#ç½‘ç»œæ‰«æ" class="headerlink" title="ç½‘ç»œæ‰«æ"></a>ç½‘ç»œæ‰«æ</h3><p>![image-20220311182005093](&#x2F;Users&#x2F;jiangwenrong&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20220311182005093.png)</p>
<ul>
<li><p>ä¸»æœºå‘ç°</p>
<p>  ![image-20220311182552226](&#x2F;Users&#x2F;jiangwenrong&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20220311182552226.png)</p>
</li>
<li><p>ä¸»æœºè¯†åˆ«</p>
</li>
<li><p>ç«¯å£æ‰«æ</p>
</li>
<li><p>æœåŠ¡è¯†åˆ«</p>
</li>
</ul>
]]></content>
      <categories>
        <category>ç½‘ç»œæ”»å‡»ä¸é˜²æŠ¤</category>
      </categories>
      <tags>
        <tag>ä¿¡æ¯æœé›†</tag>
      </tags>
  </entry>
</search>
